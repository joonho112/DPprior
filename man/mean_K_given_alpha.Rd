% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/03_moments_conditional.R
\name{mean_K_given_alpha}
\alias{mean_K_given_alpha}
\title{Conditional Mean of K_J Given Alpha}
\usage{
mean_K_given_alpha(J, alpha)
}
\arguments{
\item{J}{Sample size (integer >= 1).}

\item{alpha}{Concentration parameter (positive numeric, vectorized).}
}
\value{
Numeric vector of conditional means (same length as \code{alpha}).
}
\description{
Computes \eqn{\mathbb{E}[K_J \mid \alpha]} under a Dirichlet process prior.
}
\details{
Uses the digamma closed form:
\deqn{\mu_J(\alpha) = \alpha\{\psi(\alpha+J)-\psi(\alpha)\}}
where \eqn{\psi(\cdot)} is the digamma function.

This is equivalent to the direct summation:
\deqn{\mu_J(\alpha) = \sum_{i=1}^{J} \frac{\alpha}{\alpha + i - 1}}

\strong{Limiting behavior:}
\itemize{
\item \eqn{\alpha \to 0^+}: \eqn{\mu_J(\alpha) \to 1}
\item \eqn{\alpha \to \infty}: \eqn{\mu_J(\alpha) \to J}
}

For numerical stability, values with \code{alpha < 1e-10} return the limit 1.
}
\examples{
mean_K_given_alpha(50, 2.0)
mean_K_given_alpha(50, c(0.5, 1, 2, 5))

# Limiting behavior
mean_K_given_alpha(50, 1e-10)  # Returns 1
mean_K_given_alpha(50, 1e6)    # Returns ~50

}
\seealso{
\code{\link{var_K_given_alpha}}, \code{\link{moments_K_given_alpha}}
}
