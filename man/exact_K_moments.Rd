% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/05_moments_marginal.R
\name{exact_K_moments}
\alias{exact_K_moments}
\title{Exact Marginal Moments of K_J under Gamma Prior}
\usage{
exact_K_moments(J, a, b, M = .QUAD_NODES_DEFAULT)
}
\arguments{
\item{J}{Integer; sample size (positive integer >= 1).}

\item{a}{Numeric; shape parameter of Gamma prior (> 0).}

\item{b}{Numeric; rate parameter of Gamma prior (> 0).}

\item{M}{Integer; number of quadrature nodes (default: 80).}
}
\value{
A named list with components:
\describe{
\item{\code{mean}}{Marginal mean \eqn{E[K_J | a, b]}}
\item{\code{var}}{Marginal variance \eqn{Var(K_J | a, b)}}
\item{\code{sd}}{Marginal standard deviation}
\item{\code{cv}}{Coefficient of variation (sd/mean)}
}
}
\description{
Computes the exact marginal mean \eqn{E[K_J]} and variance \eqn{Var(K_J)}
when the DP concentration parameter follows a Gamma(a, b) prior.
}
\details{
Uses Gauss-Laguerre quadrature to numerically evaluate:
\deqn{M_1(a,b) = E_{\alpha \sim \Gamma(a,b)}[\mu_J(\alpha)]}
\deqn{V(a,b) = E[v_J(\alpha)] + E[\mu_J(\alpha)^2] - M_1^2}

where \eqn{\mu_J(\alpha)} and \eqn{v_J(\alpha)} are the conditional
mean and variance from Module 03.

The Law of Total Variance decomposes the marginal variance into:
\itemize{
\item Within-alpha variance: \eqn{E[v_J(\alpha)]}
\item Between-alpha variance: \eqn{Var(\mu_J(\alpha))}
}

\strong{Key properties:}
\itemize{
\item The mean is bounded: \eqn{1 \leq E[K_J] \leq J}
\item Despite conditional underdispersion (\eqn{v_J(\alpha) < \mu_J(\alpha)}),
the marginal distribution is typically overdispersed
\item Marginal variance exceeds conditional variance at \eqn{\alpha = E[\alpha]}
}
}
\examples{
# Example from RN-01: J=50, Gamma(1.5, 0.5) prior
result <- exact_K_moments(50, 1.5, 0.5)
print(result)

# Compare with conditional variance at E[alpha] = 3
cond_var <- var_K_given_alpha(50, 3.0)
result$var > cond_var  # TRUE: marginal > conditional

# Verify mean bounds
1 <= result$mean && result$mean <= 50  # TRUE

}
\references{
Antoniak, C. E. (1974). Mixtures of Dirichlet Processes.
\emph{The Annals of Statistics}, 2(6), 1152-1174.
}
\seealso{
\code{\link{K_moments}} for convenience wrapper,
\code{\link{mean_K_given_alpha}}, \code{\link{var_K_given_alpha}}
}
