% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/04_pmf_conditional.R
\name{log_pmf_K_given_alpha}
\alias{log_pmf_K_given_alpha}
\title{Log-PMF of K Given Alpha (Antoniak Distribution)}
\usage{
log_pmf_K_given_alpha(J, alpha, logS)
}
\arguments{
\item{J}{Integer; sample size (number of observations, must be >= 1).}

\item{alpha}{Numeric; DP concentration parameter (must be positive scalar).}

\item{logS}{Matrix; pre-computed log-Stirling matrix from
\code{\link{compute_log_stirling}}.}
}
\value{
Numeric vector of length \eqn{J+1} containing
\eqn{\log P(K_J = k \mid \alpha)} for \eqn{k = 0, 1, \ldots, J}.
Note that entry \code{[1]} corresponds to \eqn{k=0} and always equals
\code{-Inf} (since \eqn{P(K_J = 0) = 0}).
}
\description{
Computes \eqn{\log P(K_J = k \mid \alpha)} for \eqn{k = 0, 1, \ldots, J}.
}
\details{
Uses the Antoniak distribution formula in log-space:
\deqn{\log P(K_J = k \mid \alpha) = \log|s(J,k)| + k\log\alpha - \log(\alpha)_J}

where \eqn{|s(J,k)|} is the unsigned Stirling number of the first kind and
\eqn{(\alpha)_J} is the rising factorial.

This log-space computation is numerically stable for large \eqn{J} where
direct computation would overflow.
}
\examples{
logS <- compute_log_stirling(50)
log_pmf <- log_pmf_K_given_alpha(50, 2.0, logS)

# Convert to probabilities
pmf <- softmax(log_pmf)
sum(pmf)  # Should be 1

}
\seealso{
\code{\link{pmf_K_given_alpha}} for normalized PMF,
\code{\link{compute_log_stirling}} for Stirling computation
}
\keyword{internal}
