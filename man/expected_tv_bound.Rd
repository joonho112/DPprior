% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/13_error_bounds.R
\name{expected_tv_bound}
\alias{expected_tv_bound}
\title{Expected TV Bound Under Gamma Prior}
\usage{
expected_tv_bound(J, a, b, cJ = log(J), M = .QUAD_NODES_DEFAULT)
}
\arguments{
\item{J}{Integer; sample size.}

\item{a, b}{Numeric; Gamma hyperparameters.}

\item{cJ}{Numeric; scaling constant (default: log(J)).}

\item{M}{Integer; number of quadrature nodes.}
}
\value{
Numeric; \eqn{E[d_{TV} \text{ bound} | a, b]}.
}
\description{
Integrates the conditional TV bound over \eqn{\alpha \sim \text{Gamma}(a, b)}
to obtain the marginal error bound.
}
\details{
From Lee (2026, Section 3.3, Corollary 1), the TV error between the exact prior predictive
\eqn{p(S_J | a, b)} and the A1 shifted NegBin proxy is bounded by:
\deqn{d_{TV}(P^{\text{exact}}, Q^{A1}) \le E_{\alpha \sim \Gamma(a,b)}[B_{\text{Pois}} + B_{\text{lin}}]}

This follows from the mixture contraction property of TV distance.
}
\examples{
\dontrun{
# Marginal TV bound for J=100, Gamma(1, 1)
expected_tv_bound(J = 100, a = 1, b = 1)

}
}
\seealso{
\code{\link{compute_total_tv_bound}}, \code{\link{integrate_gamma}}
}
\keyword{internal}
