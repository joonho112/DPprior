% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/13_error_bounds.R
\name{compute_poissonization_bound}
\alias{compute_poissonization_bound}
\title{Poissonization Error Bound (Chen-Stein / Le Cam Bound)}
\usage{
compute_poissonization_bound(J, alpha, raw = FALSE)
}
\arguments{
\item{J}{Integer; sample size (number of observations).}

\item{alpha}{Numeric; concentration parameter (can be vectorized).}

\item{raw}{Logical; if TRUE, return just sum(p_i^2) without the prefactor.
Default is FALSE.}
}
\value{
Numeric vector; upper bound on
\eqn{d_{TV}(S_J | \alpha, \text{Poisson}(\lambda_J(\alpha)))}.
}
\description{
Computes an upper bound on the conditional total variation distance
between the shifted cluster count \eqn{S_J = K_J - 1} and a Poisson law
with the same mean (Poissonization error).
}
\details{
Under the CRP representation,
\eqn{S_J = \sum_{i=2}^J I_i} where \eqn{I_i \sim \text{Bernoulli}(p_i)} and
\eqn{p_i = \alpha / (\alpha + i - 1)}.

A standard Chen-Stein/Le Cam bound gives:
\deqn{d_{TV}(S_J, \text{Poisson}(\lambda)) \le
      \frac{1 - e^{-\lambda}}{\lambda} \sum_{i=2}^J p_i^2}
where \eqn{\lambda = \sum_{i=2}^J p_i = E[S_J | \alpha]}.

The prefactor \eqn{(1 - e^{-\lambda})/\lambda} is always in (0, 1] and
approaches 1 as \eqn{\lambda \to 0}. This provides a tighter bound than
simply using \eqn{\sum p_i^2} alone.

The returned value is capped at 1 (since total variation is always between 0 and 1).
}
\examples{
\dontrun{
# Full Chen-Stein bound
compute_poissonization_bound(J = 50, alpha = 1)

# Raw bound (sum of p_i^2)
compute_poissonization_bound(J = 50, alpha = 1, raw = TRUE)

# Vectorized
compute_poissonization_bound(J = 50, alpha = c(0.5, 1, 2, 5))

}
}
\references{
Le Cam, L. (1960). An approximation theorem for the Poisson binomial
distribution. \emph{Pacific Journal of Mathematics}, 10(4), 1181-1197.

Chen, L. H. Y. (1975). Poisson approximation for dependent trials.
\emph{The Annals of Probability}, 3(3), 534-545.

Lee, J. (2026). Design-Conditional Prior Elicitation for Dirichlet Process Mixtures.
\emph{arXiv preprint} arXiv:2602.06301.
}
\seealso{
\code{\link{compute_sum_p_squared}}, \code{\link{compute_linearization_bound}}
}
\keyword{internal}
