% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/13_error_bounds.R
\name{a1_moment_error}
\alias{a1_moment_error}
\title{A1 Approximation Moment Errors}
\usage{
a1_moment_error(J, a, b, cJ = log(J), M = .QUAD_NODES_DEFAULT)
}
\arguments{
\item{J}{Integer; sample size.}

\item{a, b}{Numeric; Gamma hyperparameters (shape, rate).}

\item{cJ}{Numeric; scaling constant (default: log(J)).}

\item{M}{Integer; number of quadrature nodes (default: 80).}
}
\value{
A list with components:
\describe{
\item{exact_mean, exact_var}{Exact moments via Gauss-Laguerre quadrature}
\item{a1_mean, a1_var}{A1 (shifted NegBin) approximation moments}
\item{error_mean_abs, error_var_abs}{Absolute errors}
\item{error_mean_rel, error_var_rel}{Relative errors (percentage)}
}
}
\description{
Computes the discrepancy between the A1 (shifted NegBin) approximation
and exact marginal moments of \eqn{K_J}.
}
\details{
The A1 approximation models \eqn{K_J \approx 1 + \text{NegBin}(a, p_J)} where
\eqn{p_J = b / (b + c_J)}.

The NegBin(a, p) moments are:
\itemize{
\item Mean: \eqn{a(1-p)/p}
\item Variance: \eqn{a(1-p)/p^2}
}
}
\examples{
# Moment errors for J=50, Gamma(2, 1) prior
errors <- a1_moment_error(J = 50, a = 2, b = 1)
print(errors)

# Compare A1 accuracy at different J values
sapply(c(25, 50, 100, 200), function(J) {
  err <- a1_moment_error(J, a = 2, b = 1)
  c(mean_err = err$error_mean_rel, var_err = err$error_var_rel)
})

# Compare different scaling constants
a1_moment_error(J = 50, a = 2, b = 1, cJ = log(50))
a1_moment_error(J = 50, a = 2, b = 1, cJ = digamma(50) + 0.5772)

}
\seealso{
\code{\link{exact_K_moments}}, \code{\link{DPprior_error_bounds}}
}
