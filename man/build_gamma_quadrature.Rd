% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/02_quadrature.R
\name{build_gamma_quadrature}
\alias{build_gamma_quadrature}
\title{Build Quadrature for Gamma(a, b) Integration}
\usage{
build_gamma_quadrature(a, b, M = .QUAD_NODES_DEFAULT)
}
\arguments{
\item{a}{Numeric; shape parameter of Gamma distribution (must be > 0).}

\item{b}{Numeric; rate parameter of Gamma distribution (must be > 0).}

\item{M}{Integer; number of quadrature nodes (default: 80).}
}
\value{
A list with components:
\describe{
\item{\code{a}}{Shape parameter.}
\item{\code{b}}{Rate parameter.}
\item{\code{alpha_nodes}}{Numeric vector of transformed nodes
\eqn{\alpha_m = x_m / b} on the \eqn{\alpha} scale.}
\item{\code{weights_normalized}}{Numeric vector of normalized weights
that sum to 1.}
}
}
\description{
Transforms standard Gauss-Laguerre quadrature for integration against
a Gamma(a, b) distribution with shape \code{a} and rate \code{b}.
}
\details{
For \eqn{\alpha \sim \text{Gamma}(a, b)}:
\deqn{E[g(\alpha)] = \frac{1}{\Gamma(a)} \int_0^\infty g(x/b) x^{a-1} e^{-x} dx}

Using generalized Laguerre quadrature with parameter \eqn{\alpha_{\text{param}} = a - 1}:
\deqn{E[g(\alpha)] \approx \sum_{m=1}^M \tilde{w}_m g(\alpha_m)}

where \eqn{\alpha_m = x_m / b} and \eqn{\tilde{w}_m} are normalized weights
summing to 1.

The weights are normalized in log-space for numerical stability, which
ensures monotone convergence as M increases.
}
\examples{
# Build quadrature for Gamma(2.5, 1.5)
quad <- build_gamma_quadrature(2.5, 1.5)

# Check weights sum to 1
sum(quad$weights_normalized)

# Check mean: E[alpha] should be a/b = 2.5/1.5
sum(quad$weights_normalized * quad$alpha_nodes)

}
\seealso{
\code{\link{gauss_laguerre_nodes}} for raw quadrature computation,
\code{\link{integrate_gamma}} for high-level expectation computation
}
