% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/12_a2_kl.R
\name{discretize_chisq}
\alias{discretize_chisq}
\title{Discretize Chi-Square to K_J Support}
\usage{
discretize_chisq(J, df, scale = 1)
}
\arguments{
\item{J}{Integer; maximum value (support upper bound).}

\item{df}{Numeric; degrees of freedom.}

\item{scale}{Numeric; scale parameter (default 1).
If \code{scale != 1}, assumes \eqn{X = scale \cdot \chi^2_{df}}.}
}
\value{
Numeric vector of length J; PMF on \eqn{\{1, \dots, J\}}.
}
\description{
Converts a (possibly scaled) chi-square distribution into a discrete PMF on
\eqn{\{1, \dots, J\}} using continuity-corrected binning:
\deqn{p(k) = P(k - 0.5 < X \le k + 0.5), \quad k = 1, \dots, J}
followed by renormalization.
}
\details{
For a scaled chi-square distribution \eqn{Y = scale \cdot X} where \eqn{X \sim \chi^2_{df}}:
\itemize{
\item \eqn{E[Y] = scale \cdot df}
\item \eqn{Var[Y] = scale^2 \cdot 2 \cdot df}
}

\strong{Matching target moments:}
Given target mean \eqn{\mu_K} and variance \eqn{\sigma^2_K}:
\itemize{
\item \eqn{scale = \sigma^2_K / (2 \mu_K)}
\item \eqn{df = 2 \mu_K^2 / \sigma^2_K}
}
}
\examples{
# Chi-square with target moments mu=5, var=8
mu_K <- 5
var_K <- 8
scale <- var_K / (2 * mu_K)
df <- 2 * mu_K^2 / var_K
pmf <- discretize_chisq(50, df = df, scale = scale)

# Verify moments
k_vals <- 1:50
sum(k_vals * pmf)  # ~5

}
\seealso{
\code{\link{DPprior_a2_kl}}
}
