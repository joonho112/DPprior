% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/15_dual_anchor.R
\name{dual_anchor_loss}
\alias{dual_anchor_loss}
\title{Dual-Anchor Loss Function}
\usage{
dual_anchor_loss(
  a,
  b,
  J,
  K_target,
  w1_target,
  lambda,
  M = .QUAD_NODES_DEFAULT,
  loss_type = c("relative", "adaptive", "absolute"),
  L_K_scale = NULL,
  L_w_scale = NULL
)
}
\arguments{
\item{a}{Numeric; shape parameter of the Gamma prior (a > 0).}

\item{b}{Numeric; rate parameter of the Gamma prior (b > 0).}

\item{J}{Integer; sample size.}

\item{K_target}{List with components \code{mu_K} and \code{var_K}.}

\item{w1_target}{List specifying the first-weight target (quantile, prob, or mean).}

\item{lambda}{Numeric value between 0 and 1; weight on K_J loss component.}

\item{M}{Integer; number of Gauss-Laguerre quadrature nodes.}

\item{loss_type}{Character; type of loss scaling:
\describe{
\item{"relative"}{(DEFAULT) Normalized squared errors - both losses
dimensionless and comparable. RECOMMENDED for most cases.}
\item{"adaptive"}{Scaled by initial loss magnitudes - gives more
aggressive weight reduction. Use when lambda=0.5 should truly
mean "equal importance".}
\item{"absolute"}{Legacy behavior - NOT RECOMMENDED, causes optimizer
to essentially ignore weight constraint.}
}}

\item{L_K_scale, L_w_scale}{Numeric; scaling factors for adaptive loss.
Only used when \code{loss_type = "adaptive"}. If NULL, computed internally.}
}
\value{
Numeric; the combined loss value.
}
\description{
Computes the combined loss for K_J and first-weight targets used in the dual-anchor
calibration framework.
}
\details{
\subsection{Loss Scaling Comparison}{

At typical K-only solution with \eqn{P(w_1 > 0.5)} approximately 0.48, target = 0.30:
\itemize{
\item \strong{ABSOLUTE}: L_K approximately 0, L_w approximately 0.03. Any move causes L_K >> L_w.
Optimizer stays at K-only. BROKEN.
\item \strong{RELATIVE}: L_K_rel approximately 0, L_w approximately 0.03. Both dimensionless.
lambda = 0.5 gives approximately 9 percent reduction in \eqn{P(w_1 > 0.5)}.
\item \strong{ADAPTIVE}: Losses normalized by initial magnitudes.
lambda = 0.5 gives approximately 18 percent reduction in \eqn{P(w_1 > 0.5)}.
}
}
}
\seealso{
\code{\link{DPprior_dual}}, \code{\link{compute_tradeoff_curve}}
}
\keyword{internal}
