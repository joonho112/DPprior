% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/03_moments_conditional.R
\name{var_K_given_alpha}
\alias{var_K_given_alpha}
\title{Conditional Variance of K_J Given Alpha}
\usage{
var_K_given_alpha(J, alpha)
}
\arguments{
\item{J}{Sample size (integer >= 1).}

\item{alpha}{Concentration parameter (positive numeric, vectorized).}
}
\value{
Numeric vector of conditional variances (same length as \code{alpha}).
}
\description{
Computes \eqn{\mathrm{Var}(K_J \mid \alpha)} under a Dirichlet process prior.
}
\details{
Uses the trigamma closed form:
\deqn{v_J(\alpha) = \mu_J(\alpha) - \alpha^2\{\psi_1(\alpha) - \psi_1(\alpha+J)\}}
where \eqn{\psi_1(\cdot)} is the trigamma function.

This is equivalent to the direct summation:
\deqn{v_J(\alpha) = \sum_{i=1}^{J} \frac{\alpha(i-1)}{(\alpha + i - 1)^2}}

\strong{Key property:} \eqn{0 < v_J(\alpha) < \mu_J(\alpha)} for all
\eqn{\alpha > 0} (conditional underdispersion).

\strong{Limiting behavior:}
\itemize{
\item \eqn{\alpha \to 0^+}: \eqn{v_J(\alpha) \to 0}
\item \eqn{\alpha \to \infty}: \eqn{v_J(\alpha) \to 0}
}

For numerical stability:
\itemize{
\item Values with \code{alpha < 1e-10} return the limit 0.
\item Output is enforced non-negative via \code{pmax(out, 0)}.
}
}
\examples{
var_K_given_alpha(50, 2.0)
var_K_given_alpha(50, c(0.5, 1, 2, 5))

# Verify underdispersion
J <- 50; alpha <- 2.0
mean_K_given_alpha(J, alpha) > var_K_given_alpha(J, alpha)  # TRUE

}
\seealso{
\code{\link{mean_K_given_alpha}}, \code{\link{moments_K_given_alpha}}

Other conditional_K: 
\code{\link{cdf_K_given_alpha}()},
\code{\link{cv_K_given_alpha}()},
\code{\link{dispersion_K_given_alpha}()},
\code{\link{log_pmf_K_given_alpha}()},
\code{\link{mean_K_given_alpha}()},
\code{\link{mode_K_given_alpha}()},
\code{\link{moments_K_given_alpha}()},
\code{\link{pmf_K_given_alpha}()},
\code{\link{quantile_K_given_alpha}()}
}
\concept{conditional_K}
