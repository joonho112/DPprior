<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Complete API Reference with Examples ‚Ä¢ DPprior</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="‚Äùimage/svg+xml‚Äù" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Complete API Reference with Examples">
<meta name="description" content="A comprehensive reference for all DPprior package functions, organized by  category with detailed signatures, parameters, return values, and usage examples.
">
<meta property="og:description" content="A comprehensive reference for all DPprior package functions, organized by  category with detailed signatures, parameters, return values, and usage examples.
">
<meta property="og:image" content="https://joonho112.github.io/DPprior/logo.svg">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DPprior</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><h6 class="dropdown-header" data-toc-skip>--- Applied Track ---</h6></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/quick-start.html">Quick Start</a></li>
    <li><a class="dropdown-item" href="../articles/applied-guide.html">Applied Guide</a></li>
    <li><a class="dropdown-item" href="../articles/dual-anchor.html">Dual-Anchor Framework</a></li>
    <li><a class="dropdown-item" href="../articles/diagnostics.html">Diagnostics</a></li>
    <li><a class="dropdown-item" href="../articles/case-studies.html">Case Studies</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>--- Methodological Track ---</h6></li>
    <li><a class="dropdown-item" href="../articles/theory-overview.html">Theory Overview</a></li>
    <li><a class="dropdown-item" href="../articles/theory-stirling.html">Stirling Numbers</a></li>
    <li><a class="dropdown-item" href="../articles/theory-approximations.html">Approximations (A1)</a></li>
    <li><a class="dropdown-item" href="../articles/theory-newton.html">Newton Algorithm (A2)</a></li>
    <li><a class="dropdown-item" href="../articles/theory-weights.html">Weight Distributions</a></li>
    <li><a class="dropdown-item" href="../articles/api-reference.html">API Reference</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/joonho112/DPprior/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Complete API Reference with Examples</h1>
                        <h4 data-toc-skip class="author">JoonHo Lee</h4>
            
            <h4 data-toc-skip class="date">2026-02-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/joonho112/DPprior/blob/main/vignettes/api-reference.Rmd" class="external-link"><code>vignettes/api-reference.Rmd</code></a></small>
      <div class="d-none name"><code>api-reference.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This vignette provides a complete API reference for the DPprior
package. All exported functions are documented with their full
signatures, parameter descriptions, return values, and usage
examples.</p>
<p>The package functions are organized into six categories:</p>
<table class="table">
<colgroup>
<col width="26%">
<col width="34%">
<col width="39%">
</colgroup>
<thead><tr class="header">
<th>Category</th>
<th>Description</th>
<th>Key Functions</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Core Elicitation</strong></td>
<td>Main user-facing calibration functions</td>
<td>
<code><a href="../reference/DPprior_fit.html">DPprior_fit()</a></code>, <code><a href="../reference/DPprior_dual.html">DPprior_dual()</a></code>
</td>
</tr>
<tr class="even">
<td><strong>Exact Computation</strong></td>
<td>Stirling numbers and exact distributions</td>
<td>
<code><a href="../reference/compute_log_stirling.html">compute_log_stirling()</a></code>,
<code><a href="../reference/pmf_K_given_alpha.html">pmf_K_given_alpha()</a></code>
</td>
</tr>
<tr class="odd">
<td><strong>Approximation</strong></td>
<td>Closed-form A1 and Newton-based A2 methods</td>
<td>
<code><a href="../reference/DPprior_a1.html">DPprior_a1()</a></code>, <code><a href="../reference/DPprior_a2_newton.html">DPprior_a2_newton()</a></code>
</td>
</tr>
<tr class="even">
<td><strong>Weight Distribution</strong></td>
<td>First stick-breaking weight
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math>
and co-clustering
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÅ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
</td>
<td>
<code><a href="../reference/mean_w1.html">mean_w1()</a></code>, <code><a href="../reference/prob_w1_exceeds.html">prob_w1_exceeds()</a></code>
</td>
</tr>
<tr class="odd">
<td><strong>Diagnostics</strong></td>
<td>Prior validation and dominance risk assessment</td>
<td>
<code><a href="../reference/DPprior_diagnostics.html">DPprior_diagnostics()</a></code>, <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>
</td>
</tr>
<tr class="even">
<td><strong>Utility</strong></td>
<td>Helper functions for conversions and integration</td>
<td>
<code><a href="../reference/vif_to_variance.html">vif_to_variance()</a></code>, <code><a href="../reference/integrate_gamma.html">integrate_gamma()</a></code>
</td>
</tr>
</tbody>
</table>
<hr>
</div>
<div class="section level2">
<h2 id="core-elicitation-functions">1. Core Elicitation Functions<a class="anchor" aria-label="anchor" href="#core-elicitation-functions"></a>
</h2>
<p>These are the primary user-facing functions for eliciting Gamma
hyperpriors on the DP concentration parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ±</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>.</p>
<div class="section level3">
<h3 id="dpprior_fit">1.1 <code>DPprior_fit()</code><a class="anchor" aria-label="anchor" href="#dpprior_fit"></a>
</h3>
<p><strong>Unified Interface for Prior Elicitation</strong></p>
<p>The main entry point for eliciting a Gamma hyperprior. Automatically
selects the appropriate algorithm based on input specification.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/DPprior_fit.html">DPprior_fit</a></span><span class="op">(</span></span>
<span>  <span class="va">J</span>,                      <span class="co"># Sample size (required)</span></span>
<span>  <span class="va">mu_K</span>,                   <span class="co"># Target E[K_J] (required)</span></span>
<span>  var_K <span class="op">=</span> <span class="cn">NULL</span>,           <span class="co"># Target Var(K_J) (optional)</span></span>
<span>  confidence <span class="op">=</span> <span class="cn">NULL</span>,      <span class="co"># "low", "medium", "high" (optional)</span></span>
<span>  method <span class="op">=</span> <span class="st">"A2-MN"</span>,       <span class="co"># "A1", "A2-MN", "A2-KL"</span></span>
<span>  check_diagnostics <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  warn_dominance <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  M <span class="op">=</span> <span class="fl">80L</span>,                <span class="co"># Quadrature nodes</span></span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Parameters:</strong></p>
<table class="table">
<colgroup>
<col width="36%">
<col width="20%">
<col width="43%">
</colgroup>
<thead><tr class="header">
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>J</code></td>
<td>Integer</td>
<td>Sample size (number of observations/sites). Must be
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>‚â•</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">\geq 2</annotation></semantics></math>.</td>
</tr>
<tr class="even">
<td><code>mu_K</code></td>
<td>Numeric</td>
<td>Target prior mean
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>K</mi><mi>J</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}[K_J]</annotation></semantics></math>.
Must satisfy
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>&lt;</mo><msub><mi>Œº</mi><mi>K</mi></msub><mo>&lt;</mo><mi>J</mi></mrow><annotation encoding="application/x-tex">1 &lt; \mu_K &lt; J</annotation></semantics></math>.</td>
</tr>
<tr class="odd">
<td><code>var_K</code></td>
<td>Numeric</td>
<td>Target prior variance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>K</mi><mi>J</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Var}(K_J)</annotation></semantics></math>.
If <code>NULL</code>, computed from <code>confidence</code>.</td>
</tr>
<tr class="even">
<td><code>confidence</code></td>
<td>Character</td>
<td>Qualitative uncertainty: <code>"low"</code> (VIF=4),
<code>"medium"</code> (VIF=2.5), <code>"high"</code> (VIF=1.5).</td>
</tr>
<tr class="odd">
<td><code>method</code></td>
<td>Character</td>
<td>Algorithm: <code>"A1"</code> (closed-form), <code>"A2-MN"</code>
(Newton), <code>"A2-KL"</code> (KL minimization).</td>
</tr>
<tr class="even">
<td><code>check_diagnostics</code></td>
<td>Logical</td>
<td>If <code>TRUE</code>, compute full diagnostics.</td>
</tr>
<tr class="odd">
<td><code>warn_dominance</code></td>
<td>Logical</td>
<td>If <code>TRUE</code>, warn when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>&gt;</mo><mn>0.5</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>&gt;</mo><mn>0.4</mn></mrow><annotation encoding="application/x-tex">P(w_1 &gt; 0.5) &gt; 0.4</annotation></semantics></math>.</td>
</tr>
<tr class="even">
<td><code>M</code></td>
<td>Integer</td>
<td>Number of Gauss-Laguerre quadrature nodes.</td>
</tr>
<tr class="odd">
<td><code>verbose</code></td>
<td>Logical</td>
<td>Print iteration progress.</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong> An S3 object of class
<code>DPprior_fit</code> with components:</p>
<table class="table">
<thead><tr class="header">
<th>Component</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>a</code></td>
<td>Optimal Gamma shape parameter</td>
</tr>
<tr class="even">
<td><code>b</code></td>
<td>Optimal Gamma rate parameter</td>
</tr>
<tr class="odd">
<td><code>J</code></td>
<td>Sample size</td>
</tr>
<tr class="even">
<td><code>target</code></td>
<td>List with <code>mu_K</code>, <code>var_K</code>,
<code>var_K_used</code>
</td>
</tr>
<tr class="odd">
<td><code>fit</code></td>
<td>Achieved <code>mu_K</code>, <code>var_K</code>, and
<code>residual</code>
</td>
</tr>
<tr class="even">
<td><code>method</code></td>
<td>Algorithm used</td>
</tr>
<tr class="odd">
<td><code>converged</code></td>
<td>Logical convergence indicator</td>
</tr>
<tr class="even">
<td><code>iterations</code></td>
<td>Number of iterations (0 for A1)</td>
</tr>
<tr class="odd">
<td><code>diagnostics</code></td>
<td>Optional diagnostic information</td>
</tr>
</tbody>
</table>
<p><strong>Examples:</strong></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Basic usage with confidence level</span></span>
<span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_fit.html">DPprior_fit</a></span><span class="op">(</span>J <span class="op">=</span> <span class="fl">50</span>, mu_K <span class="op">=</span> <span class="fl">5</span>, confidence <span class="op">=</span> <span class="st">"medium"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: HIGH DOMINANCE RISK: P(w1 &gt; 0.5) = 49.7% exceeds 40%.</span></span>
<span><span class="co">#&gt;   This may indicate unintended prior behavior (Lee, 2026).</span></span>
<span><span class="co">#&gt;   Consider using DPprior_dual() for weight-constrained elicitation.</span></span>
<span><span class="co">#&gt;   See ?DPprior_diagnostics for interpretation.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></span>
<span><span class="co">#&gt; DPprior Prior Elicitation Result</span></span>
<span><span class="co">#&gt; ============================================= </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Gamma Hyperprior: Œ± ~ Gamma(a = 1.4082, b = 1.0770)</span></span>
<span><span class="co">#&gt;   E[Œ±] = 1.308, SD[Œ±] = 1.102</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Target (J = 50):</span></span>
<span><span class="co">#&gt;   E[K_J]   = 5.00</span></span>
<span><span class="co">#&gt;   Var(K_J) = 10.00</span></span>
<span><span class="co">#&gt;   (from confidence = 'medium')</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Achieved:</span></span>
<span><span class="co">#&gt;   E[K_J] = 5.000000, Var(K_J) = 10.000000</span></span>
<span><span class="co">#&gt;   Residual = 3.94e-10</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Method: A2-MN (7 iterations)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Dominance Risk: HIGH ‚úò (P(w‚ÇÅ&gt;0.5) = 50%)</span></span>
<span></span>
<span><span class="co"># Direct variance specification</span></span>
<span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_fit.html">DPprior_fit</a></span><span class="op">(</span>J <span class="op">=</span> <span class="fl">50</span>, mu_K <span class="op">=</span> <span class="fl">5</span>, var_K <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: HIGH DOMINANCE RISK: P(w1 &gt; 0.5) = 49.7% exceeds 40%.</span></span>
<span><span class="co">#&gt;   This may indicate unintended prior behavior (Lee, 2026).</span></span>
<span><span class="co">#&gt;   Consider using DPprior_dual() for weight-constrained elicitation.</span></span>
<span><span class="co">#&gt;   See ?DPprior_diagnostics for interpretation.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Gamma("</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">$</span><span class="va">a</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">", "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">$</span><span class="va">b</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">")\n"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="co">#&gt; Gamma(1.4082, 1.077)</span></span>
<span></span>
<span><span class="co"># Using A1 closed-form (faster for large J)</span></span>
<span><span class="va">fit3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_fit.html">DPprior_fit</a></span><span class="op">(</span>J <span class="op">=</span> <span class="fl">200</span>, mu_K <span class="op">=</span> <span class="fl">15</span>, var_K <span class="op">=</span> <span class="fl">30</span>, method <span class="op">=</span> <span class="st">"A1"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># With diagnostics</span></span>
<span><span class="va">fit4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_fit.html">DPprior_fit</a></span><span class="op">(</span>J <span class="op">=</span> <span class="fl">50</span>, mu_K <span class="op">=</span> <span class="fl">5</span>, var_K <span class="op">=</span> <span class="fl">8</span>, check_diagnostics <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: HIGH DOMINANCE RISK: P(w1 &gt; 0.5) = 48.1% exceeds 40%.</span></span>
<span><span class="co">#&gt;   This may indicate unintended prior behavior (Lee, 2026).</span></span>
<span><span class="co">#&gt;   Consider using DPprior_dual() for weight-constrained elicitation.</span></span>
<span><span class="co">#&gt;   See ?DPprior_diagnostics for interpretation.</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="dpprior_dual">1.2 <code>DPprior_dual()</code><a class="anchor" aria-label="anchor" href="#dpprior_dual"></a>
</h3>
<p><strong>Dual-Anchor Elicitation with Weight Control</strong></p>
<p>Extends moment-based elicitation to incorporate constraints on the
stick-breaking weight distribution, addressing the ‚Äúunintended prior‚Äù
problem identified in Lee (2026, Section 4).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/DPprior_dual.html">DPprior_dual</a></span><span class="op">(</span></span>
<span>  <span class="va">fit_K</span>,                  <span class="co"># K-only DPprior_fit object (required)</span></span>
<span>  <span class="va">w1_target</span>,              <span class="co"># Weight target specification (required)</span></span>
<span>  lambda <span class="op">=</span> <span class="fl">0.7</span>,           <span class="co"># Trade-off parameter [0, 1]</span></span>
<span>  loss_type <span class="op">=</span> <span class="st">"adaptive"</span>, <span class="co"># "absolute", "relative", "adaptive"</span></span>
<span>  method <span class="op">=</span> <span class="st">"L-BFGS-B"</span>,    <span class="co"># Optimization method</span></span>
<span>  max_iter <span class="op">=</span> <span class="fl">100L</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">1e-6</span>,</span>
<span>  M <span class="op">=</span> <span class="fl">80L</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Parameters:</strong></p>
<table class="table">
<colgroup>
<col width="36%">
<col width="20%">
<col width="43%">
</colgroup>
<thead><tr class="header">
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>fit_K</code></td>
<td>DPprior_fit</td>
<td>Initial K-only fit from <code><a href="../reference/DPprior_fit.html">DPprior_fit()</a></code> or
<code><a href="../reference/DPprior_a2_newton.html">DPprior_a2_newton()</a></code>.</td>
</tr>
<tr class="even">
<td><code>w1_target</code></td>
<td>List</td>
<td>Weight target: <code>list(prob = list(threshold, value))</code> for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>&gt;</mo><mtext mathvariant="normal">threshold</mtext><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mtext mathvariant="normal">value</mtext></mrow><annotation encoding="application/x-tex">P(w_1 &gt; \text{threshold}) = \text{value}</annotation></semantics></math>.</td>
</tr>
<tr class="odd">
<td><code>lambda</code></td>
<td>Numeric</td>
<td>Trade-off: 0 = pure weight, 1 = pure K. Default: 0.7.</td>
</tr>
<tr class="even">
<td><code>loss_type</code></td>
<td>Character</td>
<td>Loss function type for weight anchor.</td>
</tr>
<tr class="odd">
<td><code>method</code></td>
<td>Character</td>
<td>Optimization algorithm for <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim()</a></code>.</td>
</tr>
<tr class="even">
<td><code>max_iter</code></td>
<td>Integer</td>
<td>Maximum optimization iterations.</td>
</tr>
<tr class="odd">
<td><code>tol</code></td>
<td>Numeric</td>
<td>Convergence tolerance.</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong> A <code>DPprior_fit</code> object with
additional <code>dual_anchor</code> component containing:</p>
<table class="table">
<thead><tr class="header">
<th>Component</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>lambda</code></td>
<td>Trade-off parameter used</td>
</tr>
<tr class="even">
<td><code>w1_target</code></td>
<td>Original weight target</td>
</tr>
<tr class="odd">
<td><code>w1_achieved</code></td>
<td>Achieved weight statistics</td>
</tr>
<tr class="even">
<td><code>K_achieved</code></td>
<td>Achieved K moments</td>
</tr>
<tr class="odd">
<td><code>init</code></td>
<td>Initial K-only parameters</td>
</tr>
</tbody>
</table>
<p><strong>Examples:</strong></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Step 1: Fit K-only prior</span></span>
<span><span class="va">fit_K</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_fit.html">DPprior_fit</a></span><span class="op">(</span>J <span class="op">=</span> <span class="fl">50</span>, mu_K <span class="op">=</span> <span class="fl">5</span>, var_K <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: HIGH DOMINANCE RISK: P(w1 &gt; 0.5) = 48.1% exceeds 40%.</span></span>
<span><span class="co">#&gt;   This may indicate unintended prior behavior (Lee, 2026).</span></span>
<span><span class="co">#&gt;   Consider using DPprior_dual() for weight-constrained elicitation.</span></span>
<span><span class="co">#&gt;   See ?DPprior_diagnostics for interpretation.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"K-only: P(w1 &gt; 0.5) ="</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="../reference/prob_w1_exceeds.html">prob_w1_exceeds</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="va">fit_K</span><span class="op">$</span><span class="va">a</span>, <span class="va">fit_K</span><span class="op">$</span><span class="va">b</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; K-only: P(w1 &gt; 0.5) = 0.481</span></span>
<span></span>
<span><span class="co"># Step 2: Apply weight constraint</span></span>
<span><span class="va">w1_target</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>threshold <span class="op">=</span> <span class="fl">0.5</span>, value <span class="op">=</span> <span class="fl">0.30</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fit_dual</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_dual.html">DPprior_dual</a></span><span class="op">(</span><span class="va">fit_K</span>, <span class="va">w1_target</span>, lambda <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Dual:   P(w1 &gt; 0.5) ="</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="../reference/prob_w1_exceeds.html">prob_w1_exceeds</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="va">fit_dual</span><span class="op">$</span><span class="va">a</span>, <span class="va">fit_dual</span><span class="op">$</span><span class="va">b</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dual:   P(w1 &gt; 0.5) = 0.438</span></span>
<span></span>
<span><span class="co"># Compare parameters</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nParameter comparison:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter comparison:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  K-only: Gamma("</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fit_K</span><span class="op">$</span><span class="va">a</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">", "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fit_K</span><span class="op">$</span><span class="va">b</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">")\n"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="co">#&gt;   K-only: Gamma(2.036, 1.605)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Dual:   Gamma("</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fit_dual</span><span class="op">$</span><span class="va">a</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">", "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fit_dual</span><span class="op">$</span><span class="va">b</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">")\n"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Dual:   Gamma(2.575, 1.834)</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="exact-computation-functions">2. Exact Computation Functions<a class="anchor" aria-label="anchor" href="#exact-computation-functions"></a>
</h2>
<p>These functions provide exact computation of Stirling numbers, PMFs,
and moments using numerically stable log-space arithmetic.</p>
<div class="section level3">
<h3 id="stirling-number-functions">2.1 Stirling Number Functions<a class="anchor" aria-label="anchor" href="#stirling-number-functions"></a>
</h3>
<div class="section level4">
<h4 id="compute_log_stirling">
<code>compute_log_stirling()</code><a class="anchor" aria-label="anchor" href="#compute_log_stirling"></a>
</h4>
<p><strong>Pre-compute Log Stirling Numbers</strong></p>
<p>Computes the logarithm of unsigned Stirling numbers of the first kind
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">|</mo><mi>s</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>J</mi><mo>,</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">|</mo></mrow><annotation encoding="application/x-tex">|s(J,k)|</annotation></semantics></math>
for all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>J</mi><annotation encoding="application/x-tex">J</annotation></semantics></math>
from 0 to <code>J_max</code> and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
from 0 to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>J</mi><annotation encoding="application/x-tex">J</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/compute_log_stirling.html">compute_log_stirling</a></span><span class="op">(</span><span class="va">J_max</span><span class="op">)</span></span></code></pre></div>
<p><strong>Parameters:</strong></p>
<table class="table">
<thead><tr class="header">
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr></thead>
<tbody><tr class="odd">
<td><code>J_max</code></td>
<td>Integer</td>
<td>Maximum sample size. Must be
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>‚â§</mo><mn>500</mn></mrow><annotation encoding="application/x-tex">\leq 500</annotation></semantics></math>.</td>
</tr></tbody>
</table>
<p><strong>Returns:</strong> A lower triangular matrix of dimension
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>J</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>√ó</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>J</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">(J_{max}+1) \times (J_{max}+1)</annotation></semantics></math>.
Entry <code>[J+1, k+1]</code> contains
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">|</mo><mi>s</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>J</mi><mo>,</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">|</mo></mrow></mrow><annotation encoding="application/x-tex">\log|s(J,k)|</annotation></semantics></math>
(using R‚Äôs 1-based indexing).</p>
<p><strong>Examples:</strong></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Pre-compute for J up to 100</span></span>
<span><span class="va">logS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_log_stirling.html">compute_log_stirling</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Access |s(10,3)| = 9450</span></span>
<span><span class="va">s_10_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">logS</span><span class="op">[</span><span class="fl">11</span>, <span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"|s(10,3)| ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">s_10_3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; |s(10,3)| = 1172700</span></span>
<span></span>
<span><span class="co"># Verify row sum identity: sum_k |s(J,k)| = J!</span></span>
<span><span class="va">J</span> <span class="op">&lt;-</span> <span class="fl">6</span></span>
<span><span class="va">row_sum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">logS</span><span class="op">[</span><span class="va">J</span><span class="op">+</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">:</span><span class="op">(</span><span class="va">J</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"sum |s(6,k)| ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">row_sum</span><span class="op">)</span>, <span class="st">", 6! ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">factorial</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; sum |s(6,k)| = 720 , 6! = 720</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="get_log_stirling">
<code>get_log_stirling()</code><a class="anchor" aria-label="anchor" href="#get_log_stirling"></a>
</h4>
<p><strong>Safe Accessor with Bounds Checking</strong></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_log_stirling.html">get_log_stirling</a></span><span class="op">(</span><span class="va">J</span>, <span class="va">k</span>, <span class="va">logS</span><span class="op">)</span></span></code></pre></div>
<p>Returns
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">|</mo><mi>s</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>J</mi><mo>,</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">|</mo></mrow></mrow><annotation encoding="application/x-tex">\log|s(J,k)|</annotation></semantics></math>
with automatic bounds checking. Returns <code>-Inf</code> for invalid
indices
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>&gt;</mo><mi>J</mi></mrow><annotation encoding="application/x-tex">k &gt; J</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k &lt; 1</annotation></semantics></math>).</p>
</div>
<div class="section level4">
<h4 id="get_stirling_row">
<code>get_stirling_row()</code><a class="anchor" aria-label="anchor" href="#get_stirling_row"></a>
</h4>
<p><strong>Extract Row of Stirling Numbers</strong></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_stirling_row.html">get_stirling_row</a></span><span class="op">(</span><span class="va">J</span>, <span class="va">logS</span><span class="op">)</span></span></code></pre></div>
<p>Returns a vector of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">|</mo><mi>s</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>J</mi><mo>,</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">|</mo></mrow></mrow><annotation encoding="application/x-tex">\log|s(J,k)|</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><mi>J</mi></mrow><annotation encoding="application/x-tex">k = 1, \ldots, J</annotation></semantics></math>.</p>
</div>
</div>
<div class="section level3">
<h3 id="conditional-pmf-functions">2.2 Conditional PMF Functions<a class="anchor" aria-label="anchor" href="#conditional-pmf-functions"></a>
</h3>
<div class="section level4">
<h4 id="pmf_k_given_alpha">
<code>pmf_K_given_alpha()</code><a class="anchor" aria-label="anchor" href="#pmf_k_given_alpha"></a>
</h4>
<p><strong>Antoniak Distribution PMF</strong></p>
<p>Computes the exact conditional PMF
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>K</mi><mi>J</mi></msub><mo>=</mo><mi>k</mi><mo stretchy="false" form="prefix">|</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(K_J = k | \alpha)</annotation></semantics></math>
using the Antoniak distribution formula:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>K</mi><mi>J</mi></msub><mo>=</mo><mi>k</mi><mo stretchy="false" form="prefix">|</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mrow><mo stretchy="true" form="prefix">|</mo><mi>s</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>J</mi><mo>,</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">|</mo></mrow><mo>‚ãÖ</mo><msup><mi>Œ±</mi><mi>k</mi></msup></mrow><msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>J</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">
P(K_J = k | \alpha) = \frac{|s(J,k)| \cdot \alpha^k}{(\alpha)_J}
</annotation></semantics></math></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pmf_K_given_alpha.html">pmf_K_given_alpha</a></span><span class="op">(</span><span class="va">J</span>, <span class="va">alpha</span>, <span class="va">logS</span>, normalize <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><strong>Parameters:</strong></p>
<table class="table">
<thead><tr class="header">
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>J</code></td>
<td>Integer</td>
<td>Sample size.</td>
</tr>
<tr class="even">
<td><code>alpha</code></td>
<td>Numeric</td>
<td>Concentration parameter (scalar,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">&gt; 0</annotation></semantics></math>).</td>
</tr>
<tr class="odd">
<td><code>logS</code></td>
<td>Matrix</td>
<td>Pre-computed log-Stirling matrix.</td>
</tr>
<tr class="even">
<td><code>normalize</code></td>
<td>Logical</td>
<td>If <code>TRUE</code>, ensure PMF sums to 1.</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong> Numeric vector of length
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">J+1</annotation></semantics></math>
containing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>K</mi><mi>J</mi></msub><mo>=</mo><mi>k</mi><mo stretchy="false" form="prefix">|</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(K_J = k | \alpha)</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><mi>J</mi></mrow><annotation encoding="application/x-tex">k = 0, 1, \ldots, J</annotation></semantics></math>.
Note:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>K</mi><mi>J</mi></msub><mo>=</mo><mn>0</mn><mo stretchy="false" form="prefix">|</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">P(K_J = 0 | \alpha) = 0</annotation></semantics></math>
always.</p>
<p><strong>Examples:</strong></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">J</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">2.0</span></span>
<span><span class="va">logS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_log_stirling.html">compute_log_stirling</a></span><span class="op">(</span><span class="va">J</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute conditional PMF</span></span>
<span><span class="va">pmf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pmf_K_given_alpha.html">pmf_K_given_alpha</a></span><span class="op">(</span><span class="va">J</span>, <span class="va">alpha</span>, <span class="va">logS</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Find mode</span></span>
<span><span class="va">mode_k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="va">pmf</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Mode of K|Œ±=2:"</span>, <span class="va">mode_k</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Mode of K|Œ±=2: 7</span></span>
<span></span>
<span><span class="co"># Verify normalization</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"PMF sum:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">pmf</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; PMF sum: 1</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="cdf_k_given_alpha">
<code>cdf_K_given_alpha()</code><a class="anchor" aria-label="anchor" href="#cdf_k_given_alpha"></a>
</h4>
<p><strong>Conditional CDF</strong></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cdf_K_given_alpha.html">cdf_K_given_alpha</a></span><span class="op">(</span><span class="va">J</span>, <span class="va">alpha</span>, <span class="va">logS</span><span class="op">)</span></span></code></pre></div>
<p>Returns the cumulative distribution function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>K</mi><mi>J</mi></msub><mo>‚â§</mo><mi>k</mi><mo stretchy="false" form="prefix">|</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">F(k) = P(K_J \leq k | \alpha)</annotation></semantics></math>.</p>
</div>
<div class="section level4">
<h4 id="quantile_k_given_alpha">
<code>quantile_K_given_alpha()</code><a class="anchor" aria-label="anchor" href="#quantile_k_given_alpha"></a>
</h4>
<p><strong>Conditional Quantile Function</strong></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/quantile_K_given_alpha.html">quantile_K_given_alpha</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">J</span>, <span class="va">alpha</span>, <span class="va">logS</span><span class="op">)</span></span></code></pre></div>
<p>Returns the smallest
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
such that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>K</mi><mi>J</mi></msub><mo>‚â§</mo><mi>k</mi><mo stretchy="false" form="prefix">|</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚â•</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">P(K_J \leq k | \alpha) \geq p</annotation></semantics></math>.</p>
</div>
</div>
<div class="section level3">
<h3 id="conditional-moment-functions">2.3 Conditional Moment Functions<a class="anchor" aria-label="anchor" href="#conditional-moment-functions"></a>
</h3>
<div class="section level4">
<h4 id="mean_k_given_alpha">
<code>mean_K_given_alpha()</code><a class="anchor" aria-label="anchor" href="#mean_k_given_alpha"></a>
</h4>
<p><strong>Conditional Mean via Digamma</strong></p>
<p>Computes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>K</mi><mi>J</mi></msub><mo stretchy="false" form="prefix">|</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mi>Œ±</mi><mo stretchy="false" form="prefix">{</mo><mi>œà</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo>+</mo><mi>J</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><mi>œà</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\mathbb{E}[K_J | \alpha] = \alpha \{\psi(\alpha + J) - \psi(\alpha)\}</annotation></semantics></math>
using the digamma function.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mean_K_given_alpha.html">mean_K_given_alpha</a></span><span class="op">(</span><span class="va">J</span>, <span class="va">alpha</span><span class="op">)</span></span></code></pre></div>
<p><strong>Parameters:</strong></p>
<table class="table">
<thead><tr class="header">
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>J</code></td>
<td>Integer</td>
<td>Sample size
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>‚â•</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\geq 1</annotation></semantics></math>).</td>
</tr>
<tr class="even">
<td><code>alpha</code></td>
<td>Numeric</td>
<td>Concentration parameter (vectorized).</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong> Numeric vector of conditional means.</p>
<p><strong>Examples:</strong></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">J</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span></span>
<span><span class="co"># Single alpha</span></span>
<span><span class="fu"><a href="../reference/mean_K_given_alpha.html">mean_K_given_alpha</a></span><span class="op">(</span><span class="va">J</span>, <span class="fl">2.0</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 7.037626</span></span>
<span></span>
<span><span class="co"># Vectorized</span></span>
<span><span class="va">alpha_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">means</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mean_K_given_alpha.html">mean_K_given_alpha</a></span><span class="op">(</span><span class="va">J</span>, <span class="va">alpha_seq</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="va">alpha_seq</span>, E_K <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">means</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   alpha   E_K</span></span>
<span><span class="co">#&gt; 1   0.5  2.94</span></span>
<span><span class="co">#&gt; 2   1.0  4.50</span></span>
<span><span class="co">#&gt; 3   2.0  7.04</span></span>
<span><span class="co">#&gt; 4   5.0 12.46</span></span>
<span><span class="co">#&gt; 5  10.0 18.34</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="var_k_given_alpha">
<code>var_K_given_alpha()</code><a class="anchor" aria-label="anchor" href="#var_k_given_alpha"></a>
</h4>
<p><strong>Conditional Variance via Trigamma</strong></p>
<p>Computes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>K</mi><mi>J</mi></msub><mo stretchy="false" form="prefix">|</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>Œº</mi><mi>J</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><msup><mi>Œ±</mi><mn>2</mn></msup><mo stretchy="false" form="prefix">{</mo><msub><mi>œà</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><msub><mi>œà</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo>+</mo><mi>J</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\text{Var}(K_J | \alpha) = \mu_J(\alpha) - \alpha^2 \{\psi_1(\alpha) - \psi_1(\alpha + J)\}</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/var_K_given_alpha.html">var_K_given_alpha</a></span><span class="op">(</span><span class="va">J</span>, <span class="va">alpha</span><span class="op">)</span></span></code></pre></div>
<p><strong>Key Property:</strong> Conditional underdispersion always
holds:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&lt;</mo><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>K</mi><mi>J</mi></msub><mo stretchy="false" form="prefix">|</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>&lt;</mo><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>K</mi><mi>J</mi></msub><mo stretchy="false" form="prefix">|</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">
0 &lt; \text{Var}(K_J | \alpha) &lt; \mathbb{E}[K_J | \alpha]
</annotation></semantics></math></p>
<p><strong>Examples:</strong></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">J</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">2.0</span></span>
<span></span>
<span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mean_K_given_alpha.html">mean_K_given_alpha</a></span><span class="op">(</span><span class="va">J</span>, <span class="va">alpha</span><span class="op">)</span></span>
<span><span class="va">sigma2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/var_K_given_alpha.html">var_K_given_alpha</a></span><span class="op">(</span><span class="va">J</span>, <span class="va">alpha</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"E[K|Œ±=2] ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">mu</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; E[K|Œ±=2] = 7.0376</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Var(K|Œ±=2) ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">sigma2</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Var(K|Œ±=2) = 4.5356</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Underdispersion ratio:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">sigma2</span><span class="op">/</span><span class="va">mu</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"&lt; 1 ‚úì\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Underdispersion ratio: 0.6445 &lt; 1 ‚úì</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="moments_k_given_alpha">
<code>moments_K_given_alpha()</code><a class="anchor" aria-label="anchor" href="#moments_k_given_alpha"></a>
</h4>
<p><strong>Both Moments in One Call</strong></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/moments_K_given_alpha.html">moments_K_given_alpha</a></span><span class="op">(</span><span class="va">J</span>, <span class="va">alpha</span><span class="op">)</span></span></code></pre></div>
<p>Returns a list with <code>mean</code> and <code>var</code>.</p>
</div>
</div>
<div class="section level3">
<h3 id="marginal-distribution-functions">2.4 Marginal Distribution Functions<a class="anchor" aria-label="anchor" href="#marginal-distribution-functions"></a>
</h3>
<div class="section level4">
<h4 id="exact_k_moments">
<code>exact_K_moments()</code><a class="anchor" aria-label="anchor" href="#exact_k_moments"></a>
</h4>
<p><strong>Marginal Moments under Gamma Hyperprior</strong></p>
<p>Computes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>K</mi><mi>J</mi></msub><mo stretchy="false" form="prefix">|</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}[K_J | a, b]</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>K</mi><mi>J</mi></msub><mo stretchy="false" form="prefix">|</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Var}(K_J | a, b)</annotation></semantics></math>
when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ±</mi><mo>‚àº</mo><mtext mathvariant="normal">Gamma</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\alpha \sim \text{Gamma}(a, b)</annotation></semantics></math>
using Gauss-Laguerre quadrature.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/exact_K_moments.html">exact_K_moments</a></span><span class="op">(</span><span class="va">J</span>, <span class="va">a</span>, <span class="va">b</span>, M <span class="op">=</span> <span class="fl">80L</span><span class="op">)</span></span></code></pre></div>
<p><strong>Parameters:</strong></p>
<table class="table">
<thead><tr class="header">
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>J</code></td>
<td>Integer</td>
<td>Sample size.</td>
</tr>
<tr class="even">
<td><code>a</code></td>
<td>Numeric</td>
<td>Gamma shape parameter.</td>
</tr>
<tr class="odd">
<td><code>b</code></td>
<td>Numeric</td>
<td>Gamma rate parameter.</td>
</tr>
<tr class="even">
<td><code>M</code></td>
<td>Integer</td>
<td>Number of quadrature nodes.</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong> A list with components:</p>
<table class="table">
<thead><tr class="header">
<th>Component</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>mean</code></td>
<td>Marginal mean
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">M_1(a,b)</annotation></semantics></math>
</td>
</tr>
<tr class="even">
<td><code>var</code></td>
<td>Marginal variance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">V(a,b)</annotation></semantics></math>
</td>
</tr>
<tr class="odd">
<td><code>sd</code></td>
<td>Standard deviation</td>
</tr>
<tr class="even">
<td><code>cv</code></td>
<td>Coefficient of variation</td>
</tr>
</tbody>
</table>
<p><strong>Examples:</strong></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute marginal moments</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/exact_K_moments.html">exact_K_moments</a></span><span class="op">(</span>J <span class="op">=</span> <span class="fl">50</span>, a <span class="op">=</span> <span class="fl">1.6</span>, b <span class="op">=</span> <span class="fl">1.22</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"E[K_50] ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">mean</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; E[K_50] = 5.0454</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Var(K_50) ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">var</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Var(K_50) = 9.3797</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"CV(K_50) ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">cv</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; CV(K_50) = 0.607</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="pmf_k_marginal">
<code>pmf_K_marginal()</code><a class="anchor" aria-label="anchor" href="#pmf_k_marginal"></a>
</h4>
<p><strong>Marginal PMF via Quadrature Mixture</strong></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pmf_K_marginal.html">pmf_K_marginal</a></span><span class="op">(</span><span class="va">J</span>, <span class="va">a</span>, <span class="va">b</span>, <span class="va">logS</span>, M <span class="op">=</span> <span class="fl">80L</span><span class="op">)</span></span></code></pre></div>
<p>Computes the marginal PMF by mixing conditional PMFs over
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ±</mi><mo>‚àº</mo><mtext mathvariant="normal">Gamma</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\alpha \sim \text{Gamma}(a,b)</annotation></semantics></math>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>K</mi><mi>J</mi></msub><mo>=</mo><mi>k</mi><mo stretchy="false" form="prefix">|</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msubsup><mo>‚à´</mo><mn>0</mn><mi>‚àû</mi></msubsup><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>K</mi><mi>J</mi></msub><mo>=</mo><mi>k</mi><mo stretchy="false" form="prefix">|</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚ãÖ</mo><msub><mi>g</mi><mrow><mi>a</mi><mo>,</mo><mi>b</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mi>d</mi><mi>Œ±</mi></mrow><annotation encoding="application/x-tex">
P(K_J = k | a, b) = \int_0^\infty P(K_J = k | \alpha) \cdot g_{a,b}(\alpha) \, d\alpha
</annotation></semantics></math></p>
<p><strong>Examples:</strong></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">J</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">logS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_log_stirling.html">compute_log_stirling</a></span><span class="op">(</span><span class="va">J</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pmf_marginal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pmf_K_marginal.html">pmf_K_marginal</a></span><span class="op">(</span><span class="va">J</span>, a <span class="op">=</span> <span class="fl">1.6</span>, b <span class="op">=</span> <span class="fl">1.22</span>, <span class="va">logS</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Find mode</span></span>
<span><span class="va">mode_k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="va">pmf_marginal</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Mode of marginal K:"</span>, <span class="va">mode_k</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Mode of marginal K: 3</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="summary_k_marginal">
<code>summary_K_marginal()</code><a class="anchor" aria-label="anchor" href="#summary_k_marginal"></a>
</h4>
<p><strong>Complete Marginal Distribution Summary</strong></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/summary_K_marginal.html">summary_K_marginal</a></span><span class="op">(</span><span class="va">J</span>, <span class="va">a</span>, <span class="va">b</span>, <span class="va">logS</span>, M <span class="op">=</span> <span class="fl">80L</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Returns mean, variance, mode, median, quantiles, PMF, and CDF.</p>
<hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="approximation-functions">3. Approximation Functions<a class="anchor" aria-label="anchor" href="#approximation-functions"></a>
</h2>
<div class="section level3">
<h3 id="dpprior_a1">3.1 <code>DPprior_a1()</code><a class="anchor" aria-label="anchor" href="#dpprior_a1"></a>
</h3>
<p><strong>A1 Closed-Form Approximation</strong></p>
<p>Fast closed-form solution using the negative binomial approximation
to the marginal distribution of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>J</mi></msub><annotation encoding="application/x-tex">K_J</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/DPprior_a1.html">DPprior_a1</a></span><span class="op">(</span></span>
<span>  <span class="va">J</span>,                      <span class="co"># Sample size</span></span>
<span>  <span class="va">mu_K</span>,                   <span class="co"># Target mean</span></span>
<span>  var_K <span class="op">=</span> <span class="cn">NULL</span>,           <span class="co"># Target variance</span></span>
<span>  confidence <span class="op">=</span> <span class="cn">NULL</span>,      <span class="co"># "low", "medium", "high"</span></span>
<span>  scaling <span class="op">=</span> <span class="st">"log"</span>,        <span class="co"># "log", "harmonic", "digamma"</span></span>
<span>  project_to_feasible <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Key Formulas:</strong>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Œº</mi><mi>K</mi></msub><mo>‚àí</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mrow><msubsup><mi>œÉ</mi><mi>K</mi><mn>2</mn></msubsup><mo>‚àí</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Œº</mi><mi>K</mi></msub><mo>‚àí</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>,</mo><mspace width="1.0em"></mspace><mi>b</mi><mo>=</mo><mfrac><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Œº</mi><mi>K</mi></msub><mo>‚àí</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚ãÖ</mo><msub><mi>c</mi><mi>J</mi></msub></mrow><mrow><msubsup><mi>œÉ</mi><mi>K</mi><mn>2</mn></msubsup><mo>‚àí</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Œº</mi><mi>K</mi></msub><mo>‚àí</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">
a = \frac{(\mu_K - 1)^2}{\sigma^2_K - (\mu_K - 1)}, \quad
b = \frac{(\mu_K - 1) \cdot c_J}{\sigma^2_K - (\mu_K - 1)}
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>c</mi><mi>J</mi></msub><annotation encoding="application/x-tex">c_J</annotation></semantics></math>
is the scaling constant (default:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mi>J</mi></mrow><annotation encoding="application/x-tex">\log J</annotation></semantics></math>).</p>
<p><strong>Feasibility Constraint:</strong> Requires
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>œÉ</mi><mi>K</mi><mn>2</mn></msubsup><mo>&gt;</mo><msub><mi>Œº</mi><mi>K</mi></msub><mo>‚àí</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sigma^2_K &gt; \mu_K - 1</annotation></semantics></math>.</p>
<p><strong>Examples:</strong></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Basic A1 fit</span></span>
<span><span class="va">fit_a1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_a1.html">DPprior_a1</a></span><span class="op">(</span>J <span class="op">=</span> <span class="fl">50</span>, mu_K <span class="op">=</span> <span class="fl">5</span>, var_K <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"A1 solution: Gamma("</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fit_a1</span><span class="op">$</span><span class="va">a</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">", "</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fit_a1</span><span class="op">$</span><span class="va">b</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">")\n"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="co">#&gt; A1 solution: Gamma(4, 3.912)</span></span>
<span></span>
<span><span class="co"># Compare scaling methods</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">s</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"log"</span>, <span class="st">"harmonic"</span>, <span class="st">"digamma"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_a1.html">DPprior_a1</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">5</span>, <span class="fl">8</span>, scaling <span class="op">=</span> <span class="va">s</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  %s: cJ = %.4f\n"</span>, <span class="va">s</span>, <span class="va">fit</span><span class="op">$</span><span class="va">cJ</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt;   log: cJ = 3.9120</span></span>
<span><span class="co">#&gt;   harmonic: cJ = 4.4792</span></span>
<span><span class="co">#&gt;   digamma: cJ = 4.4633</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="dpprior_a2_newton">3.2 <code>DPprior_a2_newton()</code><a class="anchor" aria-label="anchor" href="#dpprior_a2_newton"></a>
</h3>
<p><strong>A2-MN Newton Solver for Exact Moment Matching</strong></p>
<p>Finds
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>a</mi><mo>*</mo></msup><mo>,</mo><msup><mi>b</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(a^*, b^*)</annotation></semantics></math>
such that the induced marginal moments exactly match targets.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/DPprior_a2_newton.html">DPprior_a2_newton</a></span><span class="op">(</span></span>
<span>  <span class="va">J</span>,                      <span class="co"># Sample size</span></span>
<span>  <span class="va">mu_K</span>,                   <span class="co"># Target mean</span></span>
<span>  <span class="va">var_K</span>,                  <span class="co"># Target variance</span></span>
<span>  a0 <span class="op">=</span> <span class="cn">NULL</span>,              <span class="co"># Initial shape (from A1 if NULL)</span></span>
<span>  b0 <span class="op">=</span> <span class="cn">NULL</span>,              <span class="co"># Initial rate (from A1 if NULL)</span></span>
<span>  tol_F <span class="op">=</span> <span class="fl">1e-8</span>,           <span class="co"># Residual tolerance</span></span>
<span>  tol_step <span class="op">=</span> <span class="fl">1e-10</span>,       <span class="co"># Step size tolerance</span></span>
<span>  max_iter <span class="op">=</span> <span class="fl">20L</span>,</span>
<span>  damping <span class="op">=</span> <span class="cn">TRUE</span>,         <span class="co"># Backtracking line search</span></span>
<span>  use_fallback <span class="op">=</span> <span class="cn">TRUE</span>,    <span class="co"># Nelder-Mead fallback</span></span>
<span>  M <span class="op">=</span> <span class="fl">80L</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Algorithm:</strong></p>
<ol style="list-style-type: decimal">
<li>Initialize from A1 closed-form</li>
<li>Log-parameterize:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ∑</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>log</mo><mi>a</mi><mo>,</mo><mo>log</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\eta = (\log a, \log b)</annotation></semantics></math>
</li>
<li>Newton iteration with score-based Jacobian</li>
<li>Backtracking line search for global convergence</li>
</ol>
<p><strong>Convergence:</strong> Typically achieves machine-precision
accuracy in 3-8 iterations.</p>
<p><strong>Examples:</strong></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Exact moment matching</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_a2_newton.html">DPprior_a2_newton</a></span><span class="op">(</span>J <span class="op">=</span> <span class="fl">50</span>, mu_K <span class="op">=</span> <span class="fl">5</span>, var_K <span class="op">=</span> <span class="fl">8</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; A2-MN Newton Solver</span></span>
<span><span class="co">#&gt; Target: E[K]=5.0000, Var(K)=8.0000</span></span>
<span><span class="co">#&gt; A1 initialization: a0=4.000000, b0=3.912023</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------------------- </span></span>
<span><span class="co">#&gt; Iter |          a |          b |       E[K] |     Var(K) |      ||F|| |     step |     det(J)</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------------------- </span></span>
<span><span class="co">#&gt;    1 |   4.000000 |   3.912023 |   4.461351 |   4.783136 |   3.26e+00 |   1.0000 |  -5.30e+00</span></span>
<span><span class="co">#&gt;    2 |   1.178650 |   0.911969 |   4.909046 |  10.854537 |   2.86e+00 |   1.0000 |  -2.16e+01</span></span>
<span><span class="co">#&gt;    3 |   1.844384 |   1.455254 |   4.974913 |   8.399473 |   4.00e-01 |   1.0000 |  -1.53e+01</span></span>
<span><span class="co">#&gt;    4 |   2.029223 |   1.599680 |   4.999187 |   8.013243 |   1.33e-02 |   1.0000 |  -1.43e+01</span></span>
<span><span class="co">#&gt;    5 |   2.036082 |   1.605046 |   4.999999 |   8.000021 |   2.08e-05 |   1.0000 |  -1.43e+01</span></span>
<span><span class="co">#&gt;    6 |   2.036093 |   1.605054 |   5.000000 |   8.000000 |   7.60e-09 |      --- |  -1.43e+01</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Converged: ||F|| = 7.60e-09 &lt; 1.00e-08</span></span>
<span></span>
<span><span class="co"># Verify exact matching</span></span>
<span><span class="va">achieved</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/exact_K_moments.html">exact_K_moments</a></span><span class="op">(</span><span class="fl">50</span>, <span class="va">fit</span><span class="op">$</span><span class="va">a</span>, <span class="va">fit</span><span class="op">$</span><span class="va">b</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nTarget vs Achieved:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Target vs Achieved:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  E[K]:   5.000000 vs"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%.10f"</span>, <span class="va">achieved</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   E[K]:   5.000000 vs 4.9999999992</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Var(K): 8.000000 vs"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%.10f"</span>, <span class="va">achieved</span><span class="op">$</span><span class="va">var</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Var(K): 8.000000 vs 8.0000000076</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="dpprior_a2_kl">3.3 <code>DPprior_a2_kl()</code><a class="anchor" aria-label="anchor" href="#dpprior_a2_kl"></a>
</h3>
<p><strong>A2-KL Distribution Matching via KL Divergence</strong></p>
<p>Minimizes Kullback-Leibler divergence between a target PMF and the
induced marginal PMF of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>J</mi></msub><annotation encoding="application/x-tex">K_J</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/DPprior_a2_kl.html">DPprior_a2_kl</a></span><span class="op">(</span></span>
<span>  <span class="va">J</span>,                      <span class="co"># Sample size</span></span>
<span>  <span class="va">target</span>,                 <span class="co"># Target PMF or list(mu_K, var_K)</span></span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pmf"</span>, <span class="st">"chisq"</span><span class="op">)</span>,  <span class="co"># Target type</span></span>
<span>  max_iter <span class="op">=</span> <span class="fl">100L</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">1e-6</span>,</span>
<span>  M <span class="op">=</span> <span class="fl">80L</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Target Specification:</strong></p>
<table class="table">
<colgroup>
<col width="25%">
<col width="41%">
<col width="33%">
</colgroup>
<thead><tr class="header">
<th><code>method</code></th>
<th>
<code>target</code> Input</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>"pmf"</code></td>
<td>Numeric vector of length
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>J</mi><annotation encoding="application/x-tex">J</annotation></semantics></math>
</td>
<td>Direct PMF on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><mi>J</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{1, \ldots, J\}</annotation></semantics></math>
</td>
</tr>
<tr class="even">
<td><code>"chisq"</code></td>
<td><code>list(mu_K = ..., var_K = ...)</code></td>
<td>Discretized chi-square matching moments</td>
</tr>
</tbody>
</table>
<p><strong>Examples:</strong></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Method 1: Moment-based target using chi-square discretization</span></span>
<span><span class="va">fit_kl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_a2_kl.html">DPprior_a2_kl</a></span><span class="op">(</span>J <span class="op">=</span> <span class="fl">50</span>, target <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mu_K <span class="op">=</span> <span class="fl">5</span>, var_K <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>, </span>
<span>                         method <span class="op">=</span> <span class="st">"chisq"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"A2-KL solution: Gamma("</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fit_kl</span><span class="op">$</span><span class="va">a</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">", "</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fit_kl</span><span class="op">$</span><span class="va">b</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">")\n"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="co">#&gt; A2-KL solution: Gamma(2.2363, 1.7627)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Final KL divergence:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">fit_kl</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">kl</span>, scientific <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Final KL divergence: 5.029612e-03</span></span>
<span></span>
<span><span class="co"># Method 2: Direct PMF target</span></span>
<span><span class="va">target_pmf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/discretize_chisq.html">discretize_chisq</a></span><span class="op">(</span>J <span class="op">=</span> <span class="fl">50</span>, df <span class="op">=</span> <span class="fl">6.25</span>, scale <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="va">fit_kl2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_a2_kl.html">DPprior_a2_kl</a></span><span class="op">(</span>J <span class="op">=</span> <span class="fl">50</span>, target <span class="op">=</span> <span class="va">target_pmf</span>, method <span class="op">=</span> <span class="st">"pmf"</span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="weight-distribution-functions">4. Weight Distribution Functions<a class="anchor" aria-label="anchor" href="#weight-distribution-functions"></a>
</h2>
<p>Functions for computing properties of the first stick-breaking weight
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math>
and the co-clustering probability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œÅ</mi><mo>=</mo><msub><mo>‚àë</mo><mi>h</mi></msub><msubsup><mi>w</mi><mi>h</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\rho = \sum_h w_h^2</annotation></semantics></math>.</p>
<div class="section level3">
<h3 id="first-weight-w_1-functions">4.1 First Weight
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math>
Functions<a class="anchor" aria-label="anchor" href="#first-weight-w_1-functions"></a>
</h3>
<p>The size-biased first weight
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math>
follows a compound distribution:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>1</mn></msub><mo stretchy="false" form="prefix">|</mo><mi>Œ±</mi><mo>‚àº</mo><mtext mathvariant="normal">Beta</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="1.0em"></mspace><mi>Œ±</mi><mo>‚àº</mo><mtext mathvariant="normal">Gamma</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
w_1 | \alpha \sim \text{Beta}(1, \alpha), \quad \alpha \sim \text{Gamma}(a, b)
</annotation></semantics></math></p>
<div class="section level4">
<h4 id="mean_w1">
<code>mean_w1()</code><a class="anchor" aria-label="anchor" href="#mean_w1"></a>
</h4>
<p><strong>Marginal Mean of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math></strong></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mean_w1.html">mean_w1</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, M <span class="op">=</span> <span class="fl">80L</span><span class="op">)</span></span></code></pre></div>
<p>Computes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>w</mi><mn>1</mn></msub><mo stretchy="false" form="prefix">|</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><mn>1</mn><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}[w_1 | a, b] = \mathbb{E}[1/(1+\alpha)]</annotation></semantics></math>
via quadrature.</p>
<p><strong>Examples:</strong></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mean_w1.html">mean_w1</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">1.6</span>, b <span class="op">=</span> <span class="fl">1.22</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.508368</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="var_w1">
<code>var_w1()</code><a class="anchor" aria-label="anchor" href="#var_w1"></a>
</h4>
<p><strong>Marginal Variance of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math></strong></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/var_w1.html">var_w1</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, M <span class="op">=</span> <span class="fl">80L</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="quantile_w1">
<code>quantile_w1()</code><a class="anchor" aria-label="anchor" href="#quantile_w1"></a>
</h4>
<p><strong>Marginal Quantiles of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math></strong></p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/quantile_w1.html">quantile_w1</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">a</span>, <span class="va">b</span>, n_grid <span class="op">=</span> <span class="fl">1000</span>, M <span class="op">=</span> <span class="fl">80L</span><span class="op">)</span></span></code></pre></div>
<p>Computes quantiles via numerical inversion of the CDF.</p>
<p><strong>Examples:</strong></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Median of w1</span></span>
<span><span class="va">median_w1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/quantile_w1.html">quantile_w1</a></span><span class="op">(</span><span class="fl">0.5</span>, a <span class="op">=</span> <span class="fl">1.6</span>, b <span class="op">=</span> <span class="fl">1.22</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Median(w1) ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">median_w1</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Median(w1) = 0.4839</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="prob_w1_exceeds">
<code>prob_w1_exceeds()</code><a class="anchor" aria-label="anchor" href="#prob_w1_exceeds"></a>
</h4>
<p><strong>Tail Probability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>&gt;</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(w_1 &gt; x)</annotation></semantics></math></strong></p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/prob_w1_exceeds.html">prob_w1_exceeds</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">a</span>, <span class="va">b</span>, M <span class="op">=</span> <span class="fl">80L</span><span class="op">)</span></span></code></pre></div>
<p><strong>Critical for Dominance Assessment:</strong>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>&gt;</mo><mn>0.5</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(w_1 &gt; 0.5)</annotation></semantics></math>
indicates the probability that a single cluster dominates.</p>
<p><strong>Examples:</strong></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Dominance probabilities</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">1.6</span>; <span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">1.22</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"P(w1 &gt; 0.5) ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="../reference/prob_w1_exceeds.html">prob_w1_exceeds</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="va">a</span>, <span class="va">b</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; P(w1 &gt; 0.5) = 0.4868</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"P(w1 &gt; 0.7) ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="../reference/prob_w1_exceeds.html">prob_w1_exceeds</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="va">a</span>, <span class="va">b</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; P(w1 &gt; 0.7) = 0.3334</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"P(w1 &gt; 0.9) ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="../reference/prob_w1_exceeds.html">prob_w1_exceeds</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="va">a</span>, <span class="va">b</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; P(w1 &gt; 0.9) = 0.1833</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="cdf_w1-and-pdf_w1">
<code>cdf_w1()</code> and <code>pdf_w1()</code><a class="anchor" aria-label="anchor" href="#cdf_w1-and-pdf_w1"></a>
</h4>
<p><strong>CDF and PDF of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math></strong></p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cdf_w1.html">cdf_w1</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">a</span>, <span class="va">b</span>, M <span class="op">=</span> <span class="fl">80L</span><span class="op">)</span></span>
<span><span class="fu">pdf_w1</span><span class="op">(</span><span class="va">x</span>, <span class="va">a</span>, <span class="va">b</span>, M <span class="op">=</span> <span class="fl">80L</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="co-clustering-probability-rho-functions">4.2 Co-Clustering Probability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÅ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
Functions<a class="anchor" aria-label="anchor" href="#co-clustering-probability-rho-functions"></a>
</h3>
<p>The co-clustering probability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œÅ</mi><mo>=</mo><msubsup><mo>‚àë</mo><mrow><mi>h</mi><mo>=</mo><mn>1</mn></mrow><mi>‚àû</mi></msubsup><msubsup><mi>w</mi><mi>h</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\rho = \sum_{h=1}^\infty w_h^2</annotation></semantics></math>
represents the probability that two randomly chosen observations belong
to the same cluster.</p>
<div class="section level4">
<h4 id="mean_rho-and-var_rho">
<code>mean_rho()</code> and <code>var_rho()</code><a class="anchor" aria-label="anchor" href="#mean_rho-and-var_rho"></a>
</h4>
<p><strong>Marginal Moments of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÅ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math></strong></p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mean_rho.html">mean_rho</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, M <span class="op">=</span> <span class="fl">80L</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/var_rho.html">var_rho</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, M <span class="op">=</span> <span class="fl">80L</span><span class="op">)</span></span></code></pre></div>
<p><strong>Key Identity:</strong>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>œÅ</mi><mo stretchy="false" form="prefix">|</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>w</mi><mn>1</mn></msub><mo stretchy="false" form="prefix">|</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mn>1</mn><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}[\rho | \alpha] = \mathbb{E}[w_1 | \alpha] = 1/(1+\alpha)</annotation></semantics></math>,
so
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>œÅ</mi><mo stretchy="false" form="prefix">|</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>w</mi><mn>1</mn></msub><mo stretchy="false" form="prefix">|</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}[\rho | a, b] = \mathbb{E}[w_1 | a, b]</annotation></semantics></math>.</p>
<p><strong>Examples:</strong></p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">1.6</span>; <span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">1.22</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"E[rho] ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="../reference/mean_rho.html">mean_rho</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; E[rho] = 0.5084</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"E[w1]  ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="../reference/mean_w1.html">mean_w1</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"(same as E[rho])\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; E[w1]  = 0.5084 (same as E[rho])</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Var(rho) ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="../reference/var_rho.html">var_rho</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Var(rho) = 0.071</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Var(w1)  ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="../reference/var_w1.html">var_w1</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"(different!)\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Var(w1)  = 0.1052 (different!)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="cv_rho">
<code>cv_rho()</code><a class="anchor" aria-label="anchor" href="#cv_rho"></a>
</h4>
<p><strong>Coefficient of Variation of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÅ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math></strong></p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cv_rho.html">cv_rho</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, M <span class="op">=</span> <span class="fl">80L</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="conditional-weight-functions">4.3 Conditional Weight Functions<a class="anchor" aria-label="anchor" href="#conditional-weight-functions"></a>
</h3>
<div class="section level4">
<h4 id="mean_rho_given_alpha-and-var_rho_given_alpha">
<code>mean_rho_given_alpha()</code> and
<code>var_rho_given_alpha()</code><a class="anchor" aria-label="anchor" href="#mean_rho_given_alpha-and-var_rho_given_alpha"></a>
</h4>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mean_rho_given_alpha.html">mean_rho_given_alpha</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">)</span>   <span class="co"># Returns 1/(1 + alpha)</span></span>
<span><span class="fu"><a href="../reference/var_rho_given_alpha.html">var_rho_given_alpha</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">)</span>    <span class="co"># Returns 2*alpha / ((1+alpha)^2 * (2+alpha) * (3+alpha))</span></span></code></pre></div>
<hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="diagnostic-functions">5. Diagnostic Functions<a class="anchor" aria-label="anchor" href="#diagnostic-functions"></a>
</h2>
<div class="section level3">
<h3 id="dpprior_diagnostics">5.1 <code>DPprior_diagnostics()</code><a class="anchor" aria-label="anchor" href="#dpprior_diagnostics"></a>
</h3>
<p><strong>Comprehensive Prior Diagnostics</strong></p>
<p>Computes a full diagnostic report implementing the ‚Äúunintended prior‚Äù
checks from Lee (2026, Section 4).</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/DPprior_diagnostics.html">DPprior_diagnostics</a></span><span class="op">(</span><span class="va">fit</span>, thresholds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.9</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>Parameters:</strong></p>
<table class="table">
<thead><tr class="header">
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>fit</code></td>
<td>DPprior_fit</td>
<td>Fitted object with <code>a</code>, <code>b</code>,
<code>J</code>.</td>
</tr>
<tr class="even">
<td><code>thresholds</code></td>
<td>Numeric</td>
<td>Thresholds for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>&gt;</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(w_1 &gt; x)</annotation></semantics></math>
checks.</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong> An S3 object of class
<code>DPprior_diagnostics</code> with:</p>
<table class="table">
<thead><tr class="header">
<th>Component</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>alpha</code></td>
<td>Summary of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ±</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
distribution (mean, CV, quantiles)</td>
</tr>
<tr class="even">
<td><code>K</code></td>
<td>Summary of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>J</mi></msub><annotation encoding="application/x-tex">K_J</annotation></semantics></math>
distribution (mean, SD, mode, median)</td>
</tr>
<tr class="odd">
<td><code>weights</code></td>
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math>
distribution and dominance risk assessment</td>
</tr>
<tr class="even">
<td><code>coclustering</code></td>
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÅ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
summary with interpretation</td>
</tr>
<tr class="odd">
<td><code>warnings</code></td>
<td>Character vector of diagnostic warnings</td>
</tr>
</tbody>
</table>
<p><strong>Warning Thresholds:</strong></p>
<ul>
<li>
<code>HIGH DOMINANCE RISK</code>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>&gt;</mo><mn>0.5</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>&gt;</mo><mn>40</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">P(w_1 &gt; 0.5) &gt; 40\%</annotation></semantics></math>
</li>
<li>
<code>NEAR-DEGENERATE RISK</code>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>&gt;</mo><mn>0.9</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>&gt;</mo><mn>15</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">P(w_1 &gt; 0.9) &gt; 15\%</annotation></semantics></math>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_fit.html">DPprior_fit</a></span><span class="op">(</span>J <span class="op">=</span> <span class="fl">50</span>, mu_K <span class="op">=</span> <span class="fl">5</span>, var_K <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: HIGH DOMINANCE RISK: P(w1 &gt; 0.5) = 48.1% exceeds 40%.</span></span>
<span><span class="co">#&gt;   This may indicate unintended prior behavior (Lee, 2026).</span></span>
<span><span class="co">#&gt;   Consider using DPprior_dual() for weight-constrained elicitation.</span></span>
<span><span class="co">#&gt;   See ?DPprior_diagnostics for interpretation.</span></span>
<span><span class="va">diag</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_diagnostics.html">DPprior_diagnostics</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">diag</span><span class="op">)</span></span>
<span><span class="co">#&gt; DPprior Comprehensive Diagnostics</span></span>
<span><span class="co">#&gt; ============================================================ </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Prior: alpha ~ Gamma(2.0361, 1.6051) for J = 50</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; alpha Distribution:</span></span>
<span><span class="co">#&gt; ---------------------------------------- </span></span>
<span><span class="co">#&gt;   E[alpha] = 1.269, CV(alpha) = 0.701, Median = 1.068</span></span>
<span><span class="co">#&gt;   90% CI: [0.230, 2.992]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; K_J Distribution:</span></span>
<span><span class="co">#&gt; ---------------------------------------- </span></span>
<span><span class="co">#&gt;   E[K] = 5.00, SD(K) = 2.83, Mode = 3</span></span>
<span><span class="co">#&gt;   Median = 5, IQR = [3, 7]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; w1 Distribution (Size-Biased First Weight):</span></span>
<span><span class="co">#&gt; ---------------------------------------- </span></span>
<span><span class="co">#&gt;   E[w1] = 0.501, Median = 0.478</span></span>
<span><span class="co">#&gt;   P(w1 &gt; 0.5) = 48.1% (dominance risk: HIGH)</span></span>
<span><span class="co">#&gt;   P(w1 &gt; 0.9) = 16.3%</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Co-Clustering (rho = sum w_h^2):</span></span>
<span><span class="co">#&gt; ---------------------------------------- </span></span>
<span><span class="co">#&gt;   E[rho] = 0.501 (High prior co-clustering: most unit pairs expected in same cluster)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; WARNINGS:</span></span>
<span><span class="co">#&gt; ---------------------------------------- </span></span>
<span><span class="co">#&gt;   * HIGH DOMINANCE RISK: P(w1 &gt; 0.5) = 48.1% exceeds 40%</span></span>
<span><span class="co">#&gt;   * NEAR-DEGENERATE RISK: P(w1 &gt; 0.9) = 16.3% exceeds 15%</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Consider using DPprior_dual() for weight-constrained elicitation.</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="s3-methods-for-dpprior_fit">5.2 S3 Methods for <code>DPprior_fit</code><a class="anchor" aria-label="anchor" href="#s3-methods-for-dpprior_fit"></a>
</h3>
<div class="section level4">
<h4 id="print-dpprior_fit">
<code>print.DPprior_fit()</code><a class="anchor" aria-label="anchor" href="#print-dpprior_fit"></a>
</h4>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<p>Displays a concise summary of the elicitation result.</p>
</div>
<div class="section level4">
<h4 id="summary-dpprior_fit">
<code>summary.DPprior_fit()</code><a class="anchor" aria-label="anchor" href="#summary-dpprior_fit"></a>
</h4>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span>, print_output <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><strong>Returns:</strong> An object of class
<code>summary.DPprior_fit</code> with detailed statistics.</p>
</div>
<div class="section level4">
<h4 id="plot-dpprior_fit">
<code>plot.DPprior_fit()</code><a class="anchor" aria-label="anchor" href="#plot-dpprior_fit"></a>
</h4>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>, which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"alpha"</span>, <span class="st">"K"</span>, <span class="st">"w1"</span>, <span class="st">"table"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Creates a four-panel visualization dashboard:</p>
<ul>
<li>Panel A: Gamma prior density for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ±</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
</li>
<li>Panel B: Marginal PMF of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>J</mi></msub><annotation encoding="application/x-tex">K_J</annotation></semantics></math>
</li>
<li>Panel C: PDF of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math>
with dominance risk</li>
<li>Panel D: Summary statistics table</li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="individual-plot-functions">5.3 Individual Plot Functions<a class="anchor" aria-label="anchor" href="#individual-plot-functions"></a>
</h3>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_alpha_prior.html">plot_alpha_prior</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>   <span class="co"># Alpha distribution only</span></span>
<span><span class="fu"><a href="../reference/plot_K_prior.html">plot_K_prior</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>       <span class="co"># K distribution only</span></span>
<span><span class="fu"><a href="../reference/plot_w1_prior.html">plot_w1_prior</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>      <span class="co"># w1 distribution with dominance</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="dominance-risk-functions">5.4 Dominance Risk Functions<a class="anchor" aria-label="anchor" href="#dominance-risk-functions"></a>
</h3>
<div class="section level4">
<h4 id="check_dominance_risk">
<code>check_dominance_risk()</code><a class="anchor" aria-label="anchor" href="#check_dominance_risk"></a>
</h4>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/check_dominance_risk.html">check_dominance_risk</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, threshold <span class="op">=</span> <span class="fl">0.5</span>, risk_level <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span></code></pre></div>
<p>Returns <code>TRUE</code> if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>&gt;</mo><mtext mathvariant="normal">threshold</mtext><mo stretchy="true" form="postfix">)</mo></mrow><mo>&gt;</mo><mtext mathvariant="normal">risk_level</mtext></mrow><annotation encoding="application/x-tex">P(w_1 &gt; \text{threshold}) &gt; \text{risk\_level}</annotation></semantics></math>.</p>
</div>
<div class="section level4">
<h4 id="compute_alpha_diagnostics">
<code>compute_alpha_diagnostics()</code><a class="anchor" aria-label="anchor" href="#compute_alpha_diagnostics"></a>
</h4>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/compute_alpha_diagnostics.html">compute_alpha_diagnostics</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span><span class="op">)</span></span></code></pre></div>
<p>Returns mean, SD, CV, and quantiles of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ±</mi><mo>‚àº</mo><mtext mathvariant="normal">Gamma</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\alpha \sim \text{Gamma}(a, b)</annotation></semantics></math>.</p>
</div>
<div class="section level4">
<h4 id="compute_k_diagnostics">
<code>compute_K_diagnostics()</code><a class="anchor" aria-label="anchor" href="#compute_k_diagnostics"></a>
</h4>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/compute_K_diagnostics.html">compute_K_diagnostics</a></span><span class="op">(</span><span class="va">J</span>, <span class="va">a</span>, <span class="va">b</span>, M <span class="op">=</span> <span class="fl">80L</span><span class="op">)</span></span></code></pre></div>
<p>Returns mean, SD, mode, median, and quantiles of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>J</mi></msub><annotation encoding="application/x-tex">K_J</annotation></semantics></math>.</p>
</div>
<div class="section level4">
<h4 id="compute_weight_diagnostics">
<code>compute_weight_diagnostics()</code><a class="anchor" aria-label="anchor" href="#compute_weight_diagnostics"></a>
</h4>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/compute_weight_diagnostics.html">compute_weight_diagnostics</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, thresholds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.9</span><span class="op">)</span>, M <span class="op">=</span> <span class="fl">80L</span><span class="op">)</span></span></code></pre></div>
<p>Returns
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math>
summary with dominance risk classification.</p>
<hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="utility-functions">6. Utility Functions<a class="anchor" aria-label="anchor" href="#utility-functions"></a>
</h2>
<div class="section level3">
<h3 id="variance-conversion-functions">6.1 Variance Conversion Functions<a class="anchor" aria-label="anchor" href="#variance-conversion-functions"></a>
</h3>
<div class="section level4">
<h4 id="vif_to_variance">
<code>vif_to_variance()</code><a class="anchor" aria-label="anchor" href="#vif_to_variance"></a>
</h4>
<p><strong>Convert Variance Inflation Factor to Variance</strong></p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/vif_to_variance.html">vif_to_variance</a></span><span class="op">(</span><span class="va">mu_K</span>, <span class="va">vif</span><span class="op">)</span></span></code></pre></div>
<p>Computes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>œÉ</mi><mi>K</mi><mn>2</mn></msubsup><mo>=</mo><mtext mathvariant="normal">VIF</mtext><mo>√ó</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Œº</mi><mi>K</mi></msub><mo>‚àí</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\sigma^2_K = \text{VIF} \times (\mu_K - 1)</annotation></semantics></math>,
based on the marginal overdispersion relationship.</p>
<p><strong>Examples:</strong></p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># VIF = 2 means variance is twice the Poisson-like baseline</span></span>
<span><span class="va">var_K</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vif_to_variance.html">vif_to_variance</a></span><span class="op">(</span>mu_K <span class="op">=</span> <span class="fl">5</span>, vif <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"var_K ="</span>, <span class="va">var_K</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; var_K = 8</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="confidence_to_vif">
<code>confidence_to_vif()</code><a class="anchor" aria-label="anchor" href="#confidence_to_vif"></a>
</h4>
<p><strong>Map Confidence Level to VIF</strong></p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/confidence_to_vif.html">confidence_to_vif</a></span><span class="op">(</span><span class="va">confidence</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th>Confidence</th>
<th>VIF</th>
<th>Interpretation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>"low"</code></td>
<td>4.0</td>
<td>High uncertainty</td>
</tr>
<tr class="even">
<td><code>"medium"</code></td>
<td>2.5</td>
<td>Moderate uncertainty</td>
</tr>
<tr class="odd">
<td><code>"high"</code></td>
<td>1.5</td>
<td>Low uncertainty</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="cv_alpha_to_variance">
<code>cv_alpha_to_variance()</code><a class="anchor" aria-label="anchor" href="#cv_alpha_to_variance"></a>
</h4>
<p><strong>Convert CV of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ±</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
to Variance of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math></strong></p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cv_alpha_to_variance.html">cv_alpha_to_variance</a></span><span class="op">(</span><span class="va">mu_K</span>, <span class="va">cv_alpha</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="scaling-functions">6.2 Scaling Functions<a class="anchor" aria-label="anchor" href="#scaling-functions"></a>
</h3>
<div class="section level4">
<h4 id="compute_scaling_constant">
<code>compute_scaling_constant()</code><a class="anchor" aria-label="anchor" href="#compute_scaling_constant"></a>
</h4>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/compute_scaling_constant.html">compute_scaling_constant</a></span><span class="op">(</span><span class="va">J</span>, scaling <span class="op">=</span> <span class="st">"log"</span>, mu_K <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<p>Computes the scaling constant
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>c</mi><mi>J</mi></msub><annotation encoding="application/x-tex">c_J</annotation></semantics></math>
used in the A1 approximation:</p>
<table class="table">
<thead><tr class="header">
<th><code>scaling</code></th>
<th>Formula</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>"log"</code></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mi>J</mi></mrow><annotation encoding="application/x-tex">\log J</annotation></semantics></math></td>
</tr>
<tr class="even">
<td><code>"harmonic"</code></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>‚àë</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>J</mi></msubsup><mn>1</mn><mi>/</mi><mi>i</mi></mrow><annotation encoding="application/x-tex">\sum_{i=1}^{J} 1/i</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td><code>"digamma"</code></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œà</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>J</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>Œ≥</mi></mrow><annotation encoding="application/x-tex">\psi(J+1) + \gamma</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level3">
<h3 id="quadrature-functions">6.3 Quadrature Functions<a class="anchor" aria-label="anchor" href="#quadrature-functions"></a>
</h3>
<div class="section level4">
<h4 id="gauss_laguerre_nodes">
<code>gauss_laguerre_nodes()</code><a class="anchor" aria-label="anchor" href="#gauss_laguerre_nodes"></a>
</h4>
<p><strong>Compute Gauss-Laguerre Quadrature Nodes and
Weights</strong></p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gauss_laguerre_nodes.html">gauss_laguerre_nodes</a></span><span class="op">(</span><span class="va">M</span>, alpha_param <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><strong>Parameters:</strong></p>
<table class="table">
<colgroup>
<col width="36%">
<col width="20%">
<col width="43%">
</colgroup>
<thead><tr class="header">
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>M</code></td>
<td>Integer</td>
<td>Number of quadrature nodes.</td>
</tr>
<tr class="even">
<td><code>alpha_param</code></td>
<td>Numeric</td>
<td>Generalized Laguerre parameter (for Gamma(a,b), use
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>‚àí</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">a-1</annotation></semantics></math>).</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong> List with <code>nodes</code>,
<code>weights</code>, and <code>weights_log</code>.</p>
</div>
<div class="section level4">
<h4 id="build_gamma_quadrature">
<code>build_gamma_quadrature()</code><a class="anchor" aria-label="anchor" href="#build_gamma_quadrature"></a>
</h4>
<p><strong>Build Quadrature for Gamma Distribution</strong></p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/build_gamma_quadrature.html">build_gamma_quadrature</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, M <span class="op">=</span> <span class="fl">80L</span><span class="op">)</span></span></code></pre></div>
<p>Transforms standard Laguerre quadrature to integrate against
Gamma(a,b).</p>
<p><strong>Returns:</strong> List with <code>alpha_nodes</code> and
<code>weights_normalized</code>.</p>
</div>
<div class="section level4">
<h4 id="integrate_gamma">
<code>integrate_gamma()</code><a class="anchor" aria-label="anchor" href="#integrate_gamma"></a>
</h4>
<p><strong>Compute Expectation under Gamma Distribution</strong></p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/integrate_gamma.html">integrate_gamma</a></span><span class="op">(</span><span class="va">f</span>, <span class="va">a</span>, <span class="va">b</span>, M <span class="op">=</span> <span class="fl">80L</span><span class="op">)</span></span></code></pre></div>
<p>Computes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ùîº</mi><mrow><mi>Œ±</mi><mo>‚àº</mo><mtext mathvariant="normal">Gamma</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub><mrow><mo stretchy="true" form="prefix">[</mo><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}_{\alpha \sim \text{Gamma}(a,b)}[f(\alpha)]</annotation></semantics></math>
using Gauss-Laguerre quadrature.</p>
<p><strong>Examples:</strong></p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># E[alpha] = a/b</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">2</span>; <span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">E_alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/integrate_gamma.html">integrate_gamma</a></span><span class="op">(</span><span class="va">identity</span>, <span class="va">a</span>, <span class="va">b</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"E[alpha] via quadrature:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">E_alpha</span>, <span class="fl">6</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; E[alpha] via quadrature: 4</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"E[alpha] exact (a/b):"</span>, <span class="va">a</span><span class="op">/</span><span class="va">b</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; E[alpha] exact (a/b): 4</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="log-space-numerical-functions">6.4 Log-Space Numerical Functions<a class="anchor" aria-label="anchor" href="#log-space-numerical-functions"></a>
</h3>
<div class="section level4">
<h4 id="logsumexp">
<code>logsumexp()</code><a class="anchor" aria-label="anchor" href="#logsumexp"></a>
</h4>
<p><strong>Binary Log-Sum-Exp</strong></p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/logsumexp.html">logsumexp</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span><span class="op">)</span></span></code></pre></div>
<p>Computes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\log(\exp(a) + \exp(b))</annotation></semantics></math>
stably.</p>
</div>
<div class="section level4">
<h4 id="logsumexp_vec">
<code>logsumexp_vec()</code><a class="anchor" aria-label="anchor" href="#logsumexp_vec"></a>
</h4>
<p><strong>Vectorized Log-Sum-Exp</strong></p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/logsumexp_vec.html">logsumexp_vec</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<p>Computes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mo>‚àë</mo><mi>i</mi></msub><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\log(\sum_i \exp(x_i))</annotation></semantics></math>
for a vector.</p>
</div>
<div class="section level4">
<h4 id="softmax">
<code>softmax()</code><a class="anchor" aria-label="anchor" href="#softmax"></a>
</h4>
<p><strong>Numerically Stable Softmax</strong></p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/softmax.html">softmax</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<p>Returns probability vector from log-odds.</p>
</div>
</div>
<div class="section level3">
<h3 id="rising-factorial">6.5 Rising Factorial<a class="anchor" aria-label="anchor" href="#rising-factorial"></a>
</h3>
<div class="section level4">
<h4 id="log_rising_factorial">
<code>log_rising_factorial()</code><a class="anchor" aria-label="anchor" href="#log_rising_factorial"></a>
</h4>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/log_rising_factorial.html">log_rising_factorial</a></span><span class="op">(</span><span class="va">alpha</span>, <span class="va">J</span><span class="op">)</span></span></code></pre></div>
<p>Computes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>J</mi></msub><mo>=</mo><mo>log</mo><mi>Œì</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo>+</mo><mi>J</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><mo>log</mo><mi>Œì</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\log(\alpha)_J = \log\Gamma(\alpha + J) - \log\Gamma(\alpha)</annotation></semantics></math>.</p>
</div>
</div>
<div class="section level3">
<h3 id="kl-divergence-functions">6.6 KL Divergence Functions<a class="anchor" aria-label="anchor" href="#kl-divergence-functions"></a>
</h3>
<div class="section level4">
<h4 id="kl_divergence_pmf">
<code>kl_divergence_pmf()</code><a class="anchor" aria-label="anchor" href="#kl_divergence_pmf"></a>
</h4>
<p><strong>KL Divergence Between PMFs</strong></p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/kl_divergence_pmf.html">kl_divergence_pmf</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">q</span>, eps <span class="op">=</span> <span class="fl">1e-15</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="kl_divergence_k">
<code>kl_divergence_K()</code><a class="anchor" aria-label="anchor" href="#kl_divergence_k"></a>
</h4>
<p><strong>KL Divergence for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>J</mi></msub><annotation encoding="application/x-tex">K_J</annotation></semantics></math>
Distributions</strong></p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/kl_divergence_K.html">kl_divergence_K</a></span><span class="op">(</span><span class="va">target_pmf</span>, <span class="va">a</span>, <span class="va">b</span>, <span class="va">J</span>, M <span class="op">=</span> <span class="fl">80L</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="discretize_chisq">
<code>discretize_chisq()</code><a class="anchor" aria-label="anchor" href="#discretize_chisq"></a>
</h4>
<p><strong>Create Target PMF from Chi-Square</strong></p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/discretize_chisq.html">discretize_chisq</a></span><span class="op">(</span><span class="va">J</span>, <span class="va">df</span>, scale <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>Discretizes a (scaled) chi-square distribution onto
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><mi>J</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{1, \ldots, J\}</annotation></semantics></math>.</p>
<hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="verification-functions">7. Verification Functions<a class="anchor" aria-label="anchor" href="#verification-functions"></a>
</h2>
<p>The package includes extensive verification functions for development
and testing. These are typically not needed by end users but are
available for those who wish to validate computations.</p>
<div class="section level3">
<h3 id="module-verification-functions">7.1 Module Verification Functions<a class="anchor" aria-label="anchor" href="#module-verification-functions"></a>
</h3>
<table class="table">
<colgroup>
<col width="43%">
<col width="56%">
</colgroup>
<thead><tr class="header">
<th>Function</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>validate_stirling(logS)</code></td>
<td>Verify Stirling numbers against known values</td>
</tr>
<tr class="even">
<td><code>verify_stirling_row_sum(logS)</code></td>
<td>Verify
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>‚àë</mo><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">|</mo><mi>s</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>J</mi><mo>,</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">|</mo></mrow><mo>=</mo><mi>J</mi><mi>!</mi></mrow><annotation encoding="application/x-tex">\sum_k |s(J,k)| = J!</annotation></semantics></math>
</td>
</tr>
<tr class="odd">
<td><code>verify_underdispersion(J, alpha_values)</code></td>
<td>Verify
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mo>&lt;</mo><mtext mathvariant="normal">Mean</mtext></mrow><annotation encoding="application/x-tex">\text{Var} &lt; \text{Mean}</annotation></semantics></math>
</td>
</tr>
<tr class="even">
<td><code>verify_pmf_moments(J, alpha, logS)</code></td>
<td>Verify PMF matches closed-form moments</td>
</tr>
<tr class="odd">
<td><code>verify_marginal_moments(J, a, b)</code></td>
<td>Verify marginal moment properties</td>
</tr>
<tr class="even">
<td><code>verify_a1_roundtrip(fit)</code></td>
<td>Verify A1 parameters recover targets</td>
</tr>
<tr class="odd">
<td><code>verify_a2_moment_matching(J, mu_K, var_K)</code></td>
<td>Verify A2 achieves exact matching</td>
</tr>
</tbody>
</table>
<p><strong>Examples:</strong></p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Verify Stirling numbers</span></span>
<span><span class="va">logS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_log_stirling.html">compute_log_stirling</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/validate_stirling.html">validate_stirling</a></span><span class="op">(</span><span class="va">logS</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; PASS: |s(4,2)| = 11 (expected 11)</span></span>
<span><span class="co">#&gt; PASS: |s(5,3)| = 35 (expected 35)</span></span>
<span><span class="co">#&gt; PASS: |s(6,3)| = 225 (expected 225)</span></span>
<span><span class="co">#&gt; PASS: |s(10,5)| = 269325 (expected 269325)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="co"># Verify underdispersion</span></span>
<span><span class="fu"><a href="../reference/verify_underdispersion.html">verify_underdispersion</a></span><span class="op">(</span><span class="fl">50</span>, alpha_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Underdispersion verification (J=50):</span></span>
<span><span class="co">#&gt;   alpha= 0.50: E[K]=  2.9378, Var(K)=  1.7091, D=0.5818 [PASS]</span></span>
<span><span class="co">#&gt;   alpha= 1.00: E[K]=  4.4992, Var(K)=  2.8741, D=0.6388 [PASS]</span></span>
<span><span class="co">#&gt;   alpha= 2.00: E[K]=  7.0376, Var(K)=  4.5356, D=0.6445 [PASS]</span></span>
<span><span class="co">#&gt;   alpha= 5.00: E[K]= 12.4605, Var(K)=  7.3861, D=0.5928 [PASS]</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="function-quick-reference">8. Function Quick Reference<a class="anchor" aria-label="anchor" href="#function-quick-reference"></a>
</h2>
<div class="section level3">
<h3 id="by-task">By Task<a class="anchor" aria-label="anchor" href="#by-task"></a>
</h3>
<p><strong>‚ÄúI want to elicit a prior based on expected
clusters‚Äù</strong></p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_fit.html">DPprior_fit</a></span><span class="op">(</span>J <span class="op">=</span> <span class="fl">50</span>, mu_K <span class="op">=</span> <span class="fl">5</span>, confidence <span class="op">=</span> <span class="st">"medium"</span><span class="op">)</span></span></code></pre></div>
<p><strong>‚ÄúI want to control both clusters AND weight
concentration‚Äù</strong></p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_K</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_fit.html">DPprior_fit</a></span><span class="op">(</span>J <span class="op">=</span> <span class="fl">50</span>, mu_K <span class="op">=</span> <span class="fl">5</span>, var_K <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_dual.html">DPprior_dual</a></span><span class="op">(</span><span class="va">fit_K</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>threshold <span class="op">=</span> <span class="fl">0.5</span>, value <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>‚ÄúI want to check for dominance risk‚Äù</strong></p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/prob_w1_exceeds.html">prob_w1_exceeds</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="va">fit</span><span class="op">$</span><span class="va">a</span>, <span class="va">fit</span><span class="op">$</span><span class="va">b</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/DPprior_diagnostics.html">DPprior_diagnostics</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<p><strong>‚ÄúI want to compute the exact PMF of K‚Äù</strong></p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">logS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_log_stirling.html">compute_log_stirling</a></span><span class="op">(</span><span class="va">J</span><span class="op">)</span></span>
<span><span class="va">pmf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pmf_K_marginal.html">pmf_K_marginal</a></span><span class="op">(</span><span class="va">J</span>, <span class="va">fit</span><span class="op">$</span><span class="va">a</span>, <span class="va">fit</span><span class="op">$</span><span class="va">b</span>, <span class="va">logS</span><span class="op">)</span></span></code></pre></div>
<p><strong>‚ÄúI want to visualize my prior‚Äù</strong></p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>  <span class="co"># Full dashboard</span></span>
<span><span class="fu"><a href="../reference/plot_K_prior.html">plot_K_prior</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>  <span class="co"># K distribution only</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="alphabetical-index">Alphabetical Index<a class="anchor" aria-label="anchor" href="#alphabetical-index"></a>
</h3>
<table class="table">
<colgroup>
<col width="30%">
<col width="30%">
<col width="39%">
</colgroup>
<thead><tr class="header">
<th>Function</th>
<th>Category</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code><a href="../reference/build_gamma_quadrature.html">build_gamma_quadrature()</a></code></td>
<td>Utility</td>
<td>Quadrature for Gamma</td>
</tr>
<tr class="even">
<td><code><a href="../reference/cdf_K_given_alpha.html">cdf_K_given_alpha()</a></code></td>
<td>Exact</td>
<td>Conditional CDF</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/cdf_w1.html">cdf_w1()</a></code></td>
<td>Weights</td>
<td>CDF of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math>
</td>
</tr>
<tr class="even">
<td><code><a href="../reference/check_dominance_risk.html">check_dominance_risk()</a></code></td>
<td>Diagnostics</td>
<td>Risk assessment</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/compute_log_stirling.html">compute_log_stirling()</a></code></td>
<td>Exact</td>
<td>Stirling numbers</td>
</tr>
<tr class="even">
<td><code><a href="../reference/compute_scaling_constant.html">compute_scaling_constant()</a></code></td>
<td>Utility</td>
<td>Scaling
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>c</mi><mi>J</mi></msub><annotation encoding="application/x-tex">c_J</annotation></semantics></math>
</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/confidence_to_vif.html">confidence_to_vif()</a></code></td>
<td>Utility</td>
<td>Confidence to VIF</td>
</tr>
<tr class="even">
<td><code><a href="../reference/cv_alpha_to_variance.html">cv_alpha_to_variance()</a></code></td>
<td>Utility</td>
<td>CV to variance</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/cv_rho.html">cv_rho()</a></code></td>
<td>Weights</td>
<td>CV of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÅ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
</td>
</tr>
<tr class="even">
<td><code><a href="../reference/discretize_chisq.html">discretize_chisq()</a></code></td>
<td>Utility</td>
<td>Chi-square to PMF</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/DPprior_a1.html">DPprior_a1()</a></code></td>
<td>Approximation</td>
<td>A1 closed-form</td>
</tr>
<tr class="even">
<td><code><a href="../reference/DPprior_a2_kl.html">DPprior_a2_kl()</a></code></td>
<td>Approximation</td>
<td>A2-KL solver</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/DPprior_a2_newton.html">DPprior_a2_newton()</a></code></td>
<td>Approximation</td>
<td>A2-MN Newton</td>
</tr>
<tr class="even">
<td><code><a href="../reference/DPprior_diagnostics.html">DPprior_diagnostics()</a></code></td>
<td>Diagnostics</td>
<td>Full diagnostics</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/DPprior_dual.html">DPprior_dual()</a></code></td>
<td>Core</td>
<td>Dual-anchor elicitation</td>
</tr>
<tr class="even">
<td><code><a href="../reference/DPprior_fit.html">DPprior_fit()</a></code></td>
<td>Core</td>
<td>Main entry point</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/exact_K_moments.html">exact_K_moments()</a></code></td>
<td>Exact</td>
<td>Marginal moments</td>
</tr>
<tr class="even">
<td><code><a href="../reference/gauss_laguerre_nodes.html">gauss_laguerre_nodes()</a></code></td>
<td>Utility</td>
<td>Quadrature nodes</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/get_log_stirling.html">get_log_stirling()</a></code></td>
<td>Exact</td>
<td>Safe Stirling access</td>
</tr>
<tr class="even">
<td><code><a href="../reference/get_stirling_row.html">get_stirling_row()</a></code></td>
<td>Exact</td>
<td>Row of Stirling</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/integrate_gamma.html">integrate_gamma()</a></code></td>
<td>Utility</td>
<td>Expectation under Gamma</td>
</tr>
<tr class="even">
<td><code><a href="../reference/kl_divergence_K.html">kl_divergence_K()</a></code></td>
<td>Utility</td>
<td>KL for K</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/kl_divergence_pmf.html">kl_divergence_pmf()</a></code></td>
<td>Utility</td>
<td>KL between PMFs</td>
</tr>
<tr class="even">
<td><code><a href="../reference/log_rising_factorial.html">log_rising_factorial()</a></code></td>
<td>Utility</td>
<td>Log Pochhammer</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/logsumexp.html">logsumexp()</a></code></td>
<td>Utility</td>
<td>Binary log-sum-exp</td>
</tr>
<tr class="even">
<td><code><a href="../reference/logsumexp_vec.html">logsumexp_vec()</a></code></td>
<td>Utility</td>
<td>Vector log-sum-exp</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/mean_K_given_alpha.html">mean_K_given_alpha()</a></code></td>
<td>Exact</td>
<td>Conditional mean</td>
</tr>
<tr class="even">
<td><code><a href="../reference/mean_rho.html">mean_rho()</a></code></td>
<td>Weights</td>
<td>Marginal
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>œÅ</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}[\rho]</annotation></semantics></math>
</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/mean_rho_given_alpha.html">mean_rho_given_alpha()</a></code></td>
<td>Weights</td>
<td>Conditional
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>œÅ</mi><mo stretchy="false" form="prefix">|</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}[\rho|\alpha]</annotation></semantics></math>
</td>
</tr>
<tr class="even">
<td><code><a href="../reference/mean_w1.html">mean_w1()</a></code></td>
<td>Weights</td>
<td>Marginal
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>w</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}[w_1]</annotation></semantics></math>
</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/moments_K_given_alpha.html">moments_K_given_alpha()</a></code></td>
<td>Exact</td>
<td>Both conditional moments</td>
</tr>
<tr class="even">
<td><code>pdf_w1()</code></td>
<td>Weights</td>
<td>PDF of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math>
</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/plot.DPprior_fit.html">plot.DPprior_fit()</a></code></td>
<td>Diagnostics</td>
<td>Dashboard plot</td>
</tr>
<tr class="even">
<td><code><a href="../reference/plot_alpha_prior.html">plot_alpha_prior()</a></code></td>
<td>Diagnostics</td>
<td>Alpha plot</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/plot_K_prior.html">plot_K_prior()</a></code></td>
<td>Diagnostics</td>
<td>K plot</td>
</tr>
<tr class="even">
<td><code><a href="../reference/plot_w1_prior.html">plot_w1_prior()</a></code></td>
<td>Diagnostics</td>
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math>
plot</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/pmf_K_given_alpha.html">pmf_K_given_alpha()</a></code></td>
<td>Exact</td>
<td>Conditional PMF</td>
</tr>
<tr class="even">
<td><code><a href="../reference/pmf_K_marginal.html">pmf_K_marginal()</a></code></td>
<td>Exact</td>
<td>Marginal PMF</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/print.DPprior_fit.html">print.DPprior_fit()</a></code></td>
<td>Diagnostics</td>
<td>Print method</td>
</tr>
<tr class="even">
<td><code><a href="../reference/prob_w1_exceeds.html">prob_w1_exceeds()</a></code></td>
<td>Weights</td>
<td>Tail probability</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/quantile_K_given_alpha.html">quantile_K_given_alpha()</a></code></td>
<td>Exact</td>
<td>Conditional quantile</td>
</tr>
<tr class="even">
<td><code><a href="../reference/quantile_w1.html">quantile_w1()</a></code></td>
<td>Weights</td>
<td>Quantiles of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math>
</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/softmax.html">softmax()</a></code></td>
<td>Utility</td>
<td>Stable softmax</td>
</tr>
<tr class="even">
<td><code><a href="../reference/summary.DPprior_fit.html">summary.DPprior_fit()</a></code></td>
<td>Diagnostics</td>
<td>Summary method</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/summary_K_marginal.html">summary_K_marginal()</a></code></td>
<td>Exact</td>
<td>Full K summary</td>
</tr>
<tr class="even">
<td><code><a href="../reference/var_K_given_alpha.html">var_K_given_alpha()</a></code></td>
<td>Exact</td>
<td>Conditional variance</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/var_rho.html">var_rho()</a></code></td>
<td>Weights</td>
<td>Marginal
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>œÅ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Var}(\rho)</annotation></semantics></math>
</td>
</tr>
<tr class="even">
<td><code><a href="../reference/var_rho_given_alpha.html">var_rho_given_alpha()</a></code></td>
<td>Weights</td>
<td>Conditional
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>œÅ</mi><mo stretchy="false" form="prefix">|</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Var}(\rho|\alpha)</annotation></semantics></math>
</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/var_w1.html">var_w1()</a></code></td>
<td>Weights</td>
<td>Marginal
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Var}(w_1)</annotation></semantics></math>
</td>
</tr>
<tr class="even">
<td><code><a href="../reference/vif_to_variance.html">vif_to_variance()</a></code></td>
<td>Utility</td>
<td>VIF to variance</td>
</tr>
</tbody>
</table>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Antoniak, C. E. (1974). Mixtures of Dirichlet processes with
applications to Bayesian nonparametric problems. <em>The Annals of
Statistics</em>, 2(6), 1152-1174.</p>
<p>Golub, G. H., &amp; Welsch, J. H. (1969). Calculation of Gauss
quadrature rules. <em>Mathematics of Computation</em>, 23(106),
221-230.</p>
<p>Lee, J. (2026). Design-conditional prior elicitation for Dirichlet
process mixtures. <em>arXiv preprint</em> arXiv:2602.06301.</p>
<p>Lee, J., Che, J., Rabe-Hesketh, S., Feller, A., &amp; Miratrix, L.
(2025). Improving the estimation of site-specific effects and their
distribution in multisite trials. <em>Journal of Educational and
Behavioral Statistics</em>, 50(5), 731-764.</p>
<hr>
<p><em>For additional documentation, see the <a href="index.html">package vignettes</a> or visit the <a href="https://github.com/joonho112/DPprior" class="external-link">GitHub
repository</a>.</em></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/joonho112" class="external-link">JoonHo Lee</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
