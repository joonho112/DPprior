<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Case Studies: Multisite Trials and Meta-Analysis • DPprior</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Case Studies: Multisite Trials and Meta-Analysis">
<meta name="description" content="Real-world applications of DPprior in educational multisite trials,  medical meta-analysis, and large-scale policy evaluation.
">
<meta property="og:description" content="Real-world applications of DPprior in educational multisite trials,  medical meta-analysis, and large-scale policy evaluation.
">
<meta property="og:image" content="https://joonho112.github.io/DPprior/logo.svg">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DPprior</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><h6 class="dropdown-header" data-toc-skip>--- Applied Track ---</h6></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/quick-start.html">Quick Start</a></li>
    <li><a class="dropdown-item" href="../articles/applied-guide.html">Applied Guide</a></li>
    <li><a class="dropdown-item" href="../articles/dual-anchor.html">Dual-Anchor Framework</a></li>
    <li><a class="dropdown-item" href="../articles/diagnostics.html">Diagnostics</a></li>
    <li><a class="dropdown-item" href="../articles/case-studies.html">Case Studies</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>--- Methodological Track ---</h6></li>
    <li><a class="dropdown-item" href="../articles/theory-overview.html">Theory Overview</a></li>
    <li><a class="dropdown-item" href="../articles/theory-stirling.html">Stirling Numbers</a></li>
    <li><a class="dropdown-item" href="../articles/theory-approximations.html">Approximations (A1)</a></li>
    <li><a class="dropdown-item" href="../articles/theory-newton.html">Newton Algorithm (A2)</a></li>
    <li><a class="dropdown-item" href="../articles/theory-weights.html">Weight Distributions</a></li>
    <li><a class="dropdown-item" href="../articles/api-reference.html">API Reference</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/joonho112/DPprior/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Case Studies: Multisite Trials and Meta-Analysis</h1>
                        <h4 data-toc-skip class="author">JoonHo Lee</h4>
            
            <h4 data-toc-skip class="date">2026-01-01</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/joonho112/DPprior/blob/main/vignettes/case-studies.Rmd" class="external-link"><code>vignettes/case-studies.Rmd</code></a></small>
      <div class="d-none name"><code>case-studies.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This vignette presents three case studies demonstrating how to apply
the DPprior package in real-world research contexts. Each case study
walks through the complete workflow—from substantive considerations to
final prior specification—using published research as a foundation.</p>
<p>The three case studies span different domains and data
structures:</p>
<table class="table">
<colgroup>
<col width="20%">
<col width="13%">
<col width="32%">
<col width="33%">
</colgroup>
<thead><tr class="header">
<th>Case Study</th>
<th>Domain</th>
<th>J (Sites/Studies)</th>
<th>Key Characteristic</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>1. Conditional Cash Transfer Trial</strong></td>
<td>Education/Policy</td>
<td>38</td>
<td>Moderate sites, dual-anchor refinement</td>
</tr>
<tr class="even">
<td><strong>2. Brief Alcohol Interventions</strong></td>
<td>Public Health</td>
<td>117</td>
<td>Large meta-analysis, multiple heterogeneity sources</td>
</tr>
<tr class="odd">
<td><strong>3. Alabama Pre-K Value-Added</strong></td>
<td>Education Policy</td>
<td>500 (of 847)</td>
<td>Large-scale policy evaluation</td>
</tr>
</tbody>
</table>
<p>By working through these examples, you will learn how to:</p>
<ol style="list-style-type: decimal">
<li>Translate substantive domain knowledge into cluster count
expectations</li>
<li>Choose appropriate calibration methods for different settings</li>
<li>Apply diagnostics to verify prior behavior</li>
<li>Conduct sensitivity analysis across specifications</li>
<li>Report prior elicitation transparently in publications</li>
</ol>
</div>
<div class="section level2">
<h2 id="case-study-conditional-cash-transfer-multisite-trial">1. Case Study: Conditional Cash Transfer Multisite Trial<a class="anchor" aria-label="anchor" href="#case-study-conditional-cash-transfer-multisite-trial"></a>
</h2>
<div class="section level3">
<h3 id="research-context">1.1 Research Context<a class="anchor" aria-label="anchor" href="#research-context"></a>
</h3>
<p>Our first case study draws from the multisite conditional cash
transfer (CCT) experiment analyzed in <a href="https://doi.org/10.3102/10769986241254286" class="external-link">Lee et al. (2025)</a>.
The Conditional Subsidies for School Attendance program, implemented in
Bogotá, Colombia (<a href="https://doi.org/10.1257/app.20170008" class="external-link">Barrera-Osorio et al.,
2019</a>), conducted randomized experiments across 38 sites in the San
Cristobal district.</p>
<p><strong>Study characteristics:</strong></p>
<ul>
<li>
<strong>Sample size</strong>: 6,506 participants nested within 38
sites</li>
<li>
<strong>Average site size</strong>: 171.2 participants</li>
<li>
<strong>Coefficient of variation in site sizes</strong>: 0.67
(range: 23 to 484)</li>
<li>
<strong>Outcomes</strong>: Secondary school enrollment and on-time
graduation</li>
<li>
<strong>Key feature</strong>: Large within-site information, limited
between-site variation</li>
</ul>
</div>
<div class="section level3">
<h3 id="the-inferential-goals">1.2 The Inferential Goals<a class="anchor" aria-label="anchor" href="#the-inferential-goals"></a>
</h3>
<p>The researchers sought to understand the distribution of
site-specific treatment effects
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>τ</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\tau_j</annotation></semantics></math>,
with particular interest in:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Estimating the variance</strong> of the prior distribution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>
</li>
<li>
<strong>Identifying extreme sites</strong> (10th and 90th
percentiles)</li>
<li>
<strong>Understanding heterogeneity</strong> patterns across
sites</li>
</ol>
<p>Given the estimated cross-site effect standard deviation of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>=</mo><mn>0.04</mn></mrow><annotation encoding="application/x-tex">\sigma = 0.04</annotation></semantics></math>
to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.06</mn><annotation encoding="application/x-tex">0.06</annotation></semantics></math>
(in effect size units) and relatively high within-site precision, this
setting exhibits <strong>small between-site information and large
within-site information</strong>—a configuration where prior choice
substantially influences posterior inference.</p>
</div>
<div class="section level3">
<h3 id="initial-prior-elicitation">1.3 Initial Prior Elicitation<a class="anchor" aria-label="anchor" href="#initial-prior-elicitation"></a>
</h3>
<p><strong>Step 1: Determining the expected number of
clusters</strong></p>
<p>When eliciting prior beliefs about cluster structure, researchers
might consider several substantive factors:</p>
<ul>
<li>The intervention was implemented uniformly across sites, suggesting
limited structural heterogeneity</li>
<li>However, local context (school culture, neighborhood
characteristics) might create differential responses</li>
<li>Previous multisite education trials typically exhibit 3–8 distinct
response patterns</li>
</ul>
<p>Based on these considerations, a reasonable expectation is
approximately
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mi>K</mi></msub><mo>=</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">\mu_K = 5</annotation></semantics></math>
clusters among the 38 sites.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define the study context</span></span>
<span><span class="va">J_cct</span> <span class="op">&lt;-</span> <span class="fl">38</span></span>
<span><span class="va">mu_K_cct</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Study context:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Study context:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Number of sites (J):"</span>, <span class="va">J_cct</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Number of sites (J): 38</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Expected clusters (μ_K):"</span>, <span class="va">mu_K_cct</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Expected clusters (μ_K): 5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Ratio (μ_K/J):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">mu_K_cct</span> <span class="op">/</span> <span class="va">J_cct</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Ratio (μ_K/J): 0.132</span></span></code></pre></div>
<p><strong>Step 2: Expressing uncertainty</strong></p>
<p>Given the novelty of this specific intervention context and the
moderate sample of sites, we should express substantial uncertainty. A
“low” confidence level is appropriate:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Initial fit with low confidence</span></span>
<span><span class="va">fit_cct</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_fit.html">DPprior_fit</a></span><span class="op">(</span></span>
<span>  J <span class="op">=</span> <span class="va">J_cct</span>, </span>
<span>  mu_K <span class="op">=</span> <span class="va">mu_K_cct</span>, </span>
<span>  confidence <span class="op">=</span> <span class="st">"low"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: HIGH DOMINANCE RISK: P(w1 &gt; 0.5) = 54.5% exceeds 40%.</span></span>
<span><span class="co">#&gt;   This may indicate unintended prior behavior (RN-07).</span></span>
<span><span class="co">#&gt;   Consider using DPprior_dual() for weight-constrained elicitation.</span></span>
<span><span class="co">#&gt;   See ?DPprior_diagnostics for interpretation.</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit_cct</span><span class="op">)</span></span>
<span><span class="co">#&gt; DPprior Prior Elicitation Result</span></span>
<span><span class="co">#&gt; ============================================= </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Gamma Hyperprior: α ~ Gamma(a = 0.4629, b = 0.2556)</span></span>
<span><span class="co">#&gt;   E[α] = 1.811, SD[α] = 2.662</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Target (J = 38):</span></span>
<span><span class="co">#&gt;   E[K_J]   = 5.00</span></span>
<span><span class="co">#&gt;   Var(K_J) = 20.00</span></span>
<span><span class="co">#&gt;   (from confidence = 'low')</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Achieved:</span></span>
<span><span class="co">#&gt;   E[K_J] = 5.000000, Var(K_J) = 20.000000</span></span>
<span><span class="co">#&gt;   Residual = 6.09e-09</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Method: A2-MN (11 iterations)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Dominance Risk: HIGH ✘ (P(w₁&gt;0.5) = 54%)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="comprehensive-diagnostics">1.4 Comprehensive Diagnostics<a class="anchor" aria-label="anchor" href="#comprehensive-diagnostics"></a>
</h3>
<p>Before accepting this prior, we need to verify its behavior across
multiple dimensions. The <code><a href="../reference/DPprior_diagnostics.html">DPprior_diagnostics()</a></code> function
provides a comprehensive assessment:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">diag_cct</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_diagnostics.html">DPprior_diagnostics</a></span><span class="op">(</span><span class="va">fit_cct</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"=== Comprehensive Diagnostic Report ===\n\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; === Comprehensive Diagnostic Report ===</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"1. ALPHA DISTRIBUTION\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; 1. ALPHA DISTRIBUTION</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"   Mean:     "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_cct</span><span class="op">$</span><span class="va">alpha</span><span class="op">$</span><span class="va">mean</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Mean:      1.811</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"   SD:       "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_cct</span><span class="op">$</span><span class="va">alpha</span><span class="op">$</span><span class="va">sd</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;    SD:        2.662</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"   CV:       "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_cct</span><span class="op">$</span><span class="va">alpha</span><span class="op">$</span><span class="va">cv</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;    CV:        1.47</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"   5th %ile: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_cct</span><span class="op">$</span><span class="va">alpha</span><span class="op">$</span><span class="va">quantiles</span><span class="op">[</span><span class="st">"q5"</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;    5th %ile:  0.005</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"   50th %ile:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_cct</span><span class="op">$</span><span class="va">alpha</span><span class="op">$</span><span class="va">quantiles</span><span class="op">[</span><span class="st">"q50"</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;    50th %ile: 0.767</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"   95th %ile:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_cct</span><span class="op">$</span><span class="va">alpha</span><span class="op">$</span><span class="va">quantiles</span><span class="op">[</span><span class="st">"q95"</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;    95th %ile: 7.15</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n2. CLUSTER COUNT (K)\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 2. CLUSTER COUNT (K)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"   E[K]:     "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_cct</span><span class="op">$</span><span class="va">K</span><span class="op">$</span><span class="va">mean</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;    E[K]:      5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"   Var(K):   "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_cct</span><span class="op">$</span><span class="va">K</span><span class="op">$</span><span class="va">var</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Var(K):    20</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"   SD(K):    "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">diag_cct</span><span class="op">$</span><span class="va">K</span><span class="op">$</span><span class="va">var</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;    SD(K):     4.472</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"   Mode(K):  "</span>, <span class="va">diag_cct</span><span class="op">$</span><span class="va">K</span><span class="op">$</span><span class="va">mode</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Mode(K):   1</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n3. WEIGHT BEHAVIOR\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 3. WEIGHT BEHAVIOR</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"   E[w₁]:        "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_cct</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">mean</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;    E[w₁]:         0.572</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"   Median(w₁):   "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_cct</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">median</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Median(w₁):    0.588</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"   P(w₁ &gt; 0.3):  "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_cct</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">prob_exceeds</span><span class="op">[</span><span class="st">"prob_gt_0.3"</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;    P(w₁ &gt; 0.3):   NA</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"   P(w₁ &gt; 0.5):  "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_cct</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">prob_exceeds</span><span class="op">[</span><span class="st">"prob_gt_0.5"</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;    P(w₁ &gt; 0.5):   0.545</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"   P(w₁ &gt; 0.9):  "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_cct</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">prob_exceeds</span><span class="op">[</span><span class="st">"prob_gt_0.9"</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;    P(w₁ &gt; 0.9):   0.344</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"   Dominance:    "</span>, <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">toupper</a></span><span class="op">(</span><span class="va">diag_cct</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">dominance_risk</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Dominance:     HIGH</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n4. CO-CLUSTERING PROBABILITY (ρ)\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 4. CO-CLUSTERING PROBABILITY (ρ)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"   E[ρ]:         "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_cct</span><span class="op">$</span><span class="va">coclustering</span><span class="op">$</span><span class="va">mean</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;    E[ρ]:          0.572</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"   Interpretation: Two random sites have a"</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">100</span> <span class="op">*</span> <span class="va">diag_cct</span><span class="op">$</span><span class="va">coclustering</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span>, <span class="st">"% chance of sharing a cluster\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Interpretation: Two random sites have a 57 % chance of sharing a cluster</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualizing-the-initial-prior">1.5 Visualizing the Initial Prior<a class="anchor" aria-label="anchor" href="#visualizing-the-initial-prior"></a>
</h3>
<p>The DPprior package provides several visualization functions to help
understand prior behavior. Let’s examine each component:</p>
<p><strong>Alpha distribution:</strong></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_alpha_prior.html">plot_alpha_prior</a></span><span class="op">(</span><span class="va">fit_cct</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="case-studies_files/figure-html/cct-viz-alpha-1.png" class="r-plt" alt="Prior distribution on the concentration parameter α for the CCT study." width="85%"><p class="caption">
Prior distribution on the concentration parameter α for the CCT study.
</p>
</div>
<div class="figure" style="text-align: center">
<img src="case-studies_files/figure-html/cct-viz-alpha-2.png" class="r-plt" alt="Prior distribution on the concentration parameter α for the CCT study." width="85%"><p class="caption">
Prior distribution on the concentration parameter α for the CCT study.
</p>
</div>
<p><strong>Cluster count distribution:</strong></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_K_prior.html">plot_K_prior</a></span><span class="op">(</span><span class="va">fit_cct</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="case-studies_files/figure-html/cct-viz-K-1.png" class="r-plt" alt="Prior PMF of the number of clusters K for the CCT study (J = 38)." width="85%"><p class="caption">
Prior PMF of the number of clusters K for the CCT study (J = 38).
</p>
</div>
<div class="figure" style="text-align: center">
<img src="case-studies_files/figure-html/cct-viz-K-2.png" class="r-plt" alt="Prior PMF of the number of clusters K for the CCT study (J = 38)." width="85%"><p class="caption">
Prior PMF of the number of clusters K for the CCT study (J = 38).
</p>
</div>
<p><strong>Largest cluster weight distribution:</strong></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_w1_prior.html">plot_w1_prior</a></span><span class="op">(</span><span class="va">fit_cct</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="case-studies_files/figure-html/cct-viz-w1-1.png" class="r-plt" alt="Prior distribution on the largest cluster weight w₁. The dashed line at 0.5 indicates the dominance threshold." width="85%"><p class="caption">
Prior distribution on the largest cluster weight w₁. The dashed line at
0.5 indicates the dominance threshold.
</p>
</div>
<div class="figure" style="text-align: center">
<img src="case-studies_files/figure-html/cct-viz-w1-2.png" class="r-plt" alt="Prior distribution on the largest cluster weight w₁. The dashed line at 0.5 indicates the dominance threshold." width="85%"><p class="caption">
Prior distribution on the largest cluster weight w₁. The dashed line at
0.5 indicates the dominance threshold.
</p>
</div>
<p><strong>Complete dashboard:</strong></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_cct</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="case-studies_files/figure-html/cct-viz-dashboard-1.png" class="r-plt" alt="Complete prior elicitation dashboard for the CCT multisite trial (J = 38, μ_K = 5)." width="85%"><p class="caption">
Complete prior elicitation dashboard for the CCT multisite trial (J =
38, μ_K = 5).
</p>
</div>
<pre><code><span><span class="co">#&gt; TableGrob (2 x 2) "dpprior_dashboard": 4 grobs</span></span>
<span><span class="co">#&gt;   z     cells              name           grob</span></span>
<span><span class="co">#&gt; 1 1 (1-1,1-1) dpprior_dashboard gtable[layout]</span></span>
<span><span class="co">#&gt; 2 2 (2-2,1-1) dpprior_dashboard gtable[layout]</span></span>
<span><span class="co">#&gt; 3 3 (1-1,2-2) dpprior_dashboard gtable[layout]</span></span>
<span><span class="co">#&gt; 4 4 (2-2,2-2) dpprior_dashboard gtable[layout]</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="addressing-the-dominance-problem">1.6 Addressing the Dominance Problem<a class="anchor" aria-label="anchor" href="#addressing-the-dominance-problem"></a>
</h3>
<p>The diagnostics reveal an important concern: <strong>high dominance
risk</strong> with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>&gt;</mo><mn>0.5</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0.54</mn></mrow><annotation encoding="application/x-tex">P(w_1 &gt; 0.5) = 0.54</annotation></semantics></math>.
This means there is a 54% prior probability that a single cluster
contains more than half of all sites.</p>
<p>In a setting with limited between-site information, this high
dominance probability can lead to overshrinkage in posterior inference.
The dual-anchor framework allows us to constrain the prior to reduce
dominance while maintaining our beliefs about the expected number of
clusters.</p>
<p><strong>Applying dual-anchor refinement:</strong></p>
<p>We target
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>&gt;</mo><mn>0.5</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0.25</mn></mrow><annotation encoding="application/x-tex">P(w_1 &gt; 0.5) = 0.25</annotation></semantics></math>
(25% dominance probability) while keeping
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
as the primary anchor
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>0.7</mn></mrow><annotation encoding="application/x-tex">\lambda = 0.7</annotation></semantics></math>):</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Apply dual-anchor to reduce dominance risk</span></span>
<span><span class="va">fit_cct_dual</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_dual.html">DPprior_dual</a></span><span class="op">(</span></span>
<span>  fit <span class="op">=</span> <span class="va">fit_cct</span>,</span>
<span>  w1_target <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>threshold <span class="op">=</span> <span class="fl">0.5</span>, value <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  lambda <span class="op">=</span> <span class="fl">0.7</span>,  <span class="co"># K remains primary anchor</span></span>
<span>  loss_type <span class="op">=</span> <span class="st">"adaptive"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Original prior:    Gamma(a ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fit_cct</span><span class="op">$</span><span class="va">a</span>, <span class="fl">4</span><span class="op">)</span>, </span>
<span>    <span class="st">", b ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fit_cct</span><span class="op">$</span><span class="va">b</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">")\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Original prior:    Gamma(a = 0.4629 , b = 0.2556 )</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Dual-anchor prior: Gamma(a ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fit_cct_dual</span><span class="op">$</span><span class="va">a</span>, <span class="fl">4</span><span class="op">)</span>, </span>
<span>    <span class="st">", b ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fit_cct_dual</span><span class="op">$</span><span class="va">b</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">")\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dual-anchor prior: Gamma(a = 1.0887 , b = 0.4362 )</span></span></code></pre></div>
<p><strong>Verifying the improvement:</strong></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">diag_cct_dual</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_diagnostics.html">DPprior_diagnostics</a></span><span class="op">(</span><span class="va">fit_cct_dual</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create comparison table</span></span>
<span><span class="va">comparison_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Metric <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"E[α]"</span>, <span class="st">"E[K]"</span>, <span class="st">"Var(K)"</span>, <span class="st">"E[w₁]"</span>, <span class="st">"P(w₁ &gt; 0.5)"</span>, <span class="st">"Dominance Risk"</span><span class="op">)</span>,</span>
<span>  Original <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_cct</span><span class="op">$</span><span class="va">alpha</span><span class="op">$</span><span class="va">mean</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_cct</span><span class="op">$</span><span class="va">K</span><span class="op">$</span><span class="va">mean</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_cct</span><span class="op">$</span><span class="va">K</span><span class="op">$</span><span class="va">var</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_cct</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">mean</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_cct</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">prob_exceeds</span><span class="op">[</span><span class="st">"prob_gt_0.5"</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="va">diag_cct</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">dominance_risk</span></span>
<span>  <span class="op">)</span>,</span>
<span>  Dual_Anchor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_cct_dual</span><span class="op">$</span><span class="va">alpha</span><span class="op">$</span><span class="va">mean</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_cct_dual</span><span class="op">$</span><span class="va">K</span><span class="op">$</span><span class="va">mean</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_cct_dual</span><span class="op">$</span><span class="va">K</span><span class="op">$</span><span class="va">var</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_cct_dual</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">mean</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_cct_dual</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">prob_exceeds</span><span class="op">[</span><span class="st">"prob_gt_0.5"</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="va">diag_cct_dual</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">dominance_risk</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span></span>
<span>  <span class="va">comparison_df</span>,</span>
<span>  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Metric"</span>, <span class="st">"K-only Prior"</span>, <span class="st">"Dual-Anchor Prior"</span><span class="op">)</span>,</span>
<span>  caption <span class="op">=</span> <span class="st">"Comparison of K-only and dual-anchor priors for the CCT study"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Comparison of K-only and dual-anchor priors for the CCT
study</caption>
<thead><tr class="header">
<th align="left">Metric</th>
<th align="left">K-only Prior</th>
<th align="left">Dual-Anchor Prior</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">E[α]</td>
<td align="left">1.811</td>
<td align="left">2.496</td>
</tr>
<tr class="even">
<td align="left">E[K]</td>
<td align="left">5</td>
<td align="left">6.65</td>
</tr>
<tr class="odd">
<td align="left">Var(K)</td>
<td align="left">20</td>
<td align="left">18</td>
</tr>
<tr class="even">
<td align="left">E[w₁]</td>
<td align="left">0.572</td>
<td align="left">0.41</td>
</tr>
<tr class="odd">
<td align="left">P(w₁ &gt; 0.5)</td>
<td align="left">0.545</td>
<td align="left">0.355</td>
</tr>
<tr class="even">
<td align="left">Dominance Risk</td>
<td align="left">high</td>
<td align="left">moderate</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="comparing-k-only-vs-dual-anchor-priors">1.7 Comparing K-only vs Dual-Anchor Priors<a class="anchor" aria-label="anchor" href="#comparing-k-only-vs-dual-anchor-priors"></a>
</h3>
<p>Let’s visualize the difference between the two priors:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare data for K PMF comparison</span></span>
<span><span class="va">logS_cct</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_log_stirling.html">compute_log_stirling</a></span><span class="op">(</span><span class="va">J_cct</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pmf_original</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pmf_K_marginal.html">pmf_K_marginal</a></span><span class="op">(</span><span class="va">J_cct</span>, <span class="va">fit_cct</span><span class="op">$</span><span class="va">a</span>, <span class="va">fit_cct</span><span class="op">$</span><span class="va">b</span>, logS <span class="op">=</span> <span class="va">logS_cct</span><span class="op">)</span></span>
<span><span class="va">pmf_dual</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pmf_K_marginal.html">pmf_K_marginal</a></span><span class="op">(</span><span class="va">J_cct</span>, <span class="va">fit_cct_dual</span><span class="op">$</span><span class="va">a</span>, <span class="va">fit_cct_dual</span><span class="op">$</span><span class="va">b</span>, logS <span class="op">=</span> <span class="va">logS_cct</span><span class="op">)</span></span>
<span></span>
<span><span class="va">k_compare_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  K <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">pmf_original</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  Probability <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pmf_original</span>, <span class="va">pmf_dual</span><span class="op">)</span>,</span>
<span>  Prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"K-only"</span>, <span class="st">"Dual-anchor"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">pmf_original</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">k_compare_df</span><span class="op">$</span><span class="va">Prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">k_compare_df</span><span class="op">$</span><span class="va">Prior</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"K-only"</span>, <span class="st">"Dual-anchor"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Prepare data for w1 comparison</span></span>
<span><span class="va">w1_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">w1_dens_original</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">w1_grid</span>, <span class="kw">function</span><span class="op">(</span><span class="va">w</span><span class="op">)</span> <span class="fu"><a href="../reference/density_w1.html">density_w1</a></span><span class="op">(</span><span class="va">w</span>, <span class="va">fit_cct</span><span class="op">$</span><span class="va">a</span>, <span class="va">fit_cct</span><span class="op">$</span><span class="va">b</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">w1_dens_dual</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">w1_grid</span>, <span class="kw">function</span><span class="op">(</span><span class="va">w</span><span class="op">)</span> <span class="fu"><a href="../reference/density_w1.html">density_w1</a></span><span class="op">(</span><span class="va">w</span>, <span class="va">fit_cct_dual</span><span class="op">$</span><span class="va">a</span>, <span class="va">fit_cct_dual</span><span class="op">$</span><span class="va">b</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">w1_compare_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  w1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">w1_grid</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  Density <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">w1_dens_original</span>, <span class="va">w1_dens_dual</span><span class="op">)</span>,</span>
<span>  Prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"K-only"</span>, <span class="st">"Dual-anchor"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">w1_grid</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">w1_compare_df</span><span class="op">$</span><span class="va">Prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">w1_compare_df</span><span class="op">$</span><span class="va">Prior</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"K-only"</span>, <span class="st">"Dual-anchor"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create plots</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">k_compare_df</span><span class="op">[</span><span class="va">k_compare_df</span><span class="op">$</span><span class="va">K</span> <span class="op">&lt;=</span> <span class="fl">15</span>, <span class="op">]</span>, </span>
<span>             <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">K</span>, y <span class="op">=</span> <span class="va">Probability</span>, fill <span class="op">=</span> <span class="va">Prior</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_col</span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span>, alpha <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="va">palette_2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">K</span><span class="op">[</span><span class="va">J</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Probability"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Cluster Count Distribution"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>, legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">w1_compare_df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">w1</span>, y <span class="op">=</span> <span class="va">Density</span>, color <span class="op">=</span> <span class="va">Prior</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0.5</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"gray50"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="va">palette_2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">w</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Density"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Largest Cluster Weight Distribution"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>, legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="case-studies_files/figure-html/cct-comparison-viz-1.png" class="r-plt" alt="Comparison of K-only and dual-anchor priors: the dual-anchor approach reduces dominance risk while maintaining similar cluster count expectations." width="85%"><p class="caption">
Comparison of K-only and dual-anchor priors: the dual-anchor approach
reduces dominance risk while maintaining similar cluster count
expectations.
</p>
</div>
<p>The dual-anchor prior shifts mass in the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math>
distribution away from extreme values (right panel) while maintaining a
similar expected number of clusters (left panel). This achieves our goal
of reducing dominance risk without substantially changing our beliefs
about cluster count.</p>
</div>
<div class="section level3">
<h3 id="sensitivity-analysis">1.8 Sensitivity Analysis<a class="anchor" aria-label="anchor" href="#sensitivity-analysis"></a>
</h3>
<p>Given the uncertainty in our prior specification, we conduct a
sensitivity analysis across a range of plausible values for both the
K-only and dual-anchor approaches:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Sensitivity to μ_K</span></span>
<span><span class="va">mu_K_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sensitivity_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">mu_K_grid</span>, <span class="kw">function</span><span class="op">(</span><span class="va">mu</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># K-only fit</span></span>
<span>  <span class="va">fit_k</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_fit.html">DPprior_fit</a></span><span class="op">(</span>J <span class="op">=</span> <span class="va">J_cct</span>, mu_K <span class="op">=</span> <span class="va">mu</span>, confidence <span class="op">=</span> <span class="st">"low"</span><span class="op">)</span></span>
<span>  <span class="va">diag_k</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_diagnostics.html">DPprior_diagnostics</a></span><span class="op">(</span><span class="va">fit_k</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Dual-anchor fit</span></span>
<span>  <span class="va">fit_d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_dual.html">DPprior_dual</a></span><span class="op">(</span></span>
<span>    fit <span class="op">=</span> <span class="va">fit_k</span>,</span>
<span>    w1_target <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>threshold <span class="op">=</span> <span class="fl">0.5</span>, value <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    lambda <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>    loss_type <span class="op">=</span> <span class="st">"adaptive"</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">diag_d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_diagnostics.html">DPprior_diagnostics</a></span><span class="op">(</span><span class="va">fit_d</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    mu_K <span class="op">=</span> <span class="va">mu</span>,</span>
<span>    <span class="co"># K-only results</span></span>
<span>    a_k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fit_k</span><span class="op">$</span><span class="va">a</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    b_k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fit_k</span><span class="op">$</span><span class="va">b</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    E_K_k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_k</span><span class="op">$</span><span class="va">K</span><span class="op">$</span><span class="va">mean</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    P_dom_k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_k</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">prob_exceeds</span><span class="op">[</span><span class="st">"prob_gt_0.5"</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="co"># Dual-anchor results</span></span>
<span>    a_d <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fit_d</span><span class="op">$</span><span class="va">a</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    b_d <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fit_d</span><span class="op">$</span><span class="va">b</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    E_K_d <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_d</span><span class="op">$</span><span class="va">K</span><span class="op">$</span><span class="va">mean</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    P_dom_d <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_d</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">prob_exceeds</span><span class="op">[</span><span class="st">"prob_gt_0.5"</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: HIGH DOMINANCE RISK: P(w1 &gt; 0.5) = 74.3% exceeds 40%.</span></span>
<span><span class="co">#&gt;   This may indicate unintended prior behavior (RN-07).</span></span>
<span><span class="co">#&gt;   Consider using DPprior_dual() for weight-constrained elicitation.</span></span>
<span><span class="co">#&gt;   See ?DPprior_diagnostics for interpretation.</span></span>
<span><span class="co">#&gt; Warning: HIGH DOMINANCE RISK: P(w1 &gt; 0.5) = 54.5% exceeds 40%.</span></span>
<span><span class="co">#&gt;   This may indicate unintended prior behavior (RN-07).</span></span>
<span><span class="co">#&gt;   Consider using DPprior_dual() for weight-constrained elicitation.</span></span>
<span><span class="co">#&gt;   See ?DPprior_diagnostics for interpretation.</span></span>
<span></span>
<span><span class="va">sensitivity_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">sensitivity_results</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span></span>
<span>  <span class="va">sensitivity_df</span>,</span>
<span>  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Target μ_K"</span>, </span>
<span>                <span class="st">"a (K)"</span>, <span class="st">"b (K)"</span>, <span class="st">"E[K]"</span>, <span class="st">"P(w₁&gt;0.5)"</span>,</span>
<span>                <span class="st">"a (DA)"</span>, <span class="st">"b (DA)"</span>, <span class="st">"E[K]"</span>, <span class="st">"P(w₁&gt;0.5)"</span><span class="op">)</span>,</span>
<span>  row.names <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  caption <span class="op">=</span> <span class="st">"Sensitivity analysis: K-only (K) vs Dual-anchor (DA) priors (J = 38, low confidence)"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Sensitivity analysis: K-only (K) vs Dual-anchor (DA) priors (J
= 38, low confidence)</caption>
<colgroup>
<col width="16%">
<col width="8%">
<col width="8%">
<col width="7%">
<col width="14%">
<col width="10%">
<col width="10%">
<col width="8%">
<col width="14%">
</colgroup>
<thead><tr class="header">
<th align="right">Target μ_K</th>
<th align="right">a (K)</th>
<th align="right">b (K)</th>
<th align="right">E[K]</th>
<th align="right">P(w₁&gt;0.5)</th>
<th align="right">a (DA)</th>
<th align="right">b (DA)</th>
<th align="right">E[K]</th>
<th align="right">P(w₁&gt;0.5)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">3</td>
<td align="right">0.270</td>
<td align="right">0.345</td>
<td align="right">3</td>
<td align="right">0.743</td>
<td align="right">7.568</td>
<td align="right">3.733</td>
<td align="right">6.45</td>
<td align="right">0.276</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">0.463</td>
<td align="right">0.256</td>
<td align="right">5</td>
<td align="right">0.545</td>
<td align="right">1.089</td>
<td align="right">0.436</td>
<td align="right">6.65</td>
<td align="right">0.355</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">0.601</td>
<td align="right">0.191</td>
<td align="right">7</td>
<td align="right">0.399</td>
<td align="right">0.840</td>
<td align="right">0.232</td>
<td align="right">7.94</td>
<td align="right">0.313</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">0.727</td>
<td align="right">0.123</td>
<td align="right">10</td>
<td align="right">0.253</td>
<td align="right">0.732</td>
<td align="right">0.124</td>
<td align="right">10.03</td>
<td align="right">0.251</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="final-prior-selection-and-reporting">1.9 Final Prior Selection and Reporting<a class="anchor" aria-label="anchor" href="#final-prior-selection-and-reporting"></a>
</h3>
<p>Based on our analysis, we recommend the <strong>dual-anchor
prior</strong> for the CCT study, as it provides appropriate control
over dominance risk in this low between-site information setting.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"RECOMMENDED PRIOR FOR CCT STUDY\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; RECOMMENDED PRIOR FOR CCT STUDY</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"================================\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; ================================</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"α ~ Gamma("</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fit_cct_dual</span><span class="op">$</span><span class="va">a</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">", "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fit_cct_dual</span><span class="op">$</span><span class="va">b</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">")\n\n"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="co">#&gt; α ~ Gamma(1.0887, 0.4362)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Key properties:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Key properties:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  E[K] ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_cct_dual</span><span class="op">$</span><span class="va">K</span><span class="op">$</span><span class="va">mean</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"clusters\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   E[K] = 6.65 clusters</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  P(w₁ &gt; 0.5) ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_cct_dual</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">prob_exceeds</span><span class="op">[</span><span class="st">"prob_gt_0.5"</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   P(w₁ &gt; 0.5) = 0.36</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Dominance risk:"</span>, <span class="va">diag_cct_dual</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">dominance_risk</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Dominance risk: moderate</span></span></code></pre></div>
<p><strong>Reporting language for publication:</strong></p>
<blockquote>
<p>We elicited beliefs about the number of latent clusters among the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi><mo>=</mo><mn>38</mn></mrow><annotation encoding="application/x-tex">J = 38</annotation></semantics></math>
sites in the CCT multisite trial. Based on substantive knowledge of
similar education interventions and the uniformity of implementation, we
specified
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝔼</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>K</mi><mi>J</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">\mathbb{E}[K_J] = 5</annotation></semantics></math>
(approximately five distinct response patterns) with low confidence.
Initial diagnostics using the K-only calibration revealed high dominance
risk with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>&gt;</mo><mn>0.5</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0.54</mn></mrow><annotation encoding="application/x-tex">P(w_1 &gt; 0.5) = 0.54</annotation></semantics></math>,
which is problematic in settings with limited between-site information.
We therefore applied dual-anchor refinement targeting
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>&gt;</mo><mn>0.5</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>≤</mo><mn>0.25</mn></mrow><annotation encoding="application/x-tex">P(w_1 &gt; 0.5) \leq 0.25</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>0.7</mn></mrow><annotation encoding="application/x-tex">\lambda = 0.7</annotation></semantics></math>,
yielding a Gamma(1.089, 0.436) hyperprior. The refined prior maintains
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝔼</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>K</mi><mi>J</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo>≈</mo><mn>6.7</mn></mrow><annotation encoding="application/x-tex">\mathbb{E}[K_J] \approx 6.7</annotation></semantics></math>
while reducing dominance risk to moderate. Sensitivity analyses across
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mi>K</mi></msub><mo>∈</mo><mo stretchy="false" form="prefix">{</mo><mn>3</mn><mo>,</mo><mn>5</mn><mo>,</mo><mn>7</mn><mo>,</mo><mn>10</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\mu_K \in \{3, 5, 7, 10\}</annotation></semantics></math>
confirmed that substantive conclusions were robust to prior
specification.</p>
</blockquote>
</div>
</div>
<div class="section level2">
<h2 id="case-study-brief-alcohol-interventions-meta-analysis">2. Case Study: Brief Alcohol Interventions Meta-Analysis<a class="anchor" aria-label="anchor" href="#case-study-brief-alcohol-interventions-meta-analysis"></a>
</h2>
<div class="section level3">
<h3 id="research-context-1">2.1 Research Context<a class="anchor" aria-label="anchor" href="#research-context-1"></a>
</h3>
<p>Our second case study is based on the meta-analysis of brief alcohol
interventions (BAI) for adolescents and young adults conducted by <a href="https://doi.org/10.1007/s11121-021-01246-3" class="external-link">Pustejovsky &amp;
Tipton (2022)</a>, who re-analyzed data from <a href="https://doi.org/10.1016/j.jsat.2014.09.001" class="external-link">Tanner-Smith &amp;
Lipsey (2015)</a>.</p>
<p><strong>Study characteristics:</strong></p>
<ul>
<li>
<strong>Number of studies</strong>: 117 randomized trials</li>
<li>
<strong>Total effect sizes</strong>: 1,198 estimates</li>
<li>
<strong>Effect sizes per study</strong>: Median = 6, range = 1 to
108</li>
<li>
<strong>Outcome</strong>: Alcohol consumption (standardized mean
differences)</li>
<li>
<strong>Key feature</strong>: Complex dependence structure
(correlated and hierarchical)</li>
</ul>
</div>
<div class="section level3">
<h3 id="the-meta-analytic-challenge">2.2 The Meta-Analytic Challenge<a class="anchor" aria-label="anchor" href="#the-meta-analytic-challenge"></a>
</h3>
<p>In meta-analysis, the Dirichlet Process mixture model can be used to
flexibly model the distribution of true study effects. This is
particularly valuable when:</p>
<ul>
<li>The true effect distribution may be non-Gaussian</li>
<li>There may be discrete subpopulations of studies with similar
effects</li>
<li>Robust inference is needed without strong distributional
assumptions</li>
</ul>
<p>The BAI meta-analysis presents a setting with substantial
between-study heterogeneity
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>τ</mi><mo accent="true">̂</mo></mover><mo>=</mo><mn>0.182</mn></mrow><annotation encoding="application/x-tex">\hat{\tau} = 0.182</annotation></semantics></math>
under the correlated effects model), suggesting the potential for
distinct effect subgroups.</p>
</div>
<div class="section level3">
<h3 id="eliciting-the-prior">2.3 Eliciting the Prior<a class="anchor" aria-label="anchor" href="#eliciting-the-prior"></a>
</h3>
<p><strong>Step 1: Substantive reasoning about clusters</strong></p>
<p>In the BAI context, we consider potential sources of effect
heterogeneity:</p>
<ul>
<li>
<strong>Intervention type</strong>: Brief motivational interviewing
vs. feedback-only vs. multi-session programs vs. computerized
interventions</li>
<li>
<strong>Population</strong>: College students vs. high school
vs. clinical samples vs. community populations</li>
<li>
<strong>Outcome timing</strong>: Immediate vs. short-term (3 months)
vs. medium-term (6 months) vs. long-term (12+ months) effects</li>
<li>
<strong>Control condition</strong>: No treatment vs. attention
control vs.  treatment-as-usual vs. alternative intervention</li>
<li>
<strong>Delivery format</strong>: Individual vs. group
vs. self-administered</li>
<li>
<strong>Setting</strong>: Healthcare vs. educational
vs. community</li>
</ul>
<p>Given the many potential mechanisms for heterogeneity and the large
number of studies, a reasonable expectation might be 15–25 distinct
effect clusters among 117 studies. We start with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mi>K</mi></msub><mo>=</mo><mn>18</mn></mrow><annotation encoding="application/x-tex">\mu_K = 18</annotation></semantics></math>:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define the meta-analysis context</span></span>
<span><span class="va">J_bai</span> <span class="op">&lt;-</span> <span class="fl">117</span></span>
<span><span class="va">mu_K_bai</span> <span class="op">&lt;-</span> <span class="fl">18</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Meta-analysis context:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Meta-analysis context:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Number of studies (J):"</span>, <span class="va">J_bai</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Number of studies (J): 117</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Expected clusters (μ_K):"</span>, <span class="va">mu_K_bai</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Expected clusters (μ_K): 18</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Ratio (μ_K/J):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">mu_K_bai</span> <span class="op">/</span> <span class="va">J_bai</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Ratio (μ_K/J): 0.154</span></span></code></pre></div>
<p><strong>Step 2: Expressing uncertainty</strong></p>
<p>Meta-analyses often have more uncertainty about the number of
distinct effect clusters than multisite trials, as studies are conducted
independently with varying methodologies. We use low confidence:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_bai</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_fit.html">DPprior_fit</a></span><span class="op">(</span></span>
<span>  J <span class="op">=</span> <span class="va">J_bai</span>, </span>
<span>  mu_K <span class="op">=</span> <span class="va">mu_K_bai</span>, </span>
<span>  confidence <span class="op">=</span> <span class="st">"low"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit_bai</span><span class="op">)</span></span>
<span><span class="co">#&gt; DPprior Prior Elicitation Result</span></span>
<span><span class="co">#&gt; ============================================= </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Gamma Hyperprior: α ~ Gamma(a = 1.9005, b = 0.2986)</span></span>
<span><span class="co">#&gt;   E[α] = 6.365, SD[α] = 4.617</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Target (J = 117):</span></span>
<span><span class="co">#&gt;   E[K_J]   = 18.00</span></span>
<span><span class="co">#&gt;   Var(K_J) = 85.00</span></span>
<span><span class="co">#&gt;   (from confidence = 'low')</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Achieved:</span></span>
<span><span class="co">#&gt;   E[K_J] = 18.000000, Var(K_J) = 85.000000</span></span>
<span><span class="co">#&gt;   Residual = 2.16e-12</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Method: A2-MN (6 iterations)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Dominance Risk: LOW ✓ (P(w₁&gt;0.5) = 10%)</span></span></code></pre></div>
<p><strong>Step 3: Diagnostic verification</strong></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">diag_bai</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_diagnostics.html">DPprior_diagnostics</a></span><span class="op">(</span><span class="va">fit_bai</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Diagnostic Summary:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Diagnostic Summary:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"----------------\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; ----------------</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Alpha distribution:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Alpha distribution:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  E[α] ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_bai</span><span class="op">$</span><span class="va">alpha</span><span class="op">$</span><span class="va">mean</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   E[α] = 6.365</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  SD(α) ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_bai</span><span class="op">$</span><span class="va">alpha</span><span class="op">$</span><span class="va">sd</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   SD(α) = 4.617</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  95% CI: ["</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_bai</span><span class="op">$</span><span class="va">alpha</span><span class="op">$</span><span class="va">quantiles</span><span class="op">[</span><span class="st">"q5"</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">", "</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_bai</span><span class="op">$</span><span class="va">alpha</span><span class="op">$</span><span class="va">quantiles</span><span class="op">[</span><span class="st">"q95"</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"]\n"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="co">#&gt;   95% CI: [1.059, 15.344]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nCluster count:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Cluster count:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  E[K] ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_bai</span><span class="op">$</span><span class="va">K</span><span class="op">$</span><span class="va">mean</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   E[K] = 18</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Var(K) ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_bai</span><span class="op">$</span><span class="va">K</span><span class="op">$</span><span class="va">var</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Var(K) = 85</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Mode(K) ="</span>, <span class="va">diag_bai</span><span class="op">$</span><span class="va">K</span><span class="op">$</span><span class="va">mode</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Mode(K) = 14</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nWeight behavior:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Weight behavior:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  E[w₁] ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_bai</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">mean</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   E[w₁] = 0.2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  P(w₁ &gt; 0.5) ="</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_bai</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">prob_exceeds</span><span class="op">[</span><span class="st">"prob_gt_0.5"</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   P(w₁ &gt; 0.5) = 0.102</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Dominance risk:"</span>, <span class="va">diag_bai</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">dominance_risk</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Dominance risk: low</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="comparing-alternative-specifications">2.4 Comparing Alternative Specifications<a class="anchor" aria-label="anchor" href="#comparing-alternative-specifications"></a>
</h3>
<p>For meta-analysis, it is valuable to compare different prior
specifications to assess robustness. We compare three approaches:
expecting fewer clusters, the baseline, and expecting more clusters.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define three candidate priors</span></span>
<span><span class="va">bai_candidates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"Conservative (μ_K = 10)"</span> <span class="op">=</span> <span class="fu"><a href="../reference/DPprior_fit.html">DPprior_fit</a></span><span class="op">(</span>J <span class="op">=</span> <span class="va">J_bai</span>, mu_K <span class="op">=</span> <span class="fl">10</span>, confidence <span class="op">=</span> <span class="st">"low"</span><span class="op">)</span>,</span>
<span>  <span class="st">"Baseline (μ_K = 18)"</span> <span class="op">=</span> <span class="fu"><a href="../reference/DPprior_fit.html">DPprior_fit</a></span><span class="op">(</span>J <span class="op">=</span> <span class="va">J_bai</span>, mu_K <span class="op">=</span> <span class="fl">18</span>, confidence <span class="op">=</span> <span class="st">"low"</span><span class="op">)</span>,</span>
<span>  <span class="st">"Liberal (μ_K = 30)"</span> <span class="op">=</span> <span class="fu"><a href="../reference/DPprior_fit.html">DPprior_fit</a></span><span class="op">(</span>J <span class="op">=</span> <span class="va">J_bai</span>, mu_K <span class="op">=</span> <span class="fl">30</span>, confidence <span class="op">=</span> <span class="st">"low"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create comparison table</span></span>
<span><span class="va">bai_comp_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bai_candidates</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">nm</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="va">bai_candidates</span><span class="op">[[</span><span class="va">nm</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">diag</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_diagnostics.html">DPprior_diagnostics</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    Prior <span class="op">=</span> <span class="va">nm</span>,</span>
<span>    a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">a</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">b</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    E_K <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag</span><span class="op">$</span><span class="va">K</span><span class="op">$</span><span class="va">mean</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    E_w1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">mean</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    E_rho <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag</span><span class="op">$</span><span class="va">coclustering</span><span class="op">$</span><span class="va">mean</span>, <span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bai_comp_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">bai_comp_results</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span></span>
<span>  <span class="va">bai_comp_df</span>,</span>
<span>  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Prior"</span>, <span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"E[K]"</span>, <span class="st">"E[w₁]"</span>, <span class="st">"E[ρ]"</span><span class="op">)</span>,</span>
<span>  caption <span class="op">=</span> <span class="st">"Comparison of candidate priors for the BAI meta-analysis (J = 117)"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Comparison of candidate priors for the BAI meta-analysis (J =
117)</caption>
<thead><tr class="header">
<th align="left">Prior</th>
<th align="right">a</th>
<th align="right">b</th>
<th align="right">E[K]</th>
<th align="right">E[w₁]</th>
<th align="right">E[ρ]</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Conservative (μ_K = 10)</td>
<td align="right">1.232</td>
<td align="right">0.449</td>
<td align="right">10</td>
<td align="right">0.379</td>
<td align="right">0.379</td>
</tr>
<tr class="even">
<td align="left">Baseline (μ_K = 18)</td>
<td align="right">1.901</td>
<td align="right">0.299</td>
<td align="right">18</td>
<td align="right">0.200</td>
<td align="right">0.200</td>
</tr>
<tr class="odd">
<td align="left">Liberal (μ_K = 30)</td>
<td align="right">2.470</td>
<td align="right">0.173</td>
<td align="right">30</td>
<td align="right">0.096</td>
<td align="right">0.096</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="visualizing-the-comparison">2.5 Visualizing the Comparison<a class="anchor" aria-label="anchor" href="#visualizing-the-comparison"></a>
</h3>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create data for K PMF comparison</span></span>
<span><span class="va">logS_bai</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_log_stirling.html">compute_log_stirling</a></span><span class="op">(</span><span class="va">J_bai</span><span class="op">)</span></span>
<span></span>
<span><span class="va">k_bai_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bai_candidates</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">nm</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="va">bai_candidates</span><span class="op">[[</span><span class="va">nm</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">pmf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pmf_K_marginal.html">pmf_K_marginal</a></span><span class="op">(</span><span class="va">J_bai</span>, <span class="va">fit</span><span class="op">$</span><span class="va">a</span>, <span class="va">fit</span><span class="op">$</span><span class="va">b</span>, logS <span class="op">=</span> <span class="va">logS_bai</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    K <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">pmf</span><span class="op">)</span>,</span>
<span>    probability <span class="op">=</span> <span class="va">pmf</span>,</span>
<span>    Prior <span class="op">=</span> <span class="va">nm</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">k_bai_df</span><span class="op">$</span><span class="va">Prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">k_bai_df</span><span class="op">$</span><span class="va">Prior</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bai_candidates</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot PMF comparison</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">k_bai_df</span><span class="op">[</span><span class="va">k_bai_df</span><span class="op">$</span><span class="va">K</span> <span class="op">&lt;=</span> <span class="fl">50</span>, <span class="op">]</span>, </span>
<span>       <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">K</span>, y <span class="op">=</span> <span class="va">probability</span>, color <span class="op">=</span> <span class="va">Prior</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="va">palette_3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">K</span><span class="op">[</span><span class="va">J</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Probability"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Prior PMF of Number of Clusters (BAI Meta-Analysis)"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"J = 117 studies"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>, legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="case-studies_files/figure-html/bai-viz-comparison-1.png" class="r-plt" alt="Comparison of three candidate priors for the BAI meta-analysis." width="85%"><p class="caption">
Comparison of three candidate priors for the BAI meta-analysis.
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="case-study-alabama-pre-k-value-added-analysis">3. Case Study: Alabama Pre-K Value-Added Analysis<a class="anchor" aria-label="anchor" href="#case-study-alabama-pre-k-value-added-analysis"></a>
</h2>
<div class="section level3">
<h3 id="research-context-2">3.1 Research Context<a class="anchor" aria-label="anchor" href="#research-context-2"></a>
</h3>
<p>Our third case study illustrates prior elicitation for a large-scale
value-added analysis in Alabama’s pre-kindergarten program.</p>
<p><strong>Study characteristics:</strong></p>
<ul>
<li>
<strong>Sites</strong>: 847 pre-K sites across the state</li>
<li>
<strong>Providers</strong>: 74.4% public schools, 10.4% private
centers, 6.2% Head Start, and others</li>
<li>
<strong>Class sizes</strong>: 13–18 students per classroom</li>
<li>
<strong>Outcomes</strong>: Six developmental domains (Literacy,
Mathematics, Cognitive, Language, Social-Emotional, Physical)</li>
<li>
<strong>Assessment</strong>: Teaching Strategies GOLD®</li>
</ul>
<p><strong>A note on package limitations</strong>: The current version
of DPprior supports
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi><mo>≤</mo><mn>500</mn></mrow><annotation encoding="application/x-tex">J \leq 500</annotation></semantics></math>
due to pre-computed unsigned Stirling numbers of the first kind, which
are required for exact moment calculations. Support for larger
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>J</mi><annotation encoding="application/x-tex">J</annotation></semantics></math>
is planned for future releases. For the 847 sites in the Alabama study,
we demonstrate the workflow using
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi><mo>=</mo><mn>500</mn></mrow><annotation encoding="application/x-tex">J = 500</annotation></semantics></math>
as a practical upper bound. This limitation has minimal impact on
substantive conclusions for several reasons: (1) the relationship
between
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝔼</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>K</mi><mi>J</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}[K_J]</annotation></semantics></math>
is approximately logarithmic in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>J</mi><annotation encoding="application/x-tex">J</annotation></semantics></math>,
so results are relatively stable across nearby sample sizes; (2) using a
conservative (smaller)
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>J</mi><annotation encoding="application/x-tex">J</annotation></semantics></math>
tends to produce slightly more concentrated priors, which is a
defensible choice in uncertain settings; and (3) the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mi>K</mi></msub><mi>/</mi><mi>J</mi></mrow><annotation encoding="application/x-tex">\mu_K / J</annotation></semantics></math>
ratio—rather than
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>J</mi><annotation encoding="application/x-tex">J</annotation></semantics></math>
alone—is the primary driver of the elicited prior.</p>
</div>
<div class="section level3">
<h3 id="the-value-added-challenge">3.2 The Value-Added Challenge<a class="anchor" aria-label="anchor" href="#the-value-added-challenge"></a>
</h3>
<p>Value-added models (VAMs) estimate site-specific contributions to
student learning
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\theta_j</annotation></semantics></math>).
Key challenges in this context include:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Distribution estimation</strong>: Is the distribution of
site effects normal, or are there distinct subpopulations?</li>
<li>
<strong>Tail identification</strong>: Which sites fall in the lowest
and highest 10% of the distribution?</li>
<li>
<strong>Ranking</strong>: Can we produce meaningful “report cards”
for sites?</li>
</ol>
<p>The semiparametric Dirichlet Process approach allows flexible
modeling of the site effect distribution without imposing normality.</p>
</div>
<div class="section level3">
<h3 id="eliciting-the-prior-1">3.3 Eliciting the Prior<a class="anchor" aria-label="anchor" href="#eliciting-the-prior-1"></a>
</h3>
<p><strong>Step 1: Substantive considerations</strong></p>
<p>With 847 sites, we expect considerable heterogeneity. Potential
sources of clustering include:</p>
<ul>
<li>
<strong>Provider type</strong>: Public schools vs. private centers
vs. Head Start may exhibit systematically different effects</li>
<li>
<strong>Geographic region</strong>: Urban vs. rural patterns</li>
<li>
<strong>Resource levels</strong>: Varying levels of site resources
and teacher qualifications</li>
<li>
<strong>Implementation fidelity</strong>: Variation in how the
curriculum is delivered</li>
</ul>
<p>A reasonable expectation might be 40–60 distinct “types” of sites,
representing approximately 5–7% of the total. We specify
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mi>K</mi></msub><mo>=</mo><mn>50</mn></mrow><annotation encoding="application/x-tex">\mu_K = 50</annotation></semantics></math>:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define the context</span></span>
<span><span class="co"># Note: Using J = 500 (package maximum) for the 847-site study</span></span>
<span><span class="va">J_alabama</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span><span class="va">mu_K_alabama</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Alabama Pre-K context:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Alabama Pre-K context:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Actual number of sites: 847\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Actual number of sites: 847</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  J used for elicitation:"</span>, <span class="va">J_alabama</span>, <span class="st">"(package maximum)\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   J used for elicitation: 500 (package maximum)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Expected clusters (μ_K):"</span>, <span class="va">mu_K_alabama</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Expected clusters (μ_K): 50</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Ratio (μ_K/J):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">mu_K_alabama</span> <span class="op">/</span> <span class="va">J_alabama</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Ratio (μ_K/J): 0.1</span></span></code></pre></div>
<p><strong>Step 2: Prior elicitation</strong></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit using A2-MN method</span></span>
<span><span class="va">fit_alabama</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_fit.html">DPprior_fit</a></span><span class="op">(</span></span>
<span>  J <span class="op">=</span> <span class="va">J_alabama</span>, </span>
<span>  mu_K <span class="op">=</span> <span class="va">mu_K_alabama</span>, </span>
<span>  confidence <span class="op">=</span> <span class="st">"low"</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"A2-MN"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit_alabama</span><span class="op">)</span></span>
<span><span class="co">#&gt; DPprior Prior Elicitation Result</span></span>
<span><span class="co">#&gt; ============================================= </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Gamma Hyperprior: α ~ Gamma(a = 6.2200, b = 0.4431)</span></span>
<span><span class="co">#&gt;   E[α] = 14.038, SD[α] = 5.629</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Target (J = 500):</span></span>
<span><span class="co">#&gt;   E[K_J]   = 50.00</span></span>
<span><span class="co">#&gt;   Var(K_J) = 245.00</span></span>
<span><span class="co">#&gt;   (from confidence = 'low')</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Achieved:</span></span>
<span><span class="co">#&gt;   E[K_J] = 50.000000, Var(K_J) = 245.000000</span></span>
<span><span class="co">#&gt;   Residual = 2.84e-14</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Method: A2-MN (6 iterations)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Dominance Risk: LOW ✓ (P(w₁&gt;0.5) = 0%)</span></span></code></pre></div>
<p><strong>Step 3: Diagnostics</strong></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">diag_alabama</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_diagnostics.html">DPprior_diagnostics</a></span><span class="op">(</span><span class="va">fit_alabama</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Diagnostic Summary:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Diagnostic Summary:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"----------------\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; ----------------</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Alpha distribution:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Alpha distribution:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  E[α] ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_alabama</span><span class="op">$</span><span class="va">alpha</span><span class="op">$</span><span class="va">mean</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   E[α] = 14.038</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  SD(α) ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_alabama</span><span class="op">$</span><span class="va">alpha</span><span class="op">$</span><span class="va">sd</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   SD(α) = 5.629</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  95% CI: ["</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_alabama</span><span class="op">$</span><span class="va">alpha</span><span class="op">$</span><span class="va">quantiles</span><span class="op">[</span><span class="st">"q5"</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">", "</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_alabama</span><span class="op">$</span><span class="va">alpha</span><span class="op">$</span><span class="va">quantiles</span><span class="op">[</span><span class="st">"q95"</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"]\n"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="co">#&gt;   95% CI: [6.226, 24.392]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nCluster count:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Cluster count:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  E[K] ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_alabama</span><span class="op">$</span><span class="va">K</span><span class="op">$</span><span class="va">mean</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   E[K] = 50</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  SD(K) ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">diag_alabama</span><span class="op">$</span><span class="va">K</span><span class="op">$</span><span class="va">var</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   SD(K) = 15.65</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nWeight behavior:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Weight behavior:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  E[w₁] ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_alabama</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">mean</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   E[w₁] = 0.077</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  P(w₁ &gt; 0.5) ="</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_alabama</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">prob_exceeds</span><span class="op">[</span><span class="st">"prob_gt_0.5"</span><span class="op">]</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   P(w₁ &gt; 0.5) = 0.0029</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Dominance risk:"</span>, <span class="va">diag_alabama</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">dominance_risk</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Dominance risk: low</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="sensitivity-analysis-1">3.4 Sensitivity Analysis<a class="anchor" aria-label="anchor" href="#sensitivity-analysis-1"></a>
</h3>
<p>We examine how the elicited prior changes across different
specifications:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Sensitivity to μ_K</span></span>
<span><span class="va">mu_K_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">40</span>, <span class="fl">50</span>, <span class="fl">60</span>, <span class="fl">75</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sensitivity_alabama</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">mu_K_grid</span>, <span class="kw">function</span><span class="op">(</span><span class="va">mu</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_fit.html">DPprior_fit</a></span><span class="op">(</span>J <span class="op">=</span> <span class="va">J_alabama</span>, mu_K <span class="op">=</span> <span class="va">mu</span>, confidence <span class="op">=</span> <span class="st">"low"</span>, method <span class="op">=</span> <span class="st">"A2-MN"</span><span class="op">)</span></span>
<span>  <span class="va">diag</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_diagnostics.html">DPprior_diagnostics</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    mu_K <span class="op">=</span> <span class="va">mu</span>,</span>
<span>    ratio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">mu</span> <span class="op">/</span> <span class="va">J_alabama</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">a</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">b</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    E_K <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag</span><span class="op">$</span><span class="va">K</span><span class="op">$</span><span class="va">mean</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    P_dom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">prob_exceeds</span><span class="op">[</span><span class="st">"prob_gt_0.5"</span><span class="op">]</span>, <span class="fl">4</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sensitivity_alabama_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">sensitivity_alabama</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span></span>
<span>  <span class="va">sensitivity_alabama_df</span>,</span>
<span>  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Target μ_K"</span>, <span class="st">"μ_K/J"</span>, <span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"E[K]"</span>, <span class="st">"P(w₁ &gt; 0.5)"</span><span class="op">)</span>,</span>
<span>  caption <span class="op">=</span> <span class="st">"Sensitivity analysis for the Alabama Pre-K study (J = 500)"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Sensitivity analysis for the Alabama Pre-K study (J =
500)</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="right">Target μ_K</th>
<th align="right">μ_K/J</th>
<th align="right">a</th>
<th align="right">b</th>
<th align="right">E[K]</th>
<th align="right">P(w₁ &gt; 0.5)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">prob_gt_0.5</td>
<td align="right">30</td>
<td align="right">0.06</td>
<td align="right">4.171</td>
<td align="right">0.588</td>
<td align="right">30</td>
<td align="right">0.0388</td>
</tr>
<tr class="even">
<td align="left">prob_gt_0.51</td>
<td align="right">40</td>
<td align="right">0.08</td>
<td align="right">5.252</td>
<td align="right">0.506</td>
<td align="right">40</td>
<td align="right">0.0108</td>
</tr>
<tr class="odd">
<td align="left">prob_gt_0.52</td>
<td align="right">50</td>
<td align="right">0.10</td>
<td align="right">6.220</td>
<td align="right">0.443</td>
<td align="right">50</td>
<td align="right">0.0029</td>
</tr>
<tr class="even">
<td align="left">prob_gt_0.53</td>
<td align="right">60</td>
<td align="right">0.12</td>
<td align="right">7.087</td>
<td align="right">0.392</td>
<td align="right">60</td>
<td align="right">0.0007</td>
</tr>
<tr class="odd">
<td align="left">prob_gt_0.54</td>
<td align="right">75</td>
<td align="right">0.15</td>
<td align="right">8.215</td>
<td align="right">0.330</td>
<td align="right">75</td>
<td align="right">0.0001</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="visualizing-prior-behavior">3.5 Visualizing Prior Behavior<a class="anchor" aria-label="anchor" href="#visualizing-prior-behavior"></a>
</h3>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot alpha and K distributions side by side</span></span>
<span><span class="co"># Alpha distribution</span></span>
<span><span class="va">alpha_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">25</span>, length.out <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span>
<span><span class="va">alpha_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  alpha <span class="op">=</span> <span class="va">alpha_grid</span>,</span>
<span>  density <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></span><span class="op">(</span><span class="va">alpha_grid</span>, shape <span class="op">=</span> <span class="va">fit_alabama</span><span class="op">$</span><span class="va">a</span>, rate <span class="op">=</span> <span class="va">fit_alabama</span><span class="op">$</span><span class="va">b</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">alpha_df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">alpha</span>, y <span class="op">=</span> <span class="va">density</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"#377EB8"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">diag_alabama</span><span class="op">$</span><span class="va">alpha</span><span class="op">$</span><span class="va">mean</span>, </span>
<span>             linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"gray40"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="va">diag_alabama</span><span class="op">$</span><span class="va">alpha</span><span class="op">$</span><span class="va">mean</span> <span class="op">+</span> <span class="fl">1.5</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">alpha_df</span><span class="op">$</span><span class="va">density</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.9</span>,</span>
<span>           label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"E[α] = %.1f"</span>, <span class="va">diag_alabama</span><span class="op">$</span><span class="va">alpha</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span>,</span>
<span>           hjust <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"gray40"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Density"</span>,</span>
<span>    title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Prior on "</span> <span class="op">*</span> <span class="va">alpha</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># K distribution</span></span>
<span><span class="va">logS_al</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_log_stirling.html">compute_log_stirling</a></span><span class="op">(</span><span class="va">J_alabama</span><span class="op">)</span></span>
<span><span class="va">pmf_K</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pmf_K_marginal.html">pmf_K_marginal</a></span><span class="op">(</span><span class="va">J_alabama</span>, <span class="va">fit_alabama</span><span class="op">$</span><span class="va">a</span>, <span class="va">fit_alabama</span><span class="op">$</span><span class="va">b</span>, logS <span class="op">=</span> <span class="va">logS_al</span><span class="op">)</span></span>
<span><span class="va">k_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  K <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">pmf_K</span><span class="op">)</span>,</span>
<span>  probability <span class="op">=</span> <span class="va">pmf_K</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">k_df</span><span class="op">[</span><span class="va">k_df</span><span class="op">$</span><span class="va">K</span> <span class="op">&lt;=</span> <span class="fl">100</span> <span class="op">&amp;</span> <span class="va">k_df</span><span class="op">$</span><span class="va">probability</span> <span class="op">&gt;</span> <span class="fl">1e-4</span>, <span class="op">]</span>, </span>
<span>             <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">K</span>, y <span class="op">=</span> <span class="va">probability</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_col</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"#377EB8"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">diag_alabama</span><span class="op">$</span><span class="va">K</span><span class="op">$</span><span class="va">mean</span>, </span>
<span>             linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"gray40"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="va">diag_alabama</span><span class="op">$</span><span class="va">K</span><span class="op">$</span><span class="va">mean</span> <span class="op">+</span> <span class="fl">5</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">k_df</span><span class="op">$</span><span class="va">probability</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.9</span>,</span>
<span>           label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"E[K] = %.0f"</span>, <span class="va">diag_alabama</span><span class="op">$</span><span class="va">K</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span>,</span>
<span>           hjust <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"gray40"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">K</span><span class="op">[</span><span class="va">J</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Probability"</span>,</span>
<span>    title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Prior PMF of "</span> <span class="op">*</span> <span class="va">K</span><span class="op">[</span><span class="va">J</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="case-studies_files/figure-html/alabama-viz-1.png" class="r-plt" alt="Prior distributions for the Alabama Pre-K study (J = 500, μ_K = 50)." width="85%"><p class="caption">
Prior distributions for the Alabama Pre-K study (J = 500, μ_K = 50).
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="reporting-prior-elicitation-in-publications">4. Reporting Prior Elicitation in Publications<a class="anchor" aria-label="anchor" href="#reporting-prior-elicitation-in-publications"></a>
</h2>
<div class="section level3">
<h3 id="key-elements-to-report">4.1 Key Elements to Report<a class="anchor" aria-label="anchor" href="#key-elements-to-report"></a>
</h3>
<p>When reporting prior elicitation in a publication, include:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Study context</strong>: Number of units
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>J</mi><annotation encoding="application/x-tex">J</annotation></semantics></math>)
and their nature</li>
<li>
<strong>Substantive rationale</strong>: Why you expect a certain
number of clusters</li>
<li>
<strong>Uncertainty characterization</strong>: Confidence level or
variance specification</li>
<li>
<strong>Algorithm used</strong>: A1, A2-MN, or A2-KL</li>
<li>
<strong>Resulting hyperparameters</strong>: The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Gamma</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Gamma}(a, b)</annotation></semantics></math>
specification</li>
<li>
<strong>Diagnostic summary</strong>: Key quantities like
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>&gt;</mo><mn>0.5</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(w_1 &gt; 0.5)</annotation></semantics></math>
and dominance risk</li>
<li>
<strong>Sensitivity analysis</strong>: Results for alternative
specifications</li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>This vignette demonstrated how to apply the DPprior package across
three diverse research contexts:</p>
<table class="table">
<colgroup>
<col width="36%">
<col width="9%">
<col width="15%">
<col width="39%">
</colgroup>
<thead><tr class="header">
<th>Case Study</th>
<th>J</th>
<th>μ_K</th>
<th>Key Insight</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>CCT Multisite Trial</td>
<td>38</td>
<td>5</td>
<td>Dual-anchor refinement essential for low-information settings</td>
</tr>
<tr class="even">
<td>BAI Meta-Analysis</td>
<td>117</td>
<td>18</td>
<td>Multiple heterogeneity sources suggest more clusters</td>
</tr>
<tr class="odd">
<td>Alabama Pre-K VAM</td>
<td>500</td>
<td>50</td>
<td>Large-scale applications work within package limits</td>
</tr>
</tbody>
</table>
<p><strong>Key Takeaways:</strong></p>
<ol style="list-style-type: decimal">
<li><p><strong>Context matters</strong>: The appropriate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mi>K</mi></msub><annotation encoding="application/x-tex">\mu_K</annotation></semantics></math>
depends on substantive domain knowledge about heterogeneity
sources</p></li>
<li><p><strong>Diagnostics are essential</strong>: Always verify weight
behavior, not just cluster counts</p></li>
<li><p><strong>Dual-anchor refinement</strong>: When dominance risk is
high, use <code><a href="../reference/DPprior_dual.html">DPprior_dual()</a></code> to control weight
behavior</p></li>
<li><p><strong>Sensitivity analysis is mandatory</strong>: Report
results across plausible alternative specifications</p></li>
<li><p><strong>Transparent reporting</strong>: Document the complete
elicitation process in publications</p></li>
</ol>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Barrera-Osorio, F., Linden, L. L., &amp; Saavedra, J. E. (2019).
Medium- and long-term educational consequences of alternative
conditional cash transfer designs: Experimental evidence from Colombia.
<em>American Economic Journal: Applied Economics</em>, 11(3), 54–91. <a href="https://doi.org/10.1257/app.20170008" class="external-link uri">https://doi.org/10.1257/app.20170008</a></p>
<p>Lee, J., Che, J., Rabe-Hesketh, S., Feller, A., &amp; Miratrix, L.
(2025). Improving the estimation of site-specific effects and their
distribution in multisite trials. <em>Journal of Educational and
Behavioral Statistics</em>, 50(5), 731–764. <a href="https://doi.org/10.3102/10769986241254286" class="external-link uri">https://doi.org/10.3102/10769986241254286</a></p>
<p>Pustejovsky, J. E., &amp; Tipton, E. (2022). Meta-analysis with
robust variance estimation: Expanding the range of working models.
<em>Prevention Science</em>, 23(3), 425–438. <a href="https://doi.org/10.1007/s11121-021-01246-3" class="external-link uri">https://doi.org/10.1007/s11121-021-01246-3</a></p>
<p>Tanner-Smith, E. E., &amp; Lipsey, M. W. (2015). Brief alcohol
interventions for adolescents and young adults: A systematic review and
meta-analysis. <em>Journal of Substance Abuse Treatment</em>, 51, 1–18.
<a href="https://doi.org/10.1016/j.jsat.2014.09.001" class="external-link uri">https://doi.org/10.1016/j.jsat.2014.09.001</a></p>
<hr>
<p><em>For questions or feedback, please visit the <a href="https://github.com/joonho112/DPprior" class="external-link">GitHub
repository</a>.</em></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/joonho112" class="external-link">JoonHo Lee</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
