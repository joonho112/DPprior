<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Weight Distributions: w‚ÇÅ, œÅ, and the Dual-Anchor Framework ‚Ä¢ DPprior</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="‚Äùimage/svg+xml‚Äù" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Weight Distributions: w‚ÇÅ, œÅ, and the Dual-Anchor Framework">
<meta name="description" content="A comprehensive treatment of stick-breaking weight distributions under Gamma  hyperpriors, the I_c functional for closed-form moments, and the mathematical  foundations of dual-anchor elicitation.
">
<meta property="og:description" content="A comprehensive treatment of stick-breaking weight distributions under Gamma  hyperpriors, the I_c functional for closed-form moments, and the mathematical  foundations of dual-anchor elicitation.
">
<meta property="og:image" content="https://joonho112.github.io/DPprior/logo.svg">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DPprior</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><h6 class="dropdown-header" data-toc-skip>--- Applied Track ---</h6></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/quick-start.html">Quick Start</a></li>
    <li><a class="dropdown-item" href="../articles/applied-guide.html">Applied Guide</a></li>
    <li><a class="dropdown-item" href="../articles/dual-anchor.html">Dual-Anchor Framework</a></li>
    <li><a class="dropdown-item" href="../articles/diagnostics.html">Diagnostics</a></li>
    <li><a class="dropdown-item" href="../articles/case-studies.html">Case Studies</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>--- Methodological Track ---</h6></li>
    <li><a class="dropdown-item" href="../articles/theory-overview.html">Theory Overview</a></li>
    <li><a class="dropdown-item" href="../articles/theory-stirling.html">Stirling Numbers</a></li>
    <li><a class="dropdown-item" href="../articles/theory-approximations.html">Approximations (A1)</a></li>
    <li><a class="dropdown-item" href="../articles/theory-newton.html">Newton Algorithm (A2)</a></li>
    <li><a class="dropdown-item" href="../articles/theory-weights.html">Weight Distributions</a></li>
    <li><a class="dropdown-item" href="../articles/api-reference.html">API Reference</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/joonho112/DPprior/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Weight Distributions: w‚ÇÅ, œÅ, and the Dual-Anchor Framework</h1>
                        <h4 data-toc-skip class="author">JoonHo Lee</h4>
            
            <h4 data-toc-skip class="date">2026-02-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/joonho112/DPprior/blob/main/vignettes/theory-weights.Rmd" class="external-link"><code>vignettes/theory-weights.Rmd</code></a></small>
      <div class="d-none name"><code>theory-weights.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This vignette provides a rigorous treatment of the stick-breaking
weight distributions in Dirichlet Process (DP) models and their role in
the dual-anchor elicitation framework. It is intended for statisticians
and methodological researchers who wish to understand:</p>
<ol style="list-style-type: decimal">
<li>The distributional properties of the first stick-breaking weight
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math>
</li>
<li>The co-clustering probability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œÅ</mi><mo>=</mo><msub><mo>‚àë</mo><mi>h</mi></msub><msubsup><mi>w</mi><mi>h</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\rho = \sum_h w_h^2</annotation></semantics></math>
and its interpretation</li>
<li>The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>I</mi><mi>c</mi></msub><annotation encoding="application/x-tex">I_c</annotation></semantics></math>
functional for computing closed-form moments under Gamma
hyperpriors</li>
<li>The mathematical foundation of dual-anchor optimization</li>
</ol>
<p>Throughout, we carefully distinguish between <strong>established
results</strong> from the Bayesian nonparametrics literature and
<strong>novel contributions</strong> of this work (the DPprior package
and associated research notes).</p>
<div class="section level3">
<h3 id="attribution-summary">Attribution Summary<a class="anchor" aria-label="anchor" href="#attribution-summary"></a>
</h3>
<table class="table">
<colgroup>
<col width="38%">
<col width="61%">
</colgroup>
<thead><tr class="header">
<th>Result</th>
<th>Attribution</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Stick-breaking construction</td>
<td>Sethuraman (1994)</td>
</tr>
<tr class="even">
<td>GEM distribution / size-biased ordering</td>
<td>Kingman (1975), Pitman (1996), Arratia et al.¬†(2003)</td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>œÅ</mi><mo>‚à£</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mn>1</mn><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}[\rho \mid \alpha] = 1/(1+\alpha)</annotation></semantics></math></td>
<td>Kingman (1975), Pitman (1996)</td>
</tr>
<tr class="even">
<td>Closed-form
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math>
distribution under Gamma prior</td>
<td>Vicentini &amp; Jermyn (2025)</td>
</tr>
<tr class="odd">
<td>Dual-anchor framework and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>I</mi><mi>c</mi></msub><annotation encoding="application/x-tex">I_c</annotation></semantics></math>
functional formulas</td>
<td>This work (DPprior package)</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="stick-breaking-weights-review-and-interpretation">1. Stick-Breaking Weights: Review and Interpretation<a class="anchor" aria-label="anchor" href="#stick-breaking-weights-review-and-interpretation"></a>
</h2>
<div class="section level3">
<h3 id="the-gemalpha-construction">1.1 The
GEM(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ±</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>)
Construction<a class="anchor" aria-label="anchor" href="#the-gemalpha-construction"></a>
</h3>
<p>Under Sethuraman‚Äôs (1994) stick-breaking representation of the DP, a
random probability measure
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo>‚àº</mo><mtext mathvariant="normal">DP</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo>,</mo><msub><mi>G</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">G \sim \text{DP}(\alpha, G_0)</annotation></semantics></math>
can be written as:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo>=</mo><munderover><mo>‚àë</mo><mrow><mi>h</mi><mo>=</mo><mn>1</mn></mrow><mo accent="false">‚àû</mo></munderover><msub><mi>w</mi><mi>h</mi></msub><mspace width="0.167em"></mspace><msub><mi>Œ¥</mi><msub><mi>Œ∏</mi><mi>h</mi></msub></msub><mo>,</mo></mrow><annotation encoding="application/x-tex">
G = \sum_{h=1}^{\infty} w_h \, \delta_{\theta_h},
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><msub><mi>Œ∏</mi><mi>h</mi></msub><msubsup><mo stretchy="false" form="postfix">}</mo><mrow><mi>h</mi><mo>=</mo><mn>1</mn></mrow><mi>‚àû</mi></msubsup><mover><mo>‚àº</mo><mrow><mi>i</mi><mi>i</mi><mi>d</mi></mrow></mover><msub><mi>G</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\{\theta_h\}_{h=1}^{\infty} \stackrel{iid}{\sim} G_0</annotation></semantics></math>
are the atom locations and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><msub><mi>w</mi><mi>h</mi></msub><msubsup><mo stretchy="false" form="postfix">}</mo><mrow><mi>h</mi><mo>=</mo><mn>1</mn></mrow><mi>‚àû</mi></msubsup></mrow><annotation encoding="application/x-tex">\{w_h\}_{h=1}^{\infty}</annotation></semantics></math>
are the stick-breaking weights constructed as:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>h</mi></msub><mover><mo>‚àº</mo><mrow><mi>i</mi><mi>i</mi><mi>d</mi></mrow></mover><mtext mathvariant="normal">Beta</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="1.0em"></mspace><msub><mi>w</mi><mn>1</mn></msub><mo>=</mo><msub><mi>v</mi><mn>1</mn></msub><mo>,</mo><mspace width="1.0em"></mspace><msub><mi>w</mi><mi>h</mi></msub><mo>=</mo><msub><mi>v</mi><mi>h</mi></msub><munder><mo>‚àè</mo><mrow><mo>‚Ñì</mo><mo>&lt;</mo><mi>h</mi></mrow></munder><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><msub><mi>v</mi><mo>‚Ñì</mo></msub><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="1.0em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mi>h</mi><mo>‚â•</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
v_h \stackrel{iid}{\sim} \text{Beta}(1, \alpha), \quad 
w_1 = v_1, \quad 
w_h = v_h \prod_{\ell &lt; h}(1 - v_\ell) \quad (h \geq 2).
</annotation></semantics></math></p>
<p>The sequence
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>,</mo><msub><mi>w</mi><mn>2</mn></msub><mo>,</mo><mi>‚Ä¶</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(w_1, w_2, \ldots)</annotation></semantics></math>
follows the
<strong>GEM(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ±</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>)
distribution</strong> (Griffiths-Engen-McCloskey), which represents a
size-biased random permutation of the Poisson-Dirichlet distribution
(Pitman, 1996).</p>
</div>
<div class="section level3">
<h3 id="critical-interpretability-caveat">1.2 Critical Interpretability Caveat<a class="anchor" aria-label="anchor" href="#critical-interpretability-caveat"></a>
</h3>
<blockquote>
<p><strong>The GEM order is size-biased, NOT decreasing.</strong></p>
</blockquote>
<p>This distinction is essential for applied elicitation.
Specifically:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>,</mo><msub><mi>w</mi><mn>2</mn></msub><mo>,</mo><mi>‚Ä¶</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚â†</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msub><mo>,</mo><msub><mi>w</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow></msub><mo>,</mo><mi>‚Ä¶</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">(w_1, w_2, \ldots) \neq (w_{(1)}, w_{(2)}, \ldots)</annotation></semantics></math>
where the latter denotes the ranked (decreasing) weights</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math>
is <strong>not</strong> ‚Äúthe largest cluster proportion‚Äù</li>
<li>A faithful interpretation:
<strong><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math>
is the asymptotic proportion of the cluster containing a randomly
selected unit</strong> (equivalently, a size-biased pick from the
Poisson-Dirichlet distribution)</li>
</ul>
<p>Despite this caveat,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math>
remains a meaningful diagnostic for ‚Äúdominance risk.‚Äù If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>&gt;</mo><mn>0.5</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(w_1 &gt; 0.5)</annotation></semantics></math>
is high, then a randomly selected unit is likely to belong to a cluster
that contains more than half of the population.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Demonstrate the stick-breaking construction</span></span>
<span><span class="va">n_atoms</span> <span class="op">&lt;-</span> <span class="fl">15</span></span>
<span><span class="va">alpha_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">sb_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">alpha_values</span>, <span class="kw">function</span><span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="va">n_atoms</span>, <span class="fl">1</span>, <span class="va">a</span><span class="op">)</span></span>
<span>  <span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">n_atoms</span><span class="op">)</span></span>
<span>  <span class="va">w</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">v</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">h</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="va">n_atoms</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">w</span><span class="op">[</span><span class="va">h</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">v</span><span class="op">[</span><span class="va">h</span><span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/prod.html" class="external-link">prod</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">v</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">h</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    atom <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_atoms</span>,</span>
<span>    weight <span class="op">=</span> <span class="va">w</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Œ± = "</span>, <span class="va">a</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sb_data</span><span class="op">$</span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">sb_data</span><span class="op">$</span><span class="va">alpha</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Œ± = "</span>, <span class="va">alpha_values</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">sb_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">atom</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">weight</span>, fill <span class="op">=</span> <span class="va">alpha</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">alpha</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="va">palette_main</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Atom Index (h)"</span>, </span>
<span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">w</span><span class="op">[</span><span class="va">h</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Stick-Breaking Weights in GEM Order"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Single realization per Œ±; NOT ranked by size"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="theory-weights_files/figure-html/gem-demo-1.png" class="r-plt" alt="Stick-breaking weights for different Œ± values. Smaller Œ± concentrates mass on early atoms." width="85%"><p class="caption">
Stick-breaking weights for different Œ± values. Smaller Œ± concentrates
mass on early atoms.
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="distribution-of-w_1">2. Distribution of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#distribution-of-w_1"></a>
</h2>
<div class="section level3">
<h3 id="conditional-distribution">2.1 Conditional Distribution<a class="anchor" aria-label="anchor" href="#conditional-distribution"></a>
</h3>
<p>The first stick-breaking weight has a particularly simple conditional
distribution, following directly from the construction.</p>
<p><strong>Proposition 1</strong> (Conditional distribution of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math>).
<em>For
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ±</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\alpha &gt; 0</annotation></semantics></math>:</em>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>1</mn></msub><mo>‚à£</mo><mi>Œ±</mi><mo>‚àº</mo><mtext mathvariant="normal">Beta</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
w_1 \mid \alpha \sim \text{Beta}(1, \alpha).
</annotation></semantics></math></p>
<p><em>Consequently:</em></p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>w</mi><mn>1</mn></msub><mo>‚à£</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mi>Œ±</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\mathbb{E}[w_1 \mid \alpha] = \frac{1}{1 + \alpha}</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>‚à£</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mi>Œ±</mi><mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mo>+</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">\text{Var}(w_1 \mid \alpha) = \frac{\alpha}{(1+\alpha)^2(2+\alpha)}</annotation></semantics></math></li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>‚â§</mo><mi>x</mi><mo>‚à£</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mo>‚àí</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>Œ±</mi></msup></mrow><annotation encoding="application/x-tex">P(w_1 \leq x \mid \alpha) = 1 - (1-x)^{\alpha}</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>‚àà</mo><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">x \in [0, 1]</annotation></semantics></math>
</li>
</ul>
<p><strong>Attribution:</strong> This follows immediately from the
stick-breaking construction (Sethuraman, 1994).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.001</span>, <span class="fl">0.999</span>, length.out <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">alpha_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cond_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">alpha_grid</span>, <span class="kw">function</span><span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">x_grid</span>,</span>
<span>    density <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta</a></span><span class="op">(</span><span class="va">x_grid</span>, <span class="fl">1</span>, <span class="va">a</span><span class="op">)</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Œ± = "</span>, <span class="va">a</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cond_df</span><span class="op">$</span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">cond_df</span><span class="op">$</span><span class="va">alpha</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Œ± = "</span>, <span class="va">alpha_grid</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">cond_df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">density</span>, color <span class="op">=</span> <span class="va">alpha</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_viridis_d</span><span class="op">(</span>option <span class="op">=</span> <span class="st">"plasma"</span>, end <span class="op">=</span> <span class="fl">0.85</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">w</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Density"</span>,</span>
<span>    title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Conditional Density: "</span> <span class="op">*</span> <span class="va">w</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="st">" | "</span> <span class="op">*</span> <span class="va">alpha</span> <span class="op">*</span> <span class="st">" ~ Beta(1, "</span> <span class="op">*</span> <span class="va">alpha</span> <span class="op">*</span> <span class="st">")"</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="theory-weights_files/figure-html/conditional-w1-1.png" class="r-plt" alt="Conditional density of w‚ÇÅ|Œ± for different concentration parameter values." width="85%"><p class="caption">
Conditional density of w‚ÇÅ|Œ± for different concentration parameter
values.
</p>
</div>
</div>
<div class="section level3">
<h3 id="marginal-distribution-under-gamma-hyperprior">2.2 Marginal Distribution Under Gamma Hyperprior<a class="anchor" aria-label="anchor" href="#marginal-distribution-under-gamma-hyperprior"></a>
</h3>
<p>When
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ±</mi><mo>‚àº</mo><mtext mathvariant="normal">Gamma</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\alpha \sim \text{Gamma}(a, b)</annotation></semantics></math>
with shape
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">a &gt; 0</annotation></semantics></math>
and rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">b &gt; 0</annotation></semantics></math>,
the unconditional distribution of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math>
admits <strong>fully closed-form</strong> expressions.</p>
<p><strong>Theorem 1</strong> (Unconditional distribution of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math>;
Vicentini &amp; Jermyn, 2025, Appendix A). <em>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ±</mi><mo>‚àº</mo><mtext mathvariant="normal">Gamma</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\alpha \sim \text{Gamma}(a, b)</annotation></semantics></math>.
Then:</em></p>
<p><strong>Density:</strong>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>‚à£</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mi>a</mi><mspace width="0.167em"></mspace><msup><mi>b</mi><mi>a</mi></msup></mrow><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><msub><mi>w</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><msup><mrow><mo stretchy="true" form="prefix">[</mo><mi>b</mi><mo>‚àí</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><msub><mi>w</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mrow><mi>a</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow></mfrac><mo>,</mo><mspace width="1.0em"></mspace><msub><mi>w</mi><mn>1</mn></msub><mo>‚àà</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
p(w_1 \mid a, b) = \frac{a \, b^a}{(1 - w_1)[b - \log(1-w_1)]^{a+1}}, \quad w_1 \in (0, 1).
</annotation></semantics></math></p>
<p><strong>CDF:</strong>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><msub><mi>w</mi><mn>1</mn></msub></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>‚à£</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>‚â§</mo><mi>x</mi><mo>‚à£</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mo>‚àí</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mi>b</mi><mrow><mi>b</mi><mo>‚àí</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>a</mi></msup><mi>.</mi></mrow><annotation encoding="application/x-tex">
F_{w_1}(x \mid a, b) = P(w_1 \leq x \mid a, b) = 1 - \left(\frac{b}{b - \log(1-x)}\right)^a.
</annotation></semantics></math></p>
<p><strong>Survival function (dominance risk):</strong>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>&gt;</mo><mi>t</mi><mo>‚à£</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mi>b</mi><mrow><mi>b</mi><mo>‚àí</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>a</mi></msup><mi>.</mi></mrow><annotation encoding="application/x-tex">
P(w_1 &gt; t \mid a, b) = \left(\frac{b}{b - \log(1-t)}\right)^a.
</annotation></semantics></math></p>
<p><strong>Quantile function:</strong>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Q</mi><msub><mi>w</mi><mn>1</mn></msub></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo>‚à£</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mo>‚àí</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mrow><mo stretchy="true" form="prefix">[</mo><mn>1</mn><mo>‚àí</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>‚àí</mo><mn>1</mn><mi>/</mi><mi>a</mi></mrow></msup><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
Q_{w_1}(u \mid a, b) = 1 - \exp\left(b\left[1 - (1-u)^{-1/a}\right]\right).
</annotation></semantics></math></p>
<p><strong>Proof sketch.</strong> Integrate out
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ±</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
from the conditional distribution:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>‚à£</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msubsup><mo>‚à´</mo><mn>0</mn><mi>‚àû</mi></msubsup><mi>Œ±</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><msub><mi>w</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>Œ±</mi><mo>‚àí</mo><mn>1</mn></mrow></msup><mo>‚ãÖ</mo><mfrac><msup><mi>b</mi><mi>a</mi></msup><mrow><mi>Œì</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><msup><mi>Œ±</mi><mrow><mi>a</mi><mo>‚àí</mo><mn>1</mn></mrow></msup><msup><mi>e</mi><mrow><mo>‚àí</mo><mi>b</mi><mi>Œ±</mi></mrow></msup><mspace width="0.167em"></mspace><mi>d</mi><mi>Œ±</mi><mi>.</mi></mrow><annotation encoding="application/x-tex">
p(w_1 \mid a, b) = \int_0^\infty \alpha (1-w_1)^{\alpha-1} \cdot 
\frac{b^a}{\Gamma(a)} \alpha^{a-1} e^{-b\alpha} \, d\alpha.
</annotation></semantics></math> The integral evaluates to a Gamma
function, and the CDF follows by direct integration with substitution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo>=</mo><mi>b</mi><mo>‚àí</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">u = b - \log(1-w)</annotation></semantics></math>.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>‚ñ´</mi><annotation encoding="application/x-tex">\square</annotation></semantics></math></p>
<p><strong>Computational significance.</strong> These closed-form
expressions enable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math>
computation of quantiles and tail probabilities‚Äîno Monte Carlo sampling
is required.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Demonstrate the closed-form w1 distribution functions</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">1.6</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">1.22</span>  <span class="co"># The Lee et al. DP-inform prior</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"w‚ÇÅ distribution under Gamma(a=1.6, b=1.22) hyperprior:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; w‚ÇÅ distribution under Gamma(a=1.6, b=1.22) hyperprior:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  Mean:     %.4f\n"</span>, <span class="fu"><a href="../reference/mean_w1.html">mean_w1</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Mean:     0.5084</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  Variance: %.4f\n"</span>, <span class="fu"><a href="../reference/var_w1.html">var_w1</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Variance: 0.1052</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  Median:   %.4f\n"</span>, <span class="fu"><a href="../reference/quantile_w1.html">quantile_w1</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="va">a</span>, <span class="va">b</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Median:   0.4839</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  90th %%:   %.4f\n"</span>, <span class="fu"><a href="../reference/quantile_w1.html">quantile_w1</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="va">a</span>, <span class="va">b</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   90th %:   0.9803</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nDominance risk (tail probabilities):\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Dominance risk (tail probabilities):</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">t</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  P(w‚ÇÅ &gt; %.1f) = %.4f\n"</span>, <span class="va">t</span>, <span class="fu"><a href="../reference/prob_w1_exceeds.html">prob_w1_exceeds</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">a</span>, <span class="va">b</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt;   P(w‚ÇÅ &gt; 0.3) = 0.6634</span></span>
<span><span class="co">#&gt;   P(w‚ÇÅ &gt; 0.5) = 0.4868</span></span>
<span><span class="co">#&gt;   P(w‚ÇÅ &gt; 0.7) = 0.3334</span></span>
<span><span class="co">#&gt;   P(w‚ÇÅ &gt; 0.9) = 0.1833</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualization-of-the-marginal-distribution">2.3 Visualization of the Marginal Distribution<a class="anchor" aria-label="anchor" href="#visualization-of-the-marginal-distribution"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Visualize the marginal w1 distribution</span></span>
<span><span class="va">x_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.99</span>, length.out <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">1.6</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">1.22</span></span>
<span></span>
<span><span class="co"># Compute density manually using the closed-form formula</span></span>
<span><span class="co"># p(w1 | a, b) = a * b^a / ((1-w1) * (b - log(1-w1))^(a+1))</span></span>
<span><span class="va">density_w1_manual</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">a</span>, <span class="va">b</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">denom</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">x</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">b</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="va">a</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">a</span> <span class="op">*</span> <span class="va">b</span><span class="op">^</span><span class="va">a</span> <span class="op">/</span> <span class="va">denom</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">w1_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">x_grid</span>,</span>
<span>  density <span class="op">=</span> <span class="fu">density_w1_manual</span><span class="op">(</span><span class="va">x_grid</span>, <span class="va">a</span>, <span class="va">b</span><span class="op">)</span>,</span>
<span>  cdf <span class="op">=</span> <span class="fu"><a href="../reference/cdf_w1.html">cdf_w1</a></span><span class="op">(</span><span class="va">x_grid</span>, <span class="va">a</span>, <span class="va">b</span><span class="op">)</span>,</span>
<span>  survival <span class="op">=</span> <span class="fu"><a href="../reference/prob_w1_exceeds.html">prob_w1_exceeds</a></span><span class="op">(</span><span class="va">x_grid</span>, <span class="va">a</span>, <span class="va">b</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">w1_df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">density</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"#E41A1C"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="../reference/quantile_w1.html">quantile_w1</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="va">a</span>, <span class="va">b</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, </span>
<span>             color <span class="op">=</span> <span class="st">"#377EB8"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fu"><a href="../reference/quantile_w1.html">quantile_w1</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="va">a</span>, <span class="va">b</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.05</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">w1_df</span><span class="op">$</span><span class="va">density</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.9</span>,</span>
<span>           label <span class="op">=</span> <span class="st">"Median"</span>, color <span class="op">=</span> <span class="st">"#377EB8"</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">w</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, y <span class="op">=</span> <span class="st">"Density"</span>,</span>
<span>       title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Marginal Density of "</span> <span class="op">*</span> <span class="va">w</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="st">" | Gamma(1.6, 1.22)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">w1_df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">cdf</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"#377EB8"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">survival</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"#E41A1C"</span>, linewidth <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0.5</span>, linetype <span class="op">=</span> <span class="st">"dotted"</span>, color <span class="op">=</span> <span class="st">"gray50"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">0.9</span>, y <span class="op">=</span> <span class="fl">0.85</span>, label <span class="op">=</span> <span class="st">"CDF"</span>, color <span class="op">=</span> <span class="st">"#377EB8"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">0.9</span>, y <span class="op">=</span> <span class="fl">0.35</span>, label <span class="op">=</span> <span class="st">"P(w1 &gt; x)"</span>, color <span class="op">=</span> <span class="st">"#E41A1C"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">w</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, y <span class="op">=</span> <span class="st">"Probability"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"CDF and Survival Function"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="theory-weights_files/figure-html/marginal-w1-viz-1.png" class="r-plt" alt="Marginal density and CDF of w‚ÇÅ under the Gamma(1.6, 1.22) hyperprior." width="85%"><p class="caption">
Marginal density and CDF of w‚ÇÅ under the Gamma(1.6, 1.22) hyperprior.
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="the-co-clustering-probability-rho">3. The Co-Clustering Probability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÅ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#the-co-clustering-probability-rho"></a>
</h2>
<div class="section level3">
<h3 id="definition-and-interpretation">3.1 Definition and Interpretation<a class="anchor" aria-label="anchor" href="#definition-and-interpretation"></a>
</h3>
<p>The co-clustering probability provides an alternative, often more
intuitive, anchor for weight-based elicitation.</p>
<p><strong>Definition 1</strong> (Co-clustering probability / Simpson
index).
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œÅ</mi><mo>:=</mo><munderover><mo>‚àë</mo><mrow><mi>h</mi><mo>=</mo><mn>1</mn></mrow><mo accent="false">‚àû</mo></munderover><msubsup><mi>w</mi><mi>h</mi><mn>2</mn></msubsup><mo>‚àà</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
\rho := \sum_{h=1}^{\infty} w_h^2 \in (0, 1).
</annotation></semantics></math></p>
<p><strong>Interpretation.</strong> Conditional on the random measure
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>,
if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mn>1</mn></msub><mo>,</mo><msub><mi>Z</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">Z_1, Z_2</annotation></semantics></math>
are i.i.d. cluster labels with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo>=</mo><mi>k</mi><mo>‚à£</mo><mi>G</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>w</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">P(Z = k \mid G) = w_k</annotation></semantics></math>,
then:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Z</mi><mn>1</mn></msub><mo>=</mo><msub><mi>Z</mi><mn>2</mn></msub><mo>‚à£</mo><mi>G</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munder><mo>‚àë</mo><mrow><mi>k</mi><mo>‚â•</mo><mn>1</mn></mrow></munder><msubsup><mi>w</mi><mi>k</mi><mn>2</mn></msubsup><mo>=</mo><mi>œÅ</mi><mi>.</mi></mrow><annotation encoding="application/x-tex">
P(Z_1 = Z_2 \mid G) = \sum_{k \geq 1} w_k^2 = \rho.
</annotation></semantics></math></p>
<p>Thus
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÅ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
is the <strong>probability that two randomly chosen units belong to the
same latent cluster</strong>. This quantity translates directly to
applied elicitation:</p>
<blockquote>
<p>‚ÄúBefore seeing data, what is the probability that two randomly
selected sites from your study belong to the same effect group?‚Äù</p>
</blockquote>
</div>
<div class="section level3">
<h3 id="conditional-moments-of-rho">3.2 Conditional Moments of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÅ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#conditional-moments-of-rho"></a>
</h3>
<p><strong>Proposition 2</strong> (Conditional expectation of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÅ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>;
Kingman, 1975; Pitman, 1996).
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>œÅ</mi><mo>‚à£</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mi>Œ±</mi></mrow></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">
\mathbb{E}[\rho \mid \alpha] = \frac{1}{1 + \alpha}.
</annotation></semantics></math></p>
<p><strong>Proof.</strong> Using the stick-breaking construction:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msubsup><mi>w</mi><mi>k</mi><mn>2</mn></msubsup><mo>‚à£</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msubsup><mi>v</mi><mi>k</mi><mn>2</mn></msubsup><mo stretchy="true" form="postfix">]</mo></mrow><mo>‚ãÖ</mo><munder><mo>‚àè</mo><mrow><mo>‚Ñì</mo><mo>&lt;</mo><mi>k</mi></mrow></munder><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><msub><mi>v</mi><mo>‚Ñì</mo></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">]</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
\mathbb{E}[w_k^2 \mid \alpha] = \mathbb{E}[v_k^2] \cdot \prod_{\ell &lt; k} \mathbb{E}[(1-v_\ell)^2].
</annotation></semantics></math></p>
<p>For
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>‚àº</mo><mtext mathvariant="normal">Beta</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">v \sim \text{Beta}(1, \alpha)</annotation></semantics></math>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msup><mi>v</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mfrac><mn>2</mn><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mo>+</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>,</mo><mspace width="1.0em"></mspace><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mfrac><mi>Œ±</mi><mrow><mn>2</mn><mo>+</mo><mi>Œ±</mi></mrow></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">
\mathbb{E}[v^2] = \frac{2}{(1+\alpha)(2+\alpha)}, \quad 
\mathbb{E}[(1-v)^2] = \frac{\alpha}{2+\alpha}.
</annotation></semantics></math></p>
<p>Summing the geometric series:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>œÅ</mi><mo>‚à£</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><munderover><mo>‚àë</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mo accent="false">‚àû</mo></munderover><mfrac><mn>2</mn><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mo>+</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mi>Œ±</mi><mrow><mn>2</mn><mo>+</mo><mi>Œ±</mi></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>k</mi><mo>‚àí</mo><mn>1</mn></mrow></msup><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mi>Œ±</mi></mrow></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">
\mathbb{E}[\rho \mid \alpha] = \sum_{k=1}^\infty \frac{2}{(1+\alpha)(2+\alpha)} 
\left(\frac{\alpha}{2+\alpha}\right)^{k-1} = \frac{1}{1+\alpha}.
</annotation></semantics></math><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>‚ñ´</mi><annotation encoding="application/x-tex">\square</annotation></semantics></math></p>
<p><strong>Corollary 1</strong> (Key identity). <em>The conditional
expectations of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÅ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
are equal:</em>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>w</mi><mn>1</mn></msub><mo>‚à£</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>œÅ</mi><mo>‚à£</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mi>Œ±</mi></mrow></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">
\mathbb{E}[w_1 \mid \alpha] = \mathbb{E}[\rho \mid \alpha] = \frac{1}{1+\alpha}.
</annotation></semantics></math></p>
<p>This identity is not coincidental‚Äîboth quantities measure the
‚Äúconcentration‚Äù of the random measure
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>.</p>
<p><strong>Proposition 3</strong> (Conditional variance of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÅ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>).
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msup><mi>œÅ</mi><mn>2</mn></msup><mo>‚à£</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mfrac><mrow><mi>Œ±</mi><mo>+</mo><mn>6</mn></mrow><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo>+</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo>+</mo><mn>3</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>,</mo></mrow><annotation encoding="application/x-tex">
\mathbb{E}[\rho^2 \mid \alpha] = \frac{\alpha + 6}{(\alpha+1)(\alpha+2)(\alpha+3)},
</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>œÅ</mi><mo>‚à£</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mn>2</mn><mi>Œ±</mi></mrow><mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo>+</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo>+</mo><mn>3</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">
\text{Var}(\rho \mid \alpha) = \frac{2\alpha}{(\alpha+1)^2(\alpha+2)(\alpha+3)}.
</annotation></semantics></math></p>
<p><strong>Proof.</strong> Using the distributional recursion
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œÅ</mi><mover><mo>=</mo><mi>d</mi></mover><msup><mi>v</mi><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mi>œÅ</mi><mi>‚Ä≤</mi></mrow><annotation encoding="application/x-tex">\rho \stackrel{d}{=} v^2 + (1-v)^2 \rho'</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>‚àº</mo><mtext mathvariant="normal">Beta</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">v \sim \text{Beta}(1, \alpha)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œÅ</mi><mi>‚Ä≤</mi></mrow><annotation encoding="application/x-tex">\rho'</annotation></semantics></math>
is an independent copy of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÅ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>.
Squaring and taking expectations yields the result. See Appendix A of
the associated research notes for the full derivation.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>‚ñ´</mi><annotation encoding="application/x-tex">\square</annotation></semantics></math></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alpha_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">20</span>, length.out <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rho_cond_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  alpha <span class="op">=</span> <span class="va">alpha_grid</span>,</span>
<span>  mean <span class="op">=</span> <span class="fu"><a href="../reference/mean_rho_given_alpha.html">mean_rho_given_alpha</a></span><span class="op">(</span><span class="va">alpha_grid</span><span class="op">)</span>,</span>
<span>  var <span class="op">=</span> <span class="fu"><a href="../reference/var_rho_given_alpha.html">var_rho_given_alpha</a></span><span class="op">(</span><span class="va">alpha_grid</span><span class="op">)</span>,</span>
<span>  sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="../reference/var_rho_given_alpha.html">var_rho_given_alpha</a></span><span class="op">(</span><span class="va">alpha_grid</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">rho_cond_df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">alpha</span>, y <span class="op">=</span> <span class="va">mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"#E41A1C"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_ribbon</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">mean</span> <span class="op">-</span> <span class="fl">2</span><span class="op">*</span><span class="va">sd</span><span class="op">)</span>, ymax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">mean</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="va">sd</span><span class="op">)</span><span class="op">)</span>, </span>
<span>              alpha <span class="op">=</span> <span class="fl">0.2</span>, fill <span class="op">=</span> <span class="st">"#E41A1C"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">rho</span><span class="op">)</span>,</span>
<span>       title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">E</span><span class="op">*</span><span class="st">"["</span><span class="op">*</span><span class="va">rho</span><span class="op">*</span><span class="st">" | "</span><span class="op">*</span><span class="va">alpha</span><span class="op">*</span><span class="st">"]"</span> <span class="op">*</span> <span class="st">" ¬± 2 SD"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">rho_cond_df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">alpha</span>, y <span class="op">=</span> <span class="va">var</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"#377EB8"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">)</span>, y <span class="op">=</span> <span class="st">"Variance"</span>,</span>
<span>       title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Var("</span><span class="op">*</span><span class="va">rho</span><span class="op">*</span><span class="st">" | "</span><span class="op">*</span><span class="va">alpha</span><span class="op">*</span><span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="theory-weights_files/figure-html/rho-conditional-1.png" class="r-plt" alt="Conditional mean and variance of œÅ as functions of Œ±." width="85%"><p class="caption">
Conditional mean and variance of œÅ as functions of Œ±.
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="the-i_c-functional-closed-form-moments">4. The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>I</mi><mi>c</mi></msub><annotation encoding="application/x-tex">I_c</annotation></semantics></math>
Functional: Closed-Form Moments<a class="anchor" aria-label="anchor" href="#the-i_c-functional-closed-form-moments"></a>
</h2>
<div class="section level3">
<h3 id="definition-and-analytical-expression">4.1 Definition and Analytical Expression<a class="anchor" aria-label="anchor" href="#definition-and-analytical-expression"></a>
</h3>
<p>Computing unconditional moments of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÅ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
under a Gamma hyperprior requires evaluating expectations of the form
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><mn>1</mn><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo>+</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}[1/(\alpha + c)]</annotation></semantics></math>.</p>
<p><strong>Definition 2</strong> (The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>I</mi><mi>c</mi></msub><annotation encoding="application/x-tex">I_c</annotation></semantics></math>
functional).
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>c</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>:=</mo><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><mfrac><mn>1</mn><mrow><mi>Œ±</mi><mo>+</mo><mi>c</mi></mrow></mfrac><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo><mspace width="1.0em"></mspace><mrow><mtext mathvariant="normal">where </mtext><mspace width="0.333em"></mspace></mrow><mi>Œ±</mi><mo>‚àº</mo><mtext mathvariant="normal">Gamma</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> and </mtext><mspace width="0.333em"></mspace></mrow><mi>c</mi><mo>&gt;</mo><mn>0</mn><mi>.</mi></mrow><annotation encoding="application/x-tex">
I_c(a, b) := \mathbb{E}\left[\frac{1}{\alpha + c}\right], \quad 
\text{where } \alpha \sim \text{Gamma}(a, b) \text{ and } c &gt; 0.
</annotation></semantics></math></p>
<p><strong>Lemma 1</strong> (Closed-form expression for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>I</mi><mi>c</mi></msub><annotation encoding="application/x-tex">I_c</annotation></semantics></math>;
this work).
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>c</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mi>b</mi><mi>a</mi></msup><mspace width="0.167em"></mspace><msup><mi>c</mi><mrow><mi>a</mi><mo>‚àí</mo><mn>1</mn></mrow></msup><mspace width="0.167em"></mspace><msup><mi>e</mi><mrow><mi>b</mi><mi>c</mi></mrow></msup><mspace width="0.167em"></mspace><mi>Œì</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><mi>a</mi><mo>,</mo><mi>b</mi><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
I_c(a, b) = b^a \, c^{a-1} \, e^{bc} \, \Gamma(1-a, bc),
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œì</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo>,</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msubsup><mo>‚à´</mo><mi>x</mi><mi>‚àû</mi></msubsup><msup><mi>t</mi><mrow><mi>s</mi><mo>‚àí</mo><mn>1</mn></mrow></msup><msup><mi>e</mi><mrow><mo>‚àí</mo><mi>t</mi></mrow></msup><mspace width="0.167em"></mspace><mi>d</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">\Gamma(s, x) = \int_x^\infty t^{s-1} e^{-t} \, dt</annotation></semantics></math>
is the <strong>upper incomplete gamma function</strong>.</p>
<p><strong>Proof.</strong> We have:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>c</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><msup><mi>b</mi><mi>a</mi></msup><mrow><mi>Œì</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><msubsup><mo>‚à´</mo><mn>0</mn><mi>‚àû</mi></msubsup><mfrac><mrow><msup><mi>Œ±</mi><mrow><mi>a</mi><mo>‚àí</mo><mn>1</mn></mrow></msup><msup><mi>e</mi><mrow><mo>‚àí</mo><mi>b</mi><mi>Œ±</mi></mrow></msup></mrow><mrow><mi>Œ±</mi><mo>+</mo><mi>c</mi></mrow></mfrac><mspace width="0.167em"></mspace><mi>d</mi><mi>Œ±</mi><mi>.</mi></mrow><annotation encoding="application/x-tex">
I_c(a, b) = \frac{b^a}{\Gamma(a)} \int_0^\infty \frac{\alpha^{a-1} e^{-b\alpha}}{\alpha + c} \, d\alpha.
</annotation></semantics></math></p>
<p>Using the integral identity:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>‚à´</mo><mn>0</mn><mi>‚àû</mi></msubsup><mfrac><mrow><msup><mi>x</mi><mrow><mi>a</mi><mo>‚àí</mo><mn>1</mn></mrow></msup><msup><mi>e</mi><mrow><mo>‚àí</mo><mi>b</mi><mi>x</mi></mrow></msup></mrow><mrow><mi>x</mi><mo>+</mo><mi>c</mi></mrow></mfrac><mspace width="0.167em"></mspace><mi>d</mi><mi>x</mi><mo>=</mo><msup><mi>c</mi><mrow><mi>a</mi><mo>‚àí</mo><mn>1</mn></mrow></msup><msup><mi>e</mi><mrow><mi>b</mi><mi>c</mi></mrow></msup><mi>Œì</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>Œì</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><mi>a</mi><mo>,</mo><mi>b</mi><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
\int_0^\infty \frac{x^{a-1} e^{-bx}}{x + c} \, dx = c^{a-1} e^{bc} \Gamma(a) \Gamma(1-a, bc),
</annotation></semantics></math> and multiplying by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>b</mi><mi>a</mi></msup><mi>/</mi><mi>Œì</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">b^a / \Gamma(a)</annotation></semantics></math>,
we obtain the result.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>‚ñ´</mi><annotation encoding="application/x-tex">\square</annotation></semantics></math></p>
<p><strong>Remark 1</strong> (Numerical evaluation). For
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">a &gt; 1</annotation></semantics></math>,
the upper incomplete gamma function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œì</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><mi>a</mi><mo>,</mo><mi>b</mi><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Gamma(1-a, bc)</annotation></semantics></math>
is defined via analytic continuation. Standard numerical libraries
handle this automatically (e.g., <code>pgamma</code> in R with
appropriate transformations, or <code>scipy.special.gammaincc</code> in
Python). For practical purposes in the DPprior package, we use
Gauss-Laguerre quadrature which avoids these analytic continuation
subtleties.</p>
</div>
<div class="section level3">
<h3 id="key-identities">4.2 Key Identities<a class="anchor" aria-label="anchor" href="#key-identities"></a>
</h3>
<p><strong>Theorem 2</strong> (Unconditional moments via
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>I</mi><mi>c</mi></msub><annotation encoding="application/x-tex">I_c</annotation></semantics></math>;
this work).</p>
<p><em>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ±</mi><mo>‚àº</mo><mtext mathvariant="normal">Gamma</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\alpha \sim \text{Gamma}(a, b)</annotation></semantics></math>.
Then:</em></p>
<p><strong>Mean of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math>:</strong>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>w</mi><mn>1</mn></msub><mo>‚à£</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mi>Œ±</mi></mrow></mfrac><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><msub><mi>I</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
\mathbb{E}[w_1 \mid a, b] = \mathbb{E}\left[\frac{1}{1+\alpha}\right] = I_1(a, b).
</annotation></semantics></math></p>
<p><strong>Mean of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÅ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
(co-clustering probability):</strong>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>œÅ</mi><mo>‚à£</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mi>Œ±</mi></mrow></mfrac><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><msub><mi>I</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
\mathbb{E}[\rho \mid a, b] = \mathbb{E}\left[\frac{1}{1+\alpha}\right] = I_1(a, b).
</annotation></semantics></math></p>
<p><strong>Corollary 2</strong> (Moment identity). <em>The unconditional
means are equal:</em>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>w</mi><mn>1</mn></msub><mo>‚à£</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>œÅ</mi><mo>‚à£</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><msub><mi>I</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
\mathbb{E}[w_1 \mid a, b] = \mathbb{E}[\rho \mid a, b] = I_1(a, b).
</annotation></semantics></math></p>
<p>This identity has important implications for elicitation: if a
practitioner specifies only a target for the <strong>mean</strong> of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÅ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>,
the two anchors are informationally equivalent. To make
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÅ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
add genuine extra constraint, one must elicit uncertainty (e.g., an
interval) and match the <strong>variance</strong>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Verify the key identity: E[w1] = E[rho]</span></span>
<span><span class="va">test_cases</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">1.0</span>, b <span class="op">=</span> <span class="fl">1.0</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">1.6</span>, b <span class="op">=</span> <span class="fl">1.22</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">2.0</span>, b <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">0.5</span>, b <span class="op">=</span> <span class="fl">2.0</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Verification: E[w‚ÇÅ] = E[œÅ] identity\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Verification: E[w‚ÇÅ] = E[œÅ] identity</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%10s %10s %12s %12s %12s\n"</span>, <span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"E[w‚ÇÅ]"</span>, <span class="st">"E[œÅ]"</span>, <span class="st">"Difference"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;          a          b      E[w‚ÇÅ]        E[œÅ]   Difference</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strrep.html" class="external-link">strrep</a></span><span class="op">(</span><span class="st">"-"</span>, <span class="fl">60</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; ------------------------------------------------------------</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">params</span> <span class="kw">in</span> <span class="va">test_cases</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">a</span> <span class="op">&lt;-</span> <span class="va">params</span><span class="op">[</span><span class="st">"a"</span><span class="op">]</span></span>
<span>  <span class="va">b</span> <span class="op">&lt;-</span> <span class="va">params</span><span class="op">[</span><span class="st">"b"</span><span class="op">]</span></span>
<span>  <span class="va">E_w1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mean_w1.html">mean_w1</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span><span class="op">)</span></span>
<span>  <span class="va">E_rho</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mean_rho.html">mean_rho</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span><span class="op">)</span></span>
<span>  <span class="va">diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">E_w1</span> <span class="op">-</span> <span class="va">E_rho</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%10.2f %10.2f %12.6f %12.6f %12.2e\n"</span>, <span class="va">a</span>, <span class="va">b</span>, <span class="va">E_w1</span>, <span class="va">E_rho</span>, <span class="va">diff</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt;       1.00       1.00     0.596347     0.596347     0.00e+00</span></span>
<span><span class="co">#&gt;       1.60       1.22     0.508368     0.508368     0.00e+00</span></span>
<span><span class="co">#&gt;       2.00       0.50     0.269272     0.269272     0.00e+00</span></span>
<span><span class="co">#&gt;       0.50       2.00     0.842738     0.842738     0.00e+00</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="second-moments-and-variance-of-rho">4.3 Second Moments and Variance of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÅ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#second-moments-and-variance-of-rho"></a>
</h3>
<p><strong>Proposition 4</strong> (Unconditional second moment of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÅ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>;
this work).</p>
<p><em>Using the partial fraction decomposition:</em>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>Œ±</mi><mo>+</mo><mn>6</mn></mrow><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo>+</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo>+</mo><mn>3</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>=</mo><mfrac><mn>5</mn><mrow><mn>2</mn><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>‚àí</mo><mfrac><mn>4</mn><mrow><mi>Œ±</mi><mo>+</mo><mn>2</mn></mrow></mfrac><mo>+</mo><mfrac><mn>3</mn><mrow><mn>2</mn><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo>+</mo><mn>3</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>,</mo></mrow><annotation encoding="application/x-tex">
\frac{\alpha + 6}{(\alpha+1)(\alpha+2)(\alpha+3)} = \frac{5}{2(\alpha+1)} - \frac{4}{\alpha+2} + \frac{3}{2(\alpha+3)},
</annotation></semantics></math></p>
<p><em>we obtain:</em>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msup><mi>œÅ</mi><mn>2</mn></msup><mo>‚à£</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mfrac><mn>5</mn><mn>2</mn></mfrac><msub><mi>I</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><mn>4</mn><msub><mi>I</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mfrac><mn>3</mn><mn>2</mn></mfrac><msub><mi>I</mi><mn>3</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
\mathbb{E}[\rho^2 \mid a, b] = \frac{5}{2} I_1(a, b) - 4 I_2(a, b) + \frac{3}{2} I_3(a, b).
</annotation></semantics></math></p>
<p><em>Hence the unconditional variance:</em>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>œÅ</mi><mo>‚à£</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msup><mi>œÅ</mi><mn>2</mn></msup><mo>‚à£</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>‚àí</mo><mo stretchy="false" form="prefix">{</mo><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>œÅ</mi><mo>‚à£</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">]</mo></mrow><msup><mo stretchy="false" form="postfix">}</mo><mn>2</mn></msup><mi>.</mi></mrow><annotation encoding="application/x-tex">
\text{Var}(\rho \mid a, b) = \mathbb{E}[\rho^2 \mid a, b] - \{\mathbb{E}[\rho \mid a, b]\}^2.
</annotation></semantics></math></p>
<p><strong>Key design implication.</strong> The
<strong>distribution</strong> of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œÅ</mi><mo>‚à£</mo><mi>a</mi><mo>,</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">\rho \mid a, b</annotation></semantics></math>
is not closed-form, but <strong>mean and variance are
closed-form</strong> (‚Äúmoment-closed‚Äù). This is sufficient for
moment-based calibration and diagnostics.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute unconditional rho moments for the Lee et al. prior</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">1.6</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">1.22</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Co-clustering probability under Gamma(1.6, 1.22) hyperprior:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Co-clustering probability under Gamma(1.6, 1.22) hyperprior:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  E[œÅ]   = %.4f\n"</span>, <span class="fu"><a href="../reference/mean_rho.html">mean_rho</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   E[œÅ]   = 0.5084</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  Var(œÅ) = %.4f\n"</span>, <span class="fu"><a href="../reference/var_rho.html">var_rho</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Var(œÅ) = 0.0710</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  SD(œÅ)  = %.4f\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="../reference/var_rho.html">var_rho</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   SD(œÅ)  = 0.2664</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  CV(œÅ)  = %.4f\n"</span>, <span class="fu"><a href="../reference/cv_rho.html">cv_rho</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   CV(œÅ)  = 0.5240</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="the-dual-anchor-optimization-framework">5. The Dual-Anchor Optimization Framework<a class="anchor" aria-label="anchor" href="#the-dual-anchor-optimization-framework"></a>
</h2>
<div class="section level3">
<h3 id="motivation-why-k-only-calibration-is-insufficient">5.1 Motivation: Why K-Only Calibration is Insufficient<a class="anchor" aria-label="anchor" href="#motivation-why-k-only-calibration-is-insufficient"></a>
</h3>
<p>As demonstrated by Vicentini and Jermyn (2025, Section 5), priors
calibrated to match a target on the number of clusters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>J</mi></msub><annotation encoding="application/x-tex">K_J</annotation></semantics></math>
can induce <strong>materially informative priors on the stick-breaking
weights</strong>. They observe that
‚Äú<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>n</mi></msub><annotation encoding="application/x-tex">K_n</annotation></semantics></math>-diffuse,
DORO, quasi-degenerate and Jeffreys‚Äô priors‚Ä¶ are markedly different from
the behaviour of SSI‚Äù (p.¬†18).</p>
<p>The mechanism is structural:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>J</mi></msub><annotation encoding="application/x-tex">K_J</annotation></semantics></math>
and the weight distribution are controlled by different functionals of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ±</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>.
For fixed
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>J</mi><annotation encoding="application/x-tex">J</annotation></semantics></math>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>K</mi><mi>J</mi></msub><mo>‚à£</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>‚âà</mo><mn>1</mn><mo>+</mo><mi>Œ±</mi><mo>log</mo><mi>J</mi><mspace width="1.0em"></mspace><mtext mathvariant="normal">(Antoniak, 1974)</mtext><mo>,</mo></mrow><annotation encoding="application/x-tex">
\mathbb{E}[K_J \mid \alpha] \approx 1 + \alpha \log J \quad \text{(Antoniak, 1974)},
</annotation></semantics></math> while:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>w</mi><mn>1</mn></msub><mo>‚à£</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mi>Œ±</mi></mrow></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">
\mathbb{E}[w_1 \mid \alpha] = \frac{1}{1 + \alpha}.
</annotation></semantics></math></p>
<p>Matching the <em>location</em> of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>J</mi></msub><annotation encoding="application/x-tex">K_J</annotation></semantics></math>
pins down
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ±</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
around
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ±</mi><mo>‚âà</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>K</mi><mi>J</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo>‚àí</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mo>log</mo><mi>J</mi></mrow><annotation encoding="application/x-tex">\alpha \approx (\mathbb{E}[K_J] - 1)/\log J</annotation></semantics></math>,
but this implied
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ±</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
can correspond to high dominance risk in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Demonstrate the unintended prior problem</span></span>
<span><span class="va">J</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">mu_K_target</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span></span>
<span><span class="co"># Fit using K-only calibration</span></span>
<span><span class="va">fit_K</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_fit.html">DPprior_fit</a></span><span class="op">(</span>J <span class="op">=</span> <span class="va">J</span>, mu_K <span class="op">=</span> <span class="va">mu_K_target</span>, confidence <span class="op">=</span> <span class="st">"medium"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: HIGH DOMINANCE RISK: P(w1 &gt; 0.5) = 49.7% exceeds 40%.</span></span>
<span><span class="co">#&gt;   This may indicate unintended prior behavior (Lee, 2026).</span></span>
<span><span class="co">#&gt;   Consider using DPprior_dual() for weight-constrained elicitation.</span></span>
<span><span class="co">#&gt;   See ?DPprior_diagnostics for interpretation.</span></span>
<span></span>
<span><span class="co"># What does this imply for weights?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"K-only calibration (J=50, Œº_K=5):\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; K-only calibration (J=50, Œº_K=5):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  Gamma hyperprior: a = %.3f, b = %.3f\n"</span>, <span class="va">fit_K</span><span class="op">$</span><span class="va">a</span>, <span class="va">fit_K</span><span class="op">$</span><span class="va">b</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Gamma hyperprior: a = 1.408, b = 1.077</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  Achieved E[K] = %.2f\n"</span>, </span>
<span>            <span class="fu"><a href="../reference/exact_K_moments.html">exact_K_moments</a></span><span class="op">(</span><span class="va">J</span>, <span class="va">fit_K</span><span class="op">$</span><span class="va">a</span>, <span class="va">fit_K</span><span class="op">$</span><span class="va">b</span><span class="op">)</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Achieved E[K] = 5.00</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nImplied weight behavior:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Implied weight behavior:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  E[w‚ÇÅ] = %.3f\n"</span>, <span class="fu"><a href="../reference/mean_w1.html">mean_w1</a></span><span class="op">(</span><span class="va">fit_K</span><span class="op">$</span><span class="va">a</span>, <span class="va">fit_K</span><span class="op">$</span><span class="va">b</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   E[w‚ÇÅ] = 0.518</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  P(w‚ÇÅ &gt; 0.5) = %.3f\n"</span>, <span class="fu"><a href="../reference/prob_w1_exceeds.html">prob_w1_exceeds</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="va">fit_K</span><span class="op">$</span><span class="va">a</span>, <span class="va">fit_K</span><span class="op">$</span><span class="va">b</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   P(w‚ÇÅ &gt; 0.5) = 0.497</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  P(w‚ÇÅ &gt; 0.9) = %.3f\n"</span>, <span class="fu"><a href="../reference/prob_w1_exceeds.html">prob_w1_exceeds</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="va">fit_K</span><span class="op">$</span><span class="va">a</span>, <span class="va">fit_K</span><span class="op">$</span><span class="va">b</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   P(w‚ÇÅ &gt; 0.9) = 0.200</span></span>
<span></span>
<span><span class="co"># Visualize the implied w1 distribution</span></span>
<span><span class="va">x_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.99</span>, length.out <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span></span>
<span><span class="va">implied_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">x_grid</span>,</span>
<span>  density <span class="op">=</span> <span class="fu">density_w1_manual</span><span class="op">(</span><span class="va">x_grid</span>, <span class="va">fit_K</span><span class="op">$</span><span class="va">a</span>, <span class="va">fit_K</span><span class="op">$</span><span class="va">b</span><span class="op">)</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"K-only calibration"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">implied_df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">density</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"#377EB8"</span>, linewidth <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0.5</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"#E41A1C"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">0.52</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">implied_df</span><span class="op">$</span><span class="va">density</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.8</span>, </span>
<span>           label <span class="op">=</span> <span class="st">"50% threshold"</span>, color <span class="op">=</span> <span class="st">"#E41A1C"</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">w</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Density"</span>,</span>
<span>    title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Implied Distribution of "</span> <span class="op">*</span> <span class="va">w</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="st">" Under K-Only Calibration"</span><span class="op">)</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"J = %d, target E[K] = %d; P(w‚ÇÅ &gt; 0.5) = %.2f"</span>, </span>
<span>                       <span class="va">J</span>, <span class="va">mu_K_target</span>, <span class="fu"><a href="../reference/prob_w1_exceeds.html">prob_w1_exceeds</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="va">fit_K</span><span class="op">$</span><span class="va">a</span>, <span class="va">fit_K</span><span class="op">$</span><span class="va">b</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="theory-weights_files/figure-html/unintended-prior-demo-1.png" class="r-plt" alt="The K-calibrated prior (blue) achieves the target E[K] but implies higher dominance risk than practitioners might expect." width="85%"><p class="caption">
The K-calibrated prior (blue) achieves the target E[K] but implies
higher dominance risk than practitioners might expect.
</p>
</div>
</div>
<div class="section level3">
<h3 id="the-dual-anchor-objective">5.2 The Dual-Anchor Objective<a class="anchor" aria-label="anchor" href="#the-dual-anchor-objective"></a>
</h3>
<p><strong>Definition 3</strong> (Dual-anchor optimization; this
work).</p>
<p><em>Given elicited targets
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>p</mi><mo>*</mo></msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>K</mi><mi>J</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p^*(K_J)</annotation></semantics></math>
(or summary statistics thereof) and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>p</mi><mo>*</mo></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>T</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p^*(T)</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>‚àà</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>w</mi><mn>1</mn></msub><mo>,</mo><mi>œÅ</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">T \in \{w_1, \rho\}</annotation></semantics></math>,
the dual-anchor hyperparameters are:</em>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>a</mi><mo>*</mo></msup><mo>,</mo><msup><mi>b</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>arg</mo><munder><mo>min</mo><mrow><mi>a</mi><mo>&gt;</mo><mn>0</mn><mo>,</mo><mi>b</mi><mo>&gt;</mo><mn>0</mn></mrow></munder><msub><mi>‚Ñí</mi><mi>Œª</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
(a^*, b^*) = \arg\min_{a &gt; 0, b &gt; 0} \mathcal{L}_\lambda(a, b),
</annotation></semantics></math><em>where:</em>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>‚Ñí</mi><mi>Œª</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>Œª</mi><mo>‚ãÖ</mo><mi>D</mi><mo stretchy="false" form="prefix">{</mo><msup><mi>p</mi><mo>*</mo></msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>K</mi><mi>J</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">‚à•</mo><msub><mi>p</mi><mrow><mi>a</mi><mo>,</mo><mi>b</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>K</mi><mi>J</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">}</mo><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><mi>Œª</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚ãÖ</mo><mi>D</mi><mo stretchy="false" form="prefix">{</mo><msup><mi>p</mi><mo>*</mo></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>T</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">‚à•</mo><msub><mi>p</mi><mrow><mi>a</mi><mo>,</mo><mi>b</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>T</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">}</mo><mo>,</mo></mrow><annotation encoding="application/x-tex">
\mathcal{L}_\lambda(a, b) = \lambda \cdot D\{p^*(K_J) \| p_{a,b}(K_J)\} + 
(1 - \lambda) \cdot D\{p^*(T) \| p_{a,b}(T)\},
</annotation></semantics></math><em>and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œª</mi><mo>‚àà</mo><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\lambda \in [0, 1]</annotation></semantics></math>
controls the trade-off between the two anchors.</em></p>
<p><strong>Boundary cases:</strong></p>
<table class="table">
<thead><tr class="header">
<th><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œª</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></th>
<th>Behavior</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œª</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\lambda = 1</annotation></semantics></math></td>
<td>K-only calibration (Lee, 2026, Sections 2‚Äì3)</td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œª</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\lambda = 0</annotation></semantics></math></td>
<td>Weight-only calibration (SSI-style)</td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&lt;</mo><mi>Œª</mi><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0 &lt; \lambda &lt; 1</annotation></semantics></math></td>
<td>Compromise between both anchors</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="implementation-variants">5.3 Implementation Variants<a class="anchor" aria-label="anchor" href="#implementation-variants"></a>
</h3>
<p>The dual-anchor objective can be implemented using different loss
functions:</p>
<p><strong>Moment-based loss (recommended for stability):</strong>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>‚Ñí</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>Œª</mi><mrow><mo stretchy="true" form="prefix">[</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>K</mi><mi>J</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo>‚àí</mo><msubsup><mi>Œº</mi><mi>K</mi><mo>*</mo></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msub><mi>œâ</mi><mi>K</mi></msub><msup><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>K</mi><mi>J</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><msubsup><mi>œÉ</mi><mi>K</mi><mrow><mn>2</mn><mo>*</mo></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">]</mo></mrow><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><mi>Œª</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">[</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>T</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>‚àí</mo><msubsup><mi>Œº</mi><mi>T</mi><mo>*</mo></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msub><mi>œâ</mi><mi>T</mi></msub><msup><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>T</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><msubsup><mi>œÉ</mi><mi>T</mi><mrow><mn>2</mn><mo>*</mo></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
\mathcal{L}(a, b) = \lambda \left[(\mathbb{E}[K_J] - \mu_K^*)^2 + 
\omega_K (\text{Var}(K_J) - \sigma_K^{2*})^2\right] + 
(1 - \lambda) \left[(\mathbb{E}[T] - \mu_T^*)^2 + 
\omega_T (\text{Var}(T) - \sigma_T^{2*})^2\right],
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>œâ</mi><mi>K</mi></msub><mo>,</mo><msub><mi>œâ</mi><mi>T</mi></msub><mo>‚â•</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\omega_K, \omega_T \geq 0</annotation></semantics></math>
are tuning weights.</p>
<p><strong>Quantile-based loss for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math>:</strong>
For
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>=</mo><msub><mi>w</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">T = w_1</annotation></semantics></math>,
one can directly target specific quantiles using the closed-form
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Q</mi><msub><mi>w</mi><mn>1</mn></msub></msub><annotation encoding="application/x-tex">Q_{w_1}</annotation></semantics></math>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>‚Ñí</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>Œª</mi><mo>‚ãÖ</mo><msub><mi>L</mi><mi>K</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><mi>Œª</mi><mo stretchy="true" form="postfix">)</mo></mrow><munder><mo>‚àë</mo><mi>i</mi></munder><msup><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>Q</mi><msub><mi>w</mi><mn>1</mn></msub></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>u</mi><mi>i</mi></msub><mo>‚à£</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><msubsup><mi>q</mi><mi>i</mi><mo>*</mo></msubsup><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup><mo>,</mo></mrow><annotation encoding="application/x-tex">
\mathcal{L}(a, b) = \lambda \cdot L_K(a, b) + 
(1 - \lambda) \sum_{i} \left[Q_{w_1}(u_i \mid a, b) - q_i^*\right]^2,
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>u</mi><mi>i</mi></msub><mo>,</mo><msubsup><mi>q</mi><mi>i</mi><mo>*</mo></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(u_i, q_i^*)</annotation></semantics></math>
are elicited quantile pairs.</p>
<p><strong>Probability constraint for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math>:</strong>
Target a specific dominance risk:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>‚Ñí</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>Œª</mi><mo>‚ãÖ</mo><msub><mi>L</mi><mi>K</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><mi>Œª</mi><mo stretchy="true" form="postfix">)</mo></mrow><msup><mrow><mo stretchy="true" form="prefix">[</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>&gt;</mo><mi>t</mi><mo>‚à£</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><msubsup><mi>p</mi><mi>t</mi><mo>*</mo></msubsup><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup><mi>.</mi></mrow><annotation encoding="application/x-tex">
\mathcal{L}(a, b) = \lambda \cdot L_K(a, b) + 
(1 - \lambda) \left[P(w_1 &gt; t \mid a, b) - p_t^*\right]^2.
</annotation></semantics></math></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Demonstrate dual-anchor calibration</span></span>
<span><span class="va">fit_dual</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_dual.html">DPprior_dual</a></span><span class="op">(</span></span>
<span>  fit <span class="op">=</span> <span class="va">fit_K</span>,</span>
<span>  w1_target <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>threshold <span class="op">=</span> <span class="fl">0.5</span>, value <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  lambda <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  loss_type <span class="op">=</span> <span class="st">"adaptive"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Dual-anchor calibration (target: P(w‚ÇÅ &gt; 0.5) = 0.25):\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dual-anchor calibration (target: P(w‚ÇÅ &gt; 0.5) = 0.25):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  Gamma hyperprior: a = %.3f, b = %.3f\n"</span>, <span class="va">fit_dual</span><span class="op">$</span><span class="va">a</span>, <span class="va">fit_dual</span><span class="op">$</span><span class="va">b</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Gamma hyperprior: a = 3.078, b = 1.669</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  Achieved E[K] = %.2f (target: %.1f)\n"</span>, </span>
<span>            <span class="fu"><a href="../reference/exact_K_moments.html">exact_K_moments</a></span><span class="op">(</span><span class="va">J</span>, <span class="va">fit_dual</span><span class="op">$</span><span class="va">a</span>, <span class="va">fit_dual</span><span class="op">$</span><span class="va">b</span><span class="op">)</span><span class="op">$</span><span class="va">mean</span>, <span class="va">mu_K_target</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Achieved E[K] = 6.43 (target: 5.0)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  P(w‚ÇÅ &gt; 0.5) = %.3f (target: 0.25)\n"</span>, </span>
<span>            <span class="fu"><a href="../reference/prob_w1_exceeds.html">prob_w1_exceeds</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="va">fit_dual</span><span class="op">$</span><span class="va">a</span>, <span class="va">fit_dual</span><span class="op">$</span><span class="va">b</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   P(w‚ÇÅ &gt; 0.5) = 0.343 (target: 0.25)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="the-trade-off-curve">5.4 The Trade-off Curve<a class="anchor" aria-label="anchor" href="#the-trade-off-curve"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute trade-off curve</span></span>
<span><span class="va">lambda_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.0</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.6</span>, <span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fl">0.3</span><span class="op">)</span></span>
<span><span class="va">w1_target</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>threshold <span class="op">=</span> <span class="fl">0.5</span>, value <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tradeoff_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">lambda_grid</span>, <span class="kw">function</span><span class="op">(</span><span class="va">lam</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">lam</span> <span class="op">==</span> <span class="fl">1.0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">fit</span> <span class="op">&lt;-</span> <span class="va">fit_K</span></span>
<span>    <span class="va">fit</span><span class="op">$</span><span class="va">dual_anchor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lambda <span class="op">=</span> <span class="fl">1.0</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_dual.html">DPprior_dual</a></span><span class="op">(</span><span class="va">fit_K</span>, <span class="va">w1_target</span>, lambda <span class="op">=</span> <span class="va">lam</span>, </span>
<span>                        loss_type <span class="op">=</span> <span class="st">"adaptive"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    lambda <span class="op">=</span> <span class="va">lam</span>,</span>
<span>    a <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">a</span>,</span>
<span>    b <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">b</span>,</span>
<span>    E_K <span class="op">=</span> <span class="fu"><a href="../reference/exact_K_moments.html">exact_K_moments</a></span><span class="op">(</span><span class="va">J</span>, <span class="va">fit</span><span class="op">$</span><span class="va">a</span>, <span class="va">fit</span><span class="op">$</span><span class="va">b</span><span class="op">)</span><span class="op">$</span><span class="va">mean</span>,</span>
<span>    P_w1_gt_50 <span class="op">=</span> <span class="fu"><a href="../reference/prob_w1_exceeds.html">prob_w1_exceeds</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="va">fit</span><span class="op">$</span><span class="va">a</span>, <span class="va">fit</span><span class="op">$</span><span class="va">b</span><span class="op">)</span>,</span>
<span>    E_w1 <span class="op">=</span> <span class="fu"><a href="../reference/mean_w1.html">mean_w1</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">a</span>, <span class="va">fit</span><span class="op">$</span><span class="va">b</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tradeoff_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">tradeoff_results</span>, <span class="va">`[[`</span>, <span class="st">"lambda"</span><span class="op">)</span>,</span>
<span>  E_K <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">tradeoff_results</span>, <span class="va">`[[`</span>, <span class="st">"E_K"</span><span class="op">)</span>,</span>
<span>  P_w1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">tradeoff_results</span>, <span class="va">`[[`</span>, <span class="st">"P_w1_gt_50"</span><span class="op">)</span>,</span>
<span>  E_w1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">tradeoff_results</span>, <span class="va">`[[`</span>, <span class="st">"E_w1"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">tradeoff_df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">E_K</span>, y <span class="op">=</span> <span class="va">P_w1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_path</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"gray50"</span>, linewidth <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">)</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0.2</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"#E41A1C"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">5</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"#377EB8"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">4.5</span>, y <span class="op">=</span> <span class="fl">0.22</span>, label <span class="op">=</span> <span class="st">"w1 target"</span>, </span>
<span>           hjust <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"#E41A1C"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">5.1</span>, y <span class="op">=</span> <span class="fl">0.45</span>, label <span class="op">=</span> <span class="st">"K target"</span>, hjust <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"#377EB8"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_viridis_d</span><span class="op">(</span>option <span class="op">=</span> <span class="st">"viridis"</span>, begin <span class="op">=</span> <span class="fl">0.2</span>, end <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">E</span><span class="op">*</span><span class="st">"["</span><span class="op">*</span><span class="va">K</span><span class="op">[</span><span class="va">J</span><span class="op">]</span><span class="op">*</span><span class="st">"]"</span><span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu">P</span><span class="op">(</span><span class="va">w</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Dual-Anchor Trade-off Curve"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Varying Œª from 1.0 (K-only) to 0.3 (weight-priority)"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Œª"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="theory-weights_files/figure-html/tradeoff-curve-1.png" class="r-plt" alt="Trade-off between K-fit and weight control as Œª varies from 1 (K-only) to 0.3 (weight-priority)." width="85%"><p class="caption">
Trade-off between K-fit and weight control as Œª varies from 1 (K-only)
to 0.3 (weight-priority).
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="relationship-between-w_1-and-rho">6. Relationship Between
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÅ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#relationship-between-w_1-and-rho"></a>
</h2>
<div class="section level3">
<h3 id="when-are-they-equivalent">6.1 When Are They Equivalent?<a class="anchor" aria-label="anchor" href="#when-are-they-equivalent"></a>
</h3>
<p>As established above,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>w</mi><mn>1</mn></msub><mo>‚à£</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>œÅ</mi><mo>‚à£</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}[w_1 \mid \alpha] = \mathbb{E}[\rho \mid \alpha]</annotation></semantics></math>.
This extends to the unconditional case:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>w</mi><mn>1</mn></msub><mo>‚à£</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>œÅ</mi><mo>‚à£</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}[w_1 \mid a, b] = \mathbb{E}[\rho \mid a, b]</annotation></semantics></math>.</p>
<p><strong>Consequence:</strong> If the practitioner elicits only a
<strong>mean</strong> constraint (e.g., ‚Äúco-clustering probability
should be about 0.3‚Äù), using
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÅ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
as the second anchor yields identical calibration constraints.</p>
</div>
<div class="section level3">
<h3 id="when-are-they-different">6.2 When Are They Different?<a class="anchor" aria-label="anchor" href="#when-are-they-different"></a>
</h3>
<p>The <strong>variances</strong> differ:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>‚à£</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mi>Œ±</mi><mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mo>+</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>‚â†</mo><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>œÅ</mi><mo>‚à£</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mn>2</mn><mi>Œ±</mi></mrow><mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo>+</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo>+</mo><mn>3</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">
\text{Var}(w_1 \mid \alpha) = \frac{\alpha}{(1+\alpha)^2(2+\alpha)} \neq 
\text{Var}(\rho \mid \alpha) = \frac{2\alpha}{(\alpha+1)^2(\alpha+2)(\alpha+3)}.
</annotation></semantics></math></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alpha_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">20</span>, length.out <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span></span>
<span><span class="va">var_comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">alpha_grid</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  variance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="va">alpha_grid</span> <span class="op">/</span> <span class="op">(</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">alpha_grid</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="fl">2</span> <span class="op">+</span> <span class="va">alpha_grid</span><span class="op">)</span><span class="op">)</span>,  <span class="co"># Var(w1|alpha)</span></span>
<span>    <span class="fu"><a href="../reference/var_rho_given_alpha.html">var_rho_given_alpha</a></span><span class="op">(</span><span class="va">alpha_grid</span><span class="op">)</span>                          <span class="co"># Var(rho|alpha)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  quantity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Var(w‚ÇÅ | Œ±)"</span>, <span class="st">"Var(œÅ | Œ±)"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">alpha_grid</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">var_comparison</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">alpha</span>, y <span class="op">=</span> <span class="va">variance</span>, color <span class="op">=</span> <span class="va">quantity</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Conditional Variance"</span>,</span>
<span>    title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Conditional Variance Comparison: "</span> <span class="op">*</span> <span class="va">w</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="st">" vs "</span> <span class="op">*</span> <span class="va">rho</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="theory-weights_files/figure-html/w1-rho-comparison-1.png" class="r-plt" alt="Comparison of conditional variances: Var(w‚ÇÅ|Œ±) vs Var(œÅ|Œ±)." width="85%"><p class="caption">
Comparison of conditional variances: Var(w‚ÇÅ|Œ±) vs Var(œÅ|Œ±).
</p>
</div>
</div>
<div class="section level3">
<h3 id="practical-guidance-choosing-between-w_1-and-rho">6.3 Practical Guidance: Choosing Between
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÅ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#practical-guidance-choosing-between-w_1-and-rho"></a>
</h3>
<table class="table">
<colgroup>
<col width="42%">
<col width="26%">
<col width="30%">
</colgroup>
<thead><tr class="header">
<th>Criterion</th>
<th><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math></th>
<th><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÅ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math></th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Distribution tractability</strong></td>
<td>Fully closed-form (CDF, quantiles)</td>
<td>Moment-closed only</td>
</tr>
<tr class="even">
<td><strong>Elicitation intuitiveness</strong></td>
<td>Moderate</td>
<td>High (‚Äúprobability two share a cluster‚Äù)</td>
</tr>
<tr class="odd">
<td><strong>Tail constraints</strong></td>
<td>Direct via
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>&gt;</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(w_1 &gt; t)</annotation></semantics></math>
</td>
<td>Requires simulation</td>
</tr>
<tr class="even">
<td><strong>Variance matching</strong></td>
<td>Possible but complex</td>
<td>Straightforward</td>
</tr>
</tbody>
</table>
<p><strong>Recommendation:</strong> Use
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math>
for quantile/probability constraints; use
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÅ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
when the co-clustering interpretation resonates with domain experts.</p>
</div>
</div>
<div class="section level2">
<h2 id="computational-details">7. Computational Details<a class="anchor" aria-label="anchor" href="#computational-details"></a>
</h2>
<div class="section level3">
<h3 id="key-functions-in-the-dpprior-package">7.1 Key Functions in the DPprior Package<a class="anchor" aria-label="anchor" href="#key-functions-in-the-dpprior-package"></a>
</h3>
<p>The package provides efficient implementations for all weight-related
computations:</p>
<table class="table">
<colgroup>
<col width="43%">
<col width="56%">
</colgroup>
<thead><tr class="header">
<th>Function</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>mean_w1(a, b)</code></td>
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>w</mi><mn>1</mn></msub><mo>‚à£</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}[w_1 \mid a, b]</annotation></semantics></math>
via Gauss-Laguerre quadrature</td>
</tr>
<tr class="even">
<td><code>var_w1(a, b)</code></td>
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>‚à£</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Var}(w_1 \mid a, b)</annotation></semantics></math>
via quadrature</td>
</tr>
<tr class="odd">
<td><code>cdf_w1(x, a, b)</code></td>
<td>Closed-form CDF
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>‚â§</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(w_1 \leq x)</annotation></semantics></math>
</td>
</tr>
<tr class="even">
<td><code>quantile_w1(u, a, b)</code></td>
<td>Closed-form quantile function</td>
</tr>
<tr class="odd">
<td><code>prob_w1_exceeds(t, a, b)</code></td>
<td>Closed-form
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>&gt;</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(w_1 &gt; t)</annotation></semantics></math>
</td>
</tr>
<tr class="even">
<td><code>mean_rho(a, b)</code></td>
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>œÅ</mi><mo>‚à£</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}[\rho \mid a, b]</annotation></semantics></math>
via quadrature</td>
</tr>
<tr class="odd">
<td><code>var_rho(a, b)</code></td>
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>œÅ</mi><mo>‚à£</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Var}(\rho \mid a, b)</annotation></semantics></math>
via quadrature</td>
</tr>
<tr class="even">
<td><code>mean_rho_given_alpha(alpha)</code></td>
<td>Conditional mean
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">1/(1+\alpha)</annotation></semantics></math>
</td>
</tr>
<tr class="odd">
<td><code>var_rho_given_alpha(alpha)</code></td>
<td>Conditional variance</td>
</tr>
<tr class="even">
<td><code><a href="../reference/DPprior_dual.html">DPprior_dual()</a></code></td>
<td>Dual-anchor calibration</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="numerical-verification">7.2 Numerical Verification<a class="anchor" aria-label="anchor" href="#numerical-verification"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Verify implementations against Monte Carlo</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">1.6</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">1.22</span></span>
<span><span class="va">n_mc</span> <span class="op">&lt;-</span> <span class="fl">100000</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">alpha_samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="va">n_mc</span>, shape <span class="op">=</span> <span class="va">a</span>, rate <span class="op">=</span> <span class="va">b</span><span class="op">)</span></span>
<span><span class="va">w1_samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="va">n_mc</span>, <span class="fl">1</span>, <span class="va">alpha_samples</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Verification against Monte Carlo (n ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">n_mc</span>, big.mark <span class="op">=</span> <span class="st">","</span><span class="op">)</span>, <span class="st">"):\n\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Verification against Monte Carlo (n = 1e+05 ):</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"w‚ÇÅ moments:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; w‚ÇÅ moments:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  E[w‚ÇÅ]: Analytic = %.4f, MC = %.4f\n"</span>, </span>
<span>            <span class="fu"><a href="../reference/mean_w1.html">mean_w1</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">w1_samples</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   E[w‚ÇÅ]: Analytic = 0.5084, MC = 0.5088</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  Var(w‚ÇÅ): Analytic = %.4f, MC = %.4f\n"</span>, </span>
<span>            <span class="fu"><a href="../reference/var_w1.html">var_w1</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">w1_samples</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Var(w‚ÇÅ): Analytic = 0.1052, MC = 0.1054</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nw‚ÇÅ tail probabilities:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; w‚ÇÅ tail probabilities:</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">t</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">mc_prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">w1_samples</span> <span class="op">&gt;</span> <span class="va">t</span><span class="op">)</span></span>
<span>  <span class="va">analytic_prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prob_w1_exceeds.html">prob_w1_exceeds</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">a</span>, <span class="va">b</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  P(w‚ÇÅ &gt; %.1f): Analytic = %.4f, MC = %.4f\n"</span>, </span>
<span>              <span class="va">t</span>, <span class="va">analytic_prob</span>, <span class="va">mc_prob</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt;   P(w‚ÇÅ &gt; 0.3): Analytic = 0.6634, MC = 0.6627</span></span>
<span><span class="co">#&gt;   P(w‚ÇÅ &gt; 0.5): Analytic = 0.4868, MC = 0.4876</span></span>
<span><span class="co">#&gt;   P(w‚ÇÅ &gt; 0.9): Analytic = 0.1833, MC = 0.1858</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nœÅ moments (via quadrature vs MC simulation):\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; œÅ moments (via quadrature vs MC simulation):</span></span>
<span><span class="va">rho_samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">alpha_samples</span>, <span class="kw">function</span><span class="op">(</span><span class="va">alph</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1</span>, <span class="va">alph</span><span class="op">)</span></span>
<span>  <span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumprod</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span> <span class="op">-</span> <span class="va">v</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">v</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="va">v</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">w</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  E[œÅ]: Analytic = %.4f, MC = %.4f\n"</span>, </span>
<span>            <span class="fu"><a href="../reference/mean_rho.html">mean_rho</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">rho_samples</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   E[œÅ]: Analytic = 0.5084, MC = 0.5081</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="summary">8. Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>This vignette has provided a rigorous treatment of the weight
distribution theory underlying the DPprior package:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Stick-breaking weights</strong>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>,</mo><msub><mi>w</mi><mn>2</mn></msub><mo>,</mo><mi>‚Ä¶</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(w_1, w_2, \ldots)</annotation></semantics></math>
follow the
GEM(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ±</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>)
distribution in size-biased (not decreasing) order.</p></li>
<li><p><strong><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>1</mn></msub><mo>‚à£</mo><mi>Œ±</mi><mo>‚àº</mo><mtext mathvariant="normal">Beta</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">w_1 \mid \alpha \sim \text{Beta}(1, \alpha)</annotation></semantics></math></strong>,
and under
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ±</mi><mo>‚àº</mo><mtext mathvariant="normal">Gamma</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\alpha \sim \text{Gamma}(a, b)</annotation></semantics></math>,
the marginal distribution of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math>
has <strong>fully closed-form</strong> CDF, quantiles, and tail
probabilities.</p></li>
<li><p><strong>The co-clustering probability</strong>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œÅ</mi><mo>=</mo><msub><mo>‚àë</mo><mi>h</mi></msub><msubsup><mi>w</mi><mi>h</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\rho = \sum_h w_h^2</annotation></semantics></math>
has the same conditional mean as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>œÅ</mi><mo>‚à£</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mn>1</mn><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}[\rho \mid \alpha] = 1/(1+\alpha)</annotation></semantics></math>.</p></li>
<li><p><strong>The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>I</mi><mi>c</mi></msub><annotation encoding="application/x-tex">I_c</annotation></semantics></math>
functional</strong> enables closed-form computation of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><mn>1</mn><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo>+</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}[1/(\alpha + c)]</annotation></semantics></math>,
which underlies the moment formulas for both
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÅ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>.</p></li>
<li><p><strong>K-only calibration</strong> can induce unintended weight
behavior. The <strong>dual-anchor framework</strong> provides explicit
control over both cluster counts and weight concentration via a
trade-off parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œª</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>.</p></li>
</ol>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Antoniak, C. E. (1974). Mixtures of Dirichlet processes with
applications to Bayesian nonparametric problems. <em>The Annals of
Statistics</em>, 2(6), 1152-1174.</p>
<p>Arratia, R., Barbour, A. D., &amp; Tavar√©, S. (2003). <em>Logarithmic
Combinatorial Structures: A Probabilistic Approach</em>. European
Mathematical Society.</p>
<p>Connor, R. J., &amp; Mosimann, J. E. (1969). Concepts of independence
for proportions with a generalization of the Dirichlet distribution.
<em>Journal of the American Statistical Association</em>, 64(325),
194-206.</p>
<p>Dorazio, R. M. (2009). On selecting a prior for the precision
parameter of Dirichlet process mixture models. <em>Journal of
Statistical Planning and Inference</em>, 139(10), 3384-3390.</p>
<p>Escobar, M. D., &amp; West, M. (1995). Bayesian density estimation
and inference using mixtures. <em>Journal of the American Statistical
Association</em>, 90(430), 577-588.</p>
<p>Kingman, J. F. C. (1975). Random discrete distributions. <em>Journal
of the Royal Statistical Society: Series B</em>, 37(1), 1-22.</p>
<p>Lee, J., Che, J., Rabe-Hesketh, S., Feller, A., &amp; Miratrix, L.
(2025). Improving the estimation of site-specific effects and their
distribution in multisite trials. <em>Journal of Educational and
Behavioral Statistics</em>, 50(5), 731-764.</p>
<p>Murugiah, S., &amp; Sweeting, T. J. (2012). Selecting the precision
parameter prior in Dirichlet process mixture models. <em>Journal of
Statistical Planning and Inference</em>, 142(7), 1947-1959.</p>
<p>Pitman, J. (1996). Random discrete distributions invariant under
size-biased permutation. <em>Advances in Applied Probability</em>,
28(2), 525-539.</p>
<p>Sethuraman, J. (1994). A constructive definition of Dirichlet priors.
<em>Statistica Sinica</em>, 4(2), 639-650.</p>
<p>Vicentini, S., &amp; Jermyn, I. H. (2025). Prior selection for the
precision parameter of Dirichlet process mixture models.
<em>arXiv:2502.00864</em>.</p>
<p>Zito, A., Rigon, T., &amp; Dunson, D. B. (2024). Bayesian
nonparametric modeling of latent partitions via Stirling-gamma priors.
<em>Bayesian Analysis</em>. <a href="https://doi.org/10.1214/24-BA1463" class="external-link uri">https://doi.org/10.1214/24-BA1463</a></p>
<hr>
</div>
<div class="section level2">
<h2 id="appendix-key-formulas-reference">Appendix: Key Formulas Reference<a class="anchor" aria-label="anchor" href="#appendix-key-formulas-reference"></a>
</h2>
<div class="section level3">
<h3 id="a-1-conditional-distributions">A.1 Conditional Distributions<a class="anchor" aria-label="anchor" href="#a-1-conditional-distributions"></a>
</h3>
<table class="table">
<colgroup>
<col width="32%">
<col width="67%">
</colgroup>
<thead><tr class="header">
<th>Quantity</th>
<th>Distribution/Moment</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>1</mn></msub><mo>‚à£</mo><mi>Œ±</mi></mrow><annotation encoding="application/x-tex">w_1 \mid \alpha</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Beta</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Beta}(1, \alpha)</annotation></semantics></math></td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>w</mi><mn>1</mn></msub><mo>‚à£</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}[w_1 \mid \alpha]</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">1/(1+\alpha)</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>‚à£</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Var}(w_1 \mid \alpha)</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ±</mi><mi>/</mi><mrow><mo stretchy="true" form="prefix">[</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mo>+</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\alpha/[(1+\alpha)^2(2+\alpha)]</annotation></semantics></math></td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>œÅ</mi><mo>‚à£</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}[\rho \mid \alpha]</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">1/(1+\alpha)</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>œÅ</mi><mo>‚à£</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Var}(\rho \mid \alpha)</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>Œ±</mi><mi>/</mi><mrow><mo stretchy="true" form="prefix">[</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo>+</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo>+</mo><mn>3</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">2\alpha/[(\alpha+1)^2(\alpha+2)(\alpha+3)]</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="a-2-marginal-distributions-under-alpha-sim-textgammaa-b">A.2 Marginal Distributions Under
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ±</mi><mo>‚àº</mo><mtext mathvariant="normal">Gamma</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\alpha \sim \text{Gamma}(a, b)</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#a-2-marginal-distributions-under-alpha-sim-textgammaa-b"></a>
</h3>
<table class="table">
<thead><tr class="header">
<th>Quantity</th>
<th>Formula</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><msub><mi>w</mi><mn>1</mn></msub></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">F_{w_1}(x)</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>‚àí</mo><msup><mrow><mo stretchy="true" form="prefix">[</mo><mi>b</mi><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo>‚àí</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mi>a</mi></msup></mrow><annotation encoding="application/x-tex">1 - [b/(b - \log(1-x))]^a</annotation></semantics></math></td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Q</mi><msub><mi>w</mi><mn>1</mn></msub></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Q_{w_1}(u)</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>‚àí</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mrow><mo stretchy="true" form="prefix">[</mo><mn>1</mn><mo>‚àí</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>‚àí</mo><mn>1</mn><mi>/</mi><mi>a</mi></mrow></msup><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">1 - \exp(b[1 - (1-u)^{-1/a}])</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>&gt;</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(w_1 &gt; t)</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mrow><mo stretchy="true" form="prefix">[</mo><mi>b</mi><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo>‚àí</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mi>a</mi></msup><annotation encoding="application/x-tex">[b/(b - \log(1-t))]^a</annotation></semantics></math></td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>w</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}[w_1]</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">I_1(a, b)</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>œÅ</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}[\rho]</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">I_1(a, b)</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="a-3-the-i_c-functional">A.3 The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>I</mi><mi>c</mi></msub><annotation encoding="application/x-tex">I_c</annotation></semantics></math>
Functional<a class="anchor" aria-label="anchor" href="#a-3-the-i_c-functional"></a>
</h3>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>c</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><mfrac><mn>1</mn><mrow><mi>Œ±</mi><mo>+</mo><mi>c</mi></mrow></mfrac><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><msup><mi>b</mi><mi>a</mi></msup><msup><mi>c</mi><mrow><mi>a</mi><mo>‚àí</mo><mn>1</mn></mrow></msup><msup><mi>e</mi><mrow><mi>b</mi><mi>c</mi></mrow></msup><mi>Œì</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><mi>a</mi><mo>,</mo><mi>b</mi><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
I_c(a, b) = \mathbb{E}\left[\frac{1}{\alpha + c}\right] = b^a c^{a-1} e^{bc} \Gamma(1-a, bc)
</annotation></semantics></math></p>
<hr>
<p><em>For questions about this vignette or the DPprior package, please
visit the <a href="https://github.com/joonho112/DPprior" class="external-link">GitHub
repository</a>.</em></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/joonho112" class="external-link">JoonHo Lee</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
