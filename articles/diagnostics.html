<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Diagnosing Your Prior: Avoiding Unintended Consequences • DPprior</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Diagnosing Your Prior: Avoiding Unintended Consequences">
<meta name="description" content="Learn to verify that your elicited Gamma hyperprior behaves as intended  across all relevant dimensions, not just the number of clusters.
">
<meta property="og:description" content="Learn to verify that your elicited Gamma hyperprior behaves as intended  across all relevant dimensions, not just the number of clusters.
">
<meta property="og:image" content="https://joonho112.github.io/DPprior/logo.svg">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DPprior</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><h6 class="dropdown-header" data-toc-skip>--- Applied Track ---</h6></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/quick-start.html">Quick Start</a></li>
    <li><a class="dropdown-item" href="../articles/applied-guide.html">Applied Guide</a></li>
    <li><a class="dropdown-item" href="../articles/dual-anchor.html">Dual-Anchor Framework</a></li>
    <li><a class="dropdown-item" href="../articles/diagnostics.html">Diagnostics</a></li>
    <li><a class="dropdown-item" href="../articles/case-studies.html">Case Studies</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>--- Methodological Track ---</h6></li>
    <li><a class="dropdown-item" href="../articles/theory-overview.html">Theory Overview</a></li>
    <li><a class="dropdown-item" href="../articles/theory-stirling.html">Stirling Numbers</a></li>
    <li><a class="dropdown-item" href="../articles/theory-approximations.html">Approximations (A1)</a></li>
    <li><a class="dropdown-item" href="../articles/theory-newton.html">Newton Algorithm (A2)</a></li>
    <li><a class="dropdown-item" href="../articles/theory-weights.html">Weight Distributions</a></li>
    <li><a class="dropdown-item" href="../articles/api-reference.html">API Reference</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/joonho112/DPprior/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Diagnosing Your Prior: Avoiding Unintended Consequences</h1>
                        <h4 data-toc-skip class="author">JoonHo Lee</h4>
            
            <h4 data-toc-skip class="date">2026-02-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/joonho112/DPprior/blob/main/vignettes/diagnostics.Rmd" class="external-link"><code>vignettes/diagnostics.Rmd</code></a></small>
      <div class="d-none name"><code>diagnostics.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>When you elicit a Gamma hyperprior for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
based on your expectations about the number of clusters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>J</mi></msub><annotation encoding="application/x-tex">K_J</annotation></semantics></math>,
you are implicitly specifying priors on <em>many other quantities</em>
that you may not have consciously considered. These “unintended priors”
can lead your posterior inference in unexpected directions, particularly
in low-information settings where the data cannot overwhelm an
inadvertently strong prior.</p>
<p>This vignette introduces the diagnostic tools in the DPprior package
that help you verify your prior behaves as intended across all relevant
dimensions. By the end, you will understand:</p>
<ol style="list-style-type: decimal">
<li>Why diagnostics matter: the “unintended prior” problem</li>
<li>The complete diagnostic suite available in DPprior</li>
<li>How to interpret
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
and weight distribution diagnostics</li>
<li>The dominance warning system and how to respond to alerts</li>
<li>How to use diagnostics to iteratively refine your prior</li>
</ol>
</div>
<div class="section level2">
<h2 id="why-diagnostics-matter">1. Why Diagnostics Matter<a class="anchor" aria-label="anchor" href="#why-diagnostics-matter"></a>
</h2>
<div class="section level3">
<h3 id="the-blind-spot-in-prior-elicitation">1.1 The Blind Spot in Prior Elicitation<a class="anchor" aria-label="anchor" href="#the-blind-spot-in-prior-elicitation"></a>
</h3>
<p>The standard workflow for eliciting a DP prior focuses on cluster
counts:</p>
<ol style="list-style-type: decimal">
<li>You think about
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mi>K</mi></msub><annotation encoding="application/x-tex">\mu_K</annotation></semantics></math>:
“How many groups do I expect?”</li>
<li>You think about
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>K</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Var}(K)</annotation></semantics></math>:
“How uncertain am I about that?”</li>
<li>You call <code><a href="../reference/DPprior_fit.html">DPprior_fit()</a></code> and obtain
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>∼</mo><mtext mathvariant="normal">Gamma</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\alpha \sim \text{Gamma}(a, b)</annotation></semantics></math>
</li>
</ol>
<p>This is intuitive and principled. However, your elicited prior on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
determines not just
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>J</mi></msub><annotation encoding="application/x-tex">K_J</annotation></semantics></math>,
but also:</p>
<ul>
<li>The <strong>distribution of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
itself</strong>: mean, variance, and shape</li>
<li>The <strong>cluster weight distribution</strong>: how mass is
allocated across clusters</li>
<li>The <strong>co-clustering probability</strong>: how likely two
random observations share a cluster</li>
<li>The <strong>dominance risk</strong>: probability that one cluster
contains most of the data</li>
</ul>
<p>These characteristics are implicit consequences of your
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(a, b)</annotation></semantics></math>
choice. You may not have intended any particular behavior for these
quantities, yet your prior assigns specific probabilities to them.</p>
</div>
<div class="section level3">
<h3 id="the-unintended-prior-problem">1.2 The Unintended Prior Problem<a class="anchor" aria-label="anchor" href="#the-unintended-prior-problem"></a>
</h3>
<p><a href="https://doi.org/10.48550/arXiv.2502.00864" class="external-link">Vicentini &amp;
Jermyn (2025)</a> demonstrated that matching a target
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>J</mi></msub><annotation encoding="application/x-tex">K_J</annotation></semantics></math>
distribution does not guarantee intuitive weight behavior. Consider a
concrete example:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">J</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">mu_K</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span></span>
<span><span class="co"># K-only calibration with moderate uncertainty</span></span>
<span><span class="va">fit_K</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_fit.html">DPprior_fit</a></span><span class="op">(</span>J <span class="op">=</span> <span class="va">J</span>, mu_K <span class="op">=</span> <span class="va">mu_K</span>, confidence <span class="op">=</span> <span class="st">"low"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: HIGH DOMINANCE RISK: P(w1 &gt; 0.5) = 56.3% exceeds 40%.</span></span>
<span><span class="co">#&gt;   This may indicate unintended prior behavior (Lee, 2026).</span></span>
<span><span class="co">#&gt;   Consider using DPprior_dual() for weight-constrained elicitation.</span></span>
<span><span class="co">#&gt;   See ?DPprior_diagnostics for interpretation.</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"K-only prior: Gamma("</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fit_K</span><span class="op">$</span><span class="va">a</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">", "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fit_K</span><span class="op">$</span><span class="va">b</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">")\n"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="co">#&gt; K-only prior: Gamma(0.518, 0.341)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nCluster count behavior:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Cluster count behavior:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  E[K] ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="../reference/exact_K_moments.html">exact_K_moments</a></span><span class="op">(</span><span class="va">J</span>, <span class="va">fit_K</span><span class="op">$</span><span class="va">a</span>, <span class="va">fit_K</span><span class="op">$</span><span class="va">b</span><span class="op">)</span><span class="op">$</span><span class="va">mean</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   E[K] = 5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  This matches our target of"</span>, <span class="va">mu_K</span>, <span class="st">"clusters.\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   This matches our target of 5 clusters.</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nBut what about weight behavior?\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; But what about weight behavior?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  E[w₁] ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="../reference/mean_w1.html">mean_w1</a></span><span class="op">(</span><span class="va">fit_K</span><span class="op">$</span><span class="va">a</span>, <span class="va">fit_K</span><span class="op">$</span><span class="va">b</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   E[w₁] = 0.585</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  P(w₁ &gt; 0.3) ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="../reference/prob_w1_exceeds.html">prob_w1_exceeds</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="va">fit_K</span><span class="op">$</span><span class="va">a</span>, <span class="va">fit_K</span><span class="op">$</span><span class="va">b</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   P(w₁ &gt; 0.3) = 0.69</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  P(w₁ &gt; 0.5) ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="../reference/prob_w1_exceeds.html">prob_w1_exceeds</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="va">fit_K</span><span class="op">$</span><span class="va">a</span>, <span class="va">fit_K</span><span class="op">$</span><span class="va">b</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   P(w₁ &gt; 0.5) = 0.563</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  P(w₁ &gt; 0.9) ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="../reference/prob_w1_exceeds.html">prob_w1_exceeds</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="va">fit_K</span><span class="op">$</span><span class="va">a</span>, <span class="va">fit_K</span><span class="op">$</span><span class="va">b</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   P(w₁ &gt; 0.9) = 0.346</span></span></code></pre></div>
<p>The prior expects 5 clusters, but there is a substantial probability
(nearly 50%) that a randomly selected observation belongs to a cluster
containing more than half of all observations. Is this what you intended
when you said “I expect 5 clusters”?</p>
<p>Most researchers, when they think “5 clusters,” imagine something
like five roughly comparable groups—not a situation where one cluster
might dominate the entire mixture.</p>
</div>
<div class="section level3">
<h3 id="why-this-matters-in-practice">1.3 Why This Matters in Practice<a class="anchor" aria-label="anchor" href="#why-this-matters-in-practice"></a>
</h3>
<p>The unintended prior problem is especially consequential in
<strong>low-information settings</strong> (<a href="https://doi.org/10.3102/10769986241254286" class="external-link">Lee et al.,
2025</a>):</p>
<ul>
<li>
<strong>Multisite trials with few sites</strong>: When
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>J</mi><annotation encoding="application/x-tex">J</annotation></semantics></math>
is moderate (20–100), each site provides limited data</li>
<li>
<strong>Sparse clustering applications</strong>: When observations
per cluster are small</li>
<li>
<strong>Exploratory analyses</strong>: When you don’t have strong
prior data to inform expectations</li>
</ul>
<p>In these settings, the posterior can remain close to the prior. If
your prior inadvertently favors a single dominant cluster, your
posterior may inherit this behavior even when the data suggest
otherwise.</p>
</div>
</div>
<div class="section level2">
<h2 id="the-complete-diagnostic-suite">2. The Complete Diagnostic Suite<a class="anchor" aria-label="anchor" href="#the-complete-diagnostic-suite"></a>
</h2>
<p>The DPprior package provides a comprehensive set of diagnostics that
you can access in several ways.</p>
<div class="section level3">
<h3 id="automatic-diagnostics-during-fitting">2.1 Automatic Diagnostics During Fitting<a class="anchor" aria-label="anchor" href="#automatic-diagnostics-during-fitting"></a>
</h3>
<p>The simplest approach is to enable diagnostics during the fitting
process:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_fit.html">DPprior_fit</a></span><span class="op">(</span>J <span class="op">=</span> <span class="fl">50</span>, mu_K <span class="op">=</span> <span class="fl">5</span>, var_K <span class="op">=</span> <span class="fl">8</span>, check_diagnostics <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: HIGH DOMINANCE RISK: P(w1 &gt; 0.5) = 48.1% exceeds 40%.</span></span>
<span><span class="co">#&gt;   This may indicate unintended prior behavior (Lee, 2026).</span></span>
<span><span class="co">#&gt;   Consider using DPprior_dual() for weight-constrained elicitation.</span></span>
<span><span class="co">#&gt;   See ?DPprior_diagnostics for interpretation.</span></span></code></pre></div>
<p>When <code>check_diagnostics = TRUE</code>, the function computes all
diagnostic quantities and stores them in the returned object.</p>
</div>
<div class="section level3">
<h3 id="post-hoc-diagnostic-computation">2.2 Post-Hoc Diagnostic Computation<a class="anchor" aria-label="anchor" href="#post-hoc-diagnostic-computation"></a>
</h3>
<p>You can also compute diagnostics after fitting:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit without diagnostics first</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_fit.html">DPprior_fit</a></span><span class="op">(</span>J <span class="op">=</span> <span class="fl">50</span>, mu_K <span class="op">=</span> <span class="fl">5</span>, var_K <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: HIGH DOMINANCE RISK: P(w1 &gt; 0.5) = 48.1% exceeds 40%.</span></span>
<span><span class="co">#&gt;   This may indicate unintended prior behavior (Lee, 2026).</span></span>
<span><span class="co">#&gt;   Consider using DPprior_dual() for weight-constrained elicitation.</span></span>
<span><span class="co">#&gt;   See ?DPprior_diagnostics for interpretation.</span></span>
<span></span>
<span><span class="co"># Then compute diagnostics</span></span>
<span><span class="va">diag</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_diagnostics.html">DPprior_diagnostics</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">diag</span><span class="op">)</span></span>
<span><span class="co">#&gt; DPprior Comprehensive Diagnostics</span></span>
<span><span class="co">#&gt; ============================================================ </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Prior: alpha ~ Gamma(2.0361, 1.6051) for J = 50</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; alpha Distribution:</span></span>
<span><span class="co">#&gt; ---------------------------------------- </span></span>
<span><span class="co">#&gt;   E[alpha] = 1.269, CV(alpha) = 0.701, Median = 1.068</span></span>
<span><span class="co">#&gt;   90% CI: [0.230, 2.992]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; K_J Distribution:</span></span>
<span><span class="co">#&gt; ---------------------------------------- </span></span>
<span><span class="co">#&gt;   E[K] = 5.00, SD(K) = 2.83, Mode = 3</span></span>
<span><span class="co">#&gt;   Median = 5, IQR = [3, 7]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; w1 Distribution (Size-Biased First Weight):</span></span>
<span><span class="co">#&gt; ---------------------------------------- </span></span>
<span><span class="co">#&gt;   E[w1] = 0.501, Median = 0.478</span></span>
<span><span class="co">#&gt;   P(w1 &gt; 0.5) = 48.1% (dominance risk: HIGH)</span></span>
<span><span class="co">#&gt;   P(w1 &gt; 0.9) = 16.3%</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Co-Clustering (rho = sum w_h^2):</span></span>
<span><span class="co">#&gt; ---------------------------------------- </span></span>
<span><span class="co">#&gt;   E[rho] = 0.501 (High prior co-clustering: most unit pairs expected in same cluster)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; WARNINGS:</span></span>
<span><span class="co">#&gt; ---------------------------------------- </span></span>
<span><span class="co">#&gt;   * HIGH DOMINANCE RISK: P(w1 &gt; 0.5) = 48.1% exceeds 40%</span></span>
<span><span class="co">#&gt;   * NEAR-DEGENERATE RISK: P(w1 &gt; 0.9) = 16.3% exceeds 15%</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Consider using DPprior_dual() for weight-constrained elicitation.</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="overview-of-diagnostic-components">2.3 Overview of Diagnostic Components<a class="anchor" aria-label="anchor" href="#overview-of-diagnostic-components"></a>
</h3>
<p>The diagnostic object contains several components:</p>
<table class="table">
<colgroup>
<col width="45%">
<col width="54%">
</colgroup>
<thead><tr class="header">
<th>Component</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>alpha</code></td>
<td>Properties of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
prior (mean, SD, CV, quantiles)</td>
</tr>
<tr class="even">
<td><code>K</code></td>
<td>Properties of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>J</mi></msub><annotation encoding="application/x-tex">K_J</annotation></semantics></math>
marginal (mean, variance, mode, PMF)</td>
</tr>
<tr class="odd">
<td><code>weights</code></td>
<td>First stick-breaking weight distribution (mean, median, tail
probabilities)</td>
</tr>
<tr class="even">
<td><code>coclustering</code></td>
<td>Co-clustering probability summary</td>
</tr>
<tr class="odd">
<td><code>warnings</code></td>
<td>Character vector of any diagnostic warnings</td>
</tr>
</tbody>
</table>
<p>Let us examine each component in detail.</p>
</div>
</div>
<div class="section level2">
<h2 id="alpha-distribution-diagnostics">3. Alpha Distribution Diagnostics<a class="anchor" aria-label="anchor" href="#alpha-distribution-diagnostics"></a>
</h2>
<p>The first set of diagnostics concerns the concentration parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
itself. Since
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>∼</mo><mtext mathvariant="normal">Gamma</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\alpha \sim \text{Gamma}(a, b)</annotation></semantics></math>,
we can compute all moments analytically.</p>
<div class="section level3">
<h3 id="accessing-alpha-diagnostics">3.1 Accessing Alpha Diagnostics<a class="anchor" aria-label="anchor" href="#accessing-alpha-diagnostics"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_fit.html">DPprior_fit</a></span><span class="op">(</span>J <span class="op">=</span> <span class="fl">50</span>, mu_K <span class="op">=</span> <span class="fl">5</span>, var_K <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: HIGH DOMINANCE RISK: P(w1 &gt; 0.5) = 48.1% exceeds 40%.</span></span>
<span><span class="co">#&gt;   This may indicate unintended prior behavior (Lee, 2026).</span></span>
<span><span class="co">#&gt;   Consider using DPprior_dual() for weight-constrained elicitation.</span></span>
<span><span class="co">#&gt;   See ?DPprior_diagnostics for interpretation.</span></span>
<span><span class="va">diag</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_diagnostics.html">DPprior_diagnostics</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Alpha distribution summary:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Alpha distribution summary:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Mean:     E[α] ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag</span><span class="op">$</span><span class="va">alpha</span><span class="op">$</span><span class="va">mean</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Mean:     E[α] = 1.2686</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  SD:       SD(α) ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag</span><span class="op">$</span><span class="va">alpha</span><span class="op">$</span><span class="va">sd</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   SD:       SD(α) = 0.889</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  CV:       CV(α) ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag</span><span class="op">$</span><span class="va">alpha</span><span class="op">$</span><span class="va">cv</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   CV:       CV(α) = 0.7008</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nQuantiles:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Quantiles:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"   5th percentile:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag</span><span class="op">$</span><span class="va">alpha</span><span class="op">$</span><span class="va">quantiles</span><span class="op">[</span><span class="st">"q5"</span><span class="op">]</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;    5th percentile: 0.2305</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  25th percentile:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag</span><span class="op">$</span><span class="va">alpha</span><span class="op">$</span><span class="va">quantiles</span><span class="op">[</span><span class="st">"q25"</span><span class="op">]</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   25th percentile: 0.6155</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  50th percentile:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag</span><span class="op">$</span><span class="va">alpha</span><span class="op">$</span><span class="va">quantiles</span><span class="op">[</span><span class="st">"q50"</span><span class="op">]</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   50th percentile: 1.068</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  75th percentile:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag</span><span class="op">$</span><span class="va">alpha</span><span class="op">$</span><span class="va">quantiles</span><span class="op">[</span><span class="st">"q75"</span><span class="op">]</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   75th percentile: 1.7058</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  95th percentile:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag</span><span class="op">$</span><span class="va">alpha</span><span class="op">$</span><span class="va">quantiles</span><span class="op">[</span><span class="st">"q95"</span><span class="op">]</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   95th percentile: 2.992</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="interpreting-the-coefficient-of-variation">3.2 Interpreting the Coefficient of Variation<a class="anchor" aria-label="anchor" href="#interpreting-the-coefficient-of-variation"></a>
</h3>
<p>The coefficient of variation (CV) of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
is particularly informative:</p>
<table class="table">
<colgroup>
<col width="38%">
<col width="61%">
</colgroup>
<thead><tr class="header">
<th>CV Range</th>
<th>Interpretation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>CV &lt; 0.3</td>
<td>
<strong>Highly informative</strong>: You are quite certain about
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
</td>
</tr>
<tr class="even">
<td>0.3 ≤ CV &lt; 0.5</td>
<td>
<strong>Moderately informative</strong>: Reasonable uncertainty</td>
</tr>
<tr class="odd">
<td>0.5 ≤ CV &lt; 1.0</td>
<td>
<strong>Weakly informative</strong>: Substantial uncertainty about
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
</td>
</tr>
<tr class="even">
<td>CV ≥ 1.0</td>
<td>
<strong>Highly diffuse</strong>: Very uncertain about
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
</td>
</tr>
</tbody>
</table>
<p>For a Gamma distribution,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">CV</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mi>/</mi><msqrt><mi>a</mi></msqrt></mrow><annotation encoding="application/x-tex">\text{CV}(\alpha) = 1/\sqrt{a}</annotation></semantics></math>,
so the CV depends only on the shape parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare different CV levels</span></span>
<span><span class="va">a_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">cv_values</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">a_values</span><span class="op">)</span></span>
<span></span>
<span><span class="va">alpha_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">8</span>, length.out <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span>
<span><span class="va">cv_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">a_values</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">a</span> <span class="op">&lt;-</span> <span class="va">a_values</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="co"># Use b = a so E[alpha] = 1 for all</span></span>
<span>  <span class="va">b</span> <span class="op">&lt;-</span> <span class="va">a</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    alpha <span class="op">=</span> <span class="va">alpha_grid</span>,</span>
<span>    density <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></span><span class="op">(</span><span class="va">alpha_grid</span>, shape <span class="op">=</span> <span class="va">a</span>, rate <span class="op">=</span> <span class="va">b</span><span class="op">)</span>,</span>
<span>    CV <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"CV = %.2f (a = %.1f)"</span>, <span class="va">cv_values</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">a</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cv_df</span><span class="op">$</span><span class="va">CV</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">cv_df</span><span class="op">$</span><span class="va">CV</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">cv_df</span><span class="op">$</span><span class="va">CV</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">cv_df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">alpha</span>, y <span class="op">=</span> <span class="va">density</span>, color <span class="op">=</span> <span class="va">CV</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_viridis_d</span><span class="op">(</span>option <span class="op">=</span> <span class="st">"plasma"</span>, end <span class="op">=</span> <span class="fl">0.85</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Density"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Prior Informativeness Controlled by Shape Parameter"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"All priors have E[α] = 1; higher a means lower CV (more informative)"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="diagnostics_files/figure-html/cv-interpretation-1.png" class="r-plt" alt="Different levels of informativeness in the α prior, controlled by the shape parameter a." width="85%"><p class="caption">
Different levels of informativeness in the α prior, controlled by the
shape parameter a.
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="weight-distribution-diagnostics">4. Weight Distribution Diagnostics<a class="anchor" aria-label="anchor" href="#weight-distribution-diagnostics"></a>
</h2>
<p>The weight diagnostics are crucial for detecting unintended prior
behavior. The DPprior package provides comprehensive diagnostics for the
first stick-breaking weight
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math>.</p>
<div class="section level3">
<h3 id="understanding-w_1">4.1 Understanding
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#understanding-w_1"></a>
</h3>
<p>Recall from the <a href="dual-anchor.html">Dual-Anchor vignette</a>
that under Sethuraman’s stick-breaking representation:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>1</mn></msub><mo>=</mo><msub><mi>v</mi><mn>1</mn></msub><mo>,</mo><mspace width="1.0em"></mspace><msub><mi>v</mi><mn>1</mn></msub><mo>∣</mo><mi>α</mi><mo>∼</mo><mtext mathvariant="normal">Beta</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
w_1 = v_1, \quad v_1 \mid \alpha \sim \text{Beta}(1, \alpha)
</annotation></semantics></math></p>
<p>The quantity
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math>
has a natural interpretation: it is the <strong>proportion of the
cluster containing a randomly selected observation</strong>. If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>&gt;</mo><mn>0.5</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(w_1 &gt; 0.5)</annotation></semantics></math>
is high, a random observation is likely to belong to a cluster
containing more than half of all observations.</p>
</div>
<div class="section level3">
<h3 id="accessing-weight-diagnostics">4.2 Accessing Weight Diagnostics<a class="anchor" aria-label="anchor" href="#accessing-weight-diagnostics"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Weight distribution summary:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Weight distribution summary:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  E[w₁] ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">mean</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   E[w₁] = 0.5014</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Median(w₁) ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">median</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Median(w₁) = 0.4784</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nDominance tail probabilities:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Dominance tail probabilities:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  P(w₁ &gt; 0.3) ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">prob_exceeds</span><span class="op">[</span><span class="st">"prob_gt_0.3"</span><span class="op">]</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   P(w₁ &gt; 0.3) = NA</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  P(w₁ &gt; 0.5) ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">prob_exceeds</span><span class="op">[</span><span class="st">"prob_gt_0.5"</span><span class="op">]</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   P(w₁ &gt; 0.5) = 0.4815</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  P(w₁ &gt; 0.7) ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">prob_exceeds</span><span class="op">[</span><span class="st">"prob_gt_0.7"</span><span class="op">]</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   P(w₁ &gt; 0.7) = NA</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  P(w₁ &gt; 0.9) ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">prob_exceeds</span><span class="op">[</span><span class="st">"prob_gt_0.9"</span><span class="op">]</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   P(w₁ &gt; 0.9) = 0.1634</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nDominance risk level:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">toupper</a></span><span class="op">(</span><span class="va">diag</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">dominance_risk</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Dominance risk level: HIGH</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="closed-form-calculations">4.3 Closed-Form Calculations<a class="anchor" aria-label="anchor" href="#closed-form-calculations"></a>
</h3>
<p>All
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math>
diagnostics are computed using closed-form expressions (derived in <a href="https://arxiv.org/abs/2602.06301" class="external-link">Lee, 2026</a>, following <a href="https://doi.org/10.48550/arXiv.2502.00864" class="external-link">Vicentini &amp; Jermyn,
2025</a>):</p>
<p><strong>CDF:</strong>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><msub><mi>w</mi><mn>1</mn></msub></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>∣</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mi>b</mi><mrow><mi>b</mi><mo>−</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>a</mi></msup></mrow><annotation encoding="application/x-tex">
F_{w_1}(x \mid a, b) = 1 - \left( \frac{b}{b - \log(1-x)} \right)^a
</annotation></semantics></math></p>
<p><strong>Quantile function:</strong>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Q</mi><msub><mi>w</mi><mn>1</mn></msub></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo>∣</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mo>−</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mrow><mo stretchy="true" form="prefix">[</mo><mn>1</mn><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn><mi>/</mi><mi>a</mi></mrow></msup><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
Q_{w_1}(u \mid a, b) = 1 - \exp\left( b \left[ 1 - (1-u)^{-1/a} \right] \right)
</annotation></semantics></math></p>
<p><strong>Tail probability (dominance risk):</strong>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>&gt;</mo><mi>t</mi><mo>∣</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mi>b</mi><mrow><mi>b</mi><mo>−</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>a</mi></msup></mrow><annotation encoding="application/x-tex">
P(w_1 &gt; t \mid a, b) = \left( \frac{b}{b - \log(1-t)} \right)^a
</annotation></semantics></math></p>
<p>You can access these functions directly:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="va">fit</span><span class="op">$</span><span class="va">a</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="va">fit</span><span class="op">$</span><span class="va">b</span></span>
<span></span>
<span><span class="co"># Direct computation of tail probabilities</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Direct computation of P(w₁ &gt; t):\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Direct computation of P(w₁ &gt; t):</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">t</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prob_w1_exceeds.html">prob_w1_exceeds</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">a</span>, <span class="va">b</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  P(w₁ &gt; %.1f) = %.4f\n"</span>, <span class="va">t</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt;   P(w₁ &gt; 0.3) = 0.6646</span></span>
<span><span class="co">#&gt;   P(w₁ &gt; 0.5) = 0.4815</span></span>
<span><span class="co">#&gt;   P(w₁ &gt; 0.7) = 0.3200</span></span>
<span><span class="co">#&gt;   P(w₁ &gt; 0.9) = 0.1634</span></span>
<span></span>
<span><span class="co"># Quantiles</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nQuantiles of w₁ distribution:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Quantiles of w₁ distribution:</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">q</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/quantile_w1.html">quantile_w1</a></span><span class="op">(</span><span class="va">q</span>, <span class="va">a</span>, <span class="va">b</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  %d%% quantile: %.4f\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="va">q</span><span class="op">)</span>, <span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt;   25% quantile: 0.2162</span></span>
<span><span class="co">#&gt;   50% quantile: 0.4784</span></span>
<span><span class="co">#&gt;   75% quantile: 0.7911</span></span>
<span><span class="co">#&gt;   95% quantile: 0.9954</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="the-dominance-warning-system">5. The Dominance Warning System<a class="anchor" aria-label="anchor" href="#the-dominance-warning-system"></a>
</h2>
<p>The DPprior package includes an automatic warning system to alert you
when your prior implies a high probability of cluster dominance.</p>
<div class="section level3">
<h3 id="dominance-risk-levels">5.1 Dominance Risk Levels<a class="anchor" aria-label="anchor" href="#dominance-risk-levels"></a>
</h3>
<p>The dominance risk is categorized into three levels based on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>&gt;</mo><mn>0.5</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(w_1 &gt; 0.5)</annotation></semantics></math>:</p>
<table class="table">
<colgroup>
<col width="30%">
<col width="28%">
<col width="41%">
</colgroup>
<thead><tr class="header">
<th>Risk Level</th>
<th>Criterion</th>
<th>Interpretation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>LOW</strong></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>&gt;</mo><mn>0.5</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>&lt;</mo><mn>0.20</mn></mrow><annotation encoding="application/x-tex">P(w_1 &gt; 0.5) &lt; 0.20</annotation></semantics></math></td>
<td>Cluster balance is likely; weights spread across multiple
clusters</td>
</tr>
<tr class="even">
<td><strong>MODERATE</strong></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.20</mn><mo>≤</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>&gt;</mo><mn>0.5</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>&lt;</mo><mn>0.40</mn></mrow><annotation encoding="application/x-tex">0.20 \leq P(w_1 &gt; 0.5) &lt; 0.40</annotation></semantics></math></td>
<td>Some chance of dominance; consider your tolerance</td>
</tr>
<tr class="odd">
<td><strong>HIGH</strong></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>&gt;</mo><mn>0.5</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>≥</mo><mn>0.40</mn></mrow><annotation encoding="application/x-tex">P(w_1 &gt; 0.5) \geq 0.40</annotation></semantics></math></td>
<td>Substantial dominance risk; action recommended</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="enabling-dominance-warnings">5.2 Enabling Dominance Warnings<a class="anchor" aria-label="anchor" href="#enabling-dominance-warnings"></a>
</h3>
<p>You can enable automatic warnings during fitting:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># A prior with high dominance risk</span></span>
<span><span class="va">fit_risky</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_fit.html">DPprior_fit</a></span><span class="op">(</span>J <span class="op">=</span> <span class="fl">50</span>, mu_K <span class="op">=</span> <span class="fl">2</span>, var_K <span class="op">=</span> <span class="fl">2</span>, warn_dominance <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: HIGH DOMINANCE RISK: P(w1 &gt; 0.5) = 85.1% exceeds 40%.</span></span>
<span><span class="co">#&gt;   This may indicate unintended prior behavior (Lee, 2026).</span></span>
<span><span class="co">#&gt;   Consider using DPprior_dual() for weight-constrained elicitation.</span></span>
<span><span class="co">#&gt;   See ?DPprior_diagnostics for interpretation.</span></span></code></pre></div>
<p>When <code>warn_dominance = TRUE</code>, the function will issue a
warning if the dominance risk is HIGH.</p>
</div>
<div class="section level3">
<h3 id="checking-dominance-risk-manually">5.3 Checking Dominance Risk Manually<a class="anchor" aria-label="anchor" href="#checking-dominance-risk-manually"></a>
</h3>
<p>You can also check the dominance risk from the diagnostic object:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">diag_risky</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_diagnostics.html">DPprior_diagnostics</a></span><span class="op">(</span><span class="va">fit_risky</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Dominance risk assessment:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dominance risk assessment:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Risk level:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">toupper</a></span><span class="op">(</span><span class="va">diag_risky</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">dominance_risk</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Risk level: HIGH</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  P(w₁ &gt; 0.5) ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag_risky</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">prob_exceeds</span><span class="op">[</span><span class="st">"prob_gt_0.5"</span><span class="op">]</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   P(w₁ &gt; 0.5) = 0.8511</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="what-high-dominance-means">5.4 What High Dominance Means<a class="anchor" aria-label="anchor" href="#what-high-dominance-means"></a>
</h3>
<p>A HIGH dominance risk means your prior places substantial probability
on scenarios where a single cluster contains more than half of all
observations. This may or may not be appropriate depending on your
application:</p>
<p><strong>When high dominance might be appropriate:</strong></p>
<ul>
<li>You genuinely expect most data to fall into one dominant group</li>
<li>You are modeling rare events where most observations are
“baseline”</li>
<li>You have strong prior evidence of an unbalanced partition</li>
</ul>
<p><strong>When high dominance is likely unintended:</strong></p>
<ul>
<li>You expect roughly equal-sized clusters</li>
<li>You think
“<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
clusters” should mean roughly balanced groups</li>
<li>You are doing exploratory clustering without strong prior
expectations</li>
</ul>
</div>
<div class="section level3">
<h3 id="responding-to-high-dominance-warnings">5.5 Responding to High Dominance Warnings<a class="anchor" aria-label="anchor" href="#responding-to-high-dominance-warnings"></a>
</h3>
<p>If you receive a high dominance warning and it is unintended, you
have several options:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Increase
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mi>K</mi></msub><annotation encoding="application/x-tex">\mu_K</annotation></semantics></math></strong>:
Expecting more clusters typically reduces dominance risk</li>
<li>
<strong>Decrease
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>K</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Var}(K)</annotation></semantics></math></strong>:
More certainty about cluster count can help</li>
<li>
<strong>Use dual-anchor elicitation</strong>: Directly constrain
weight behavior</li>
</ol>
<p>We will demonstrate option 3 in Section 7.</p>
</div>
</div>
<div class="section level2">
<h2 id="visualizing-diagnostics">6. Visualizing Diagnostics<a class="anchor" aria-label="anchor" href="#visualizing-diagnostics"></a>
</h2>
<p>The DPprior package provides several visualization functions for
understanding your prior.</p>
<div class="section level3">
<h3 id="the-complete-dashboard">6.1 The Complete Dashboard<a class="anchor" aria-label="anchor" href="#the-complete-dashboard"></a>
</h3>
<p>The <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method for a <code>DPprior_fit</code> object
creates a comprehensive four-panel dashboard:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_fit.html">DPprior_fit</a></span><span class="op">(</span>J <span class="op">=</span> <span class="fl">50</span>, mu_K <span class="op">=</span> <span class="fl">5</span>, var_K <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: HIGH DOMINANCE RISK: P(w1 &gt; 0.5) = 48.1% exceeds 40%.</span></span>
<span><span class="co">#&gt;   This may indicate unintended prior behavior (Lee, 2026).</span></span>
<span><span class="co">#&gt;   Consider using DPprior_dual() for weight-constrained elicitation.</span></span>
<span><span class="co">#&gt;   See ?DPprior_diagnostics for interpretation.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="diagnostics_files/figure-html/dashboard-1.png" class="r-plt" alt="Complete diagnostic dashboard showing all key prior characteristics." width="85%"><p class="caption">
Complete diagnostic dashboard showing all key prior characteristics.
</p>
</div>
<pre><code><span><span class="co">#&gt; TableGrob (2 x 2) "dpprior_dashboard": 4 grobs</span></span>
<span><span class="co">#&gt;   z     cells              name           grob</span></span>
<span><span class="co">#&gt; 1 1 (1-1,1-1) dpprior_dashboard gtable[layout]</span></span>
<span><span class="co">#&gt; 2 2 (2-2,1-1) dpprior_dashboard gtable[layout]</span></span>
<span><span class="co">#&gt; 3 3 (1-1,2-2) dpprior_dashboard gtable[layout]</span></span>
<span><span class="co">#&gt; 4 4 (2-2,2-2) dpprior_dashboard gtable[layout]</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="individual-diagnostic-plots">6.2 Individual Diagnostic Plots<a class="anchor" aria-label="anchor" href="#individual-diagnostic-plots"></a>
</h3>
<p>For more focused analysis, you can create individual plots:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Alpha prior density</span></span>
<span><span class="fu"><a href="../reference/plot_alpha_prior.html">plot_alpha_prior</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<p><img src="diagnostics_files/figure-html/fig-alpha-plot-1.png" class="r-plt" alt="" width="85%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># K marginal PMF</span></span>
<span><span class="fu"><a href="../reference/plot_K_prior.html">plot_K_prior</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<p><img src="diagnostics_files/figure-html/fig-K-plot-1.png" class="r-plt" alt="" width="85%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># w1 distribution with dominance thresholds</span></span>
<span><span class="fu"><a href="../reference/plot_w1_prior.html">plot_w1_prior</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<p><img src="diagnostics_files/figure-html/fig-w1-plot-1.png" class="r-plt" alt="" width="85%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="comparing-multiple-priors">6.3 Comparing Multiple Priors<a class="anchor" aria-label="anchor" href="#comparing-multiple-priors"></a>
</h3>
<p>When considering different prior specifications, you can visualize
them side by side:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"Low uncertainty (var_K = 6)"</span> <span class="op">=</span> <span class="fu"><a href="../reference/DPprior_fit.html">DPprior_fit</a></span><span class="op">(</span>J <span class="op">=</span> <span class="fl">50</span>, mu_K <span class="op">=</span> <span class="fl">5</span>, var_K <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,</span>
<span>  <span class="st">"Medium uncertainty (var_K = 10)"</span> <span class="op">=</span> <span class="fu"><a href="../reference/DPprior_fit.html">DPprior_fit</a></span><span class="op">(</span>J <span class="op">=</span> <span class="fl">50</span>, mu_K <span class="op">=</span> <span class="fl">5</span>, var_K <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>  <span class="st">"High uncertainty (var_K = 20)"</span> <span class="op">=</span> <span class="fu"><a href="../reference/DPprior_fit.html">DPprior_fit</a></span><span class="op">(</span>J <span class="op">=</span> <span class="fl">50</span>, mu_K <span class="op">=</span> <span class="fl">5</span>, var_K <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: HIGH DOMINANCE RISK: P(w1 &gt; 0.5) = 46.5% exceeds 40%.</span></span>
<span><span class="co">#&gt;   This may indicate unintended prior behavior (Lee, 2026).</span></span>
<span><span class="co">#&gt;   Consider using DPprior_dual() for weight-constrained elicitation.</span></span>
<span><span class="co">#&gt;   See ?DPprior_diagnostics for interpretation.</span></span>
<span><span class="co">#&gt; Warning: HIGH DOMINANCE RISK: P(w1 &gt; 0.5) = 49.7% exceeds 40%.</span></span>
<span><span class="co">#&gt;   This may indicate unintended prior behavior (Lee, 2026).</span></span>
<span><span class="co">#&gt;   Consider using DPprior_dual() for weight-constrained elicitation.</span></span>
<span><span class="co">#&gt;   See ?DPprior_diagnostics for interpretation.</span></span>
<span><span class="co">#&gt; Warning: HIGH DOMINANCE RISK: P(w1 &gt; 0.5) = 56.3% exceeds 40%.</span></span>
<span><span class="co">#&gt;   This may indicate unintended prior behavior (Lee, 2026).</span></span>
<span><span class="co">#&gt;   Consider using DPprior_dual() for weight-constrained elicitation.</span></span>
<span><span class="co">#&gt;   See ?DPprior_diagnostics for interpretation.</span></span>
<span></span>
<span><span class="co"># Compute log Stirling numbers for efficiency</span></span>
<span><span class="va">logS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_log_stirling.html">compute_log_stirling</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Build comparison data</span></span>
<span><span class="va">k_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fits</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">nm</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="va">fits</span><span class="op">[[</span><span class="va">nm</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">pmf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pmf_K_marginal.html">pmf_K_marginal</a></span><span class="op">(</span><span class="fl">50</span>, <span class="va">fit</span><span class="op">$</span><span class="va">a</span>, <span class="va">fit</span><span class="op">$</span><span class="va">b</span>, logS <span class="op">=</span> <span class="va">logS</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    K <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">pmf</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,  <span class="co"># pmf_K_marginal returns k=0,...,J</span></span>
<span>    probability <span class="op">=</span> <span class="va">pmf</span>,</span>
<span>    Prior <span class="op">=</span> <span class="va">nm</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">k_df</span> <span class="op">&lt;-</span> <span class="va">k_df</span><span class="op">[</span><span class="va">k_df</span><span class="op">$</span><span class="va">K</span> <span class="op">&gt;=</span> <span class="fl">1</span>, <span class="op">]</span>  <span class="co"># Remove k=0</span></span>
<span><span class="va">k_df</span><span class="op">$</span><span class="va">Prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">k_df</span><span class="op">$</span><span class="va">Prior</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fits</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">k_df</span><span class="op">[</span><span class="va">k_df</span><span class="op">$</span><span class="va">K</span> <span class="op">&lt;=</span> <span class="fl">20</span>, <span class="op">]</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">K</span>, y <span class="op">=</span> <span class="va">probability</span>, color <span class="op">=</span> <span class="va">Prior</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="va">palette_3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">Number</span><span class="op">~</span><span class="va">of</span><span class="op">~</span><span class="va">clusters</span><span class="op">~</span><span class="va">K</span><span class="op">[</span><span class="va">J</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Probability"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Prior PMF of K Under Different Variance Assumptions"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"All priors have μ_K = 5; higher variance spreads the distribution"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>, legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="diagnostics_files/figure-html/compare-priors-1.png" class="r-plt" alt="Comparison of K distributions under different variance assumptions." width="85%"><p class="caption">
Comparison of K distributions under different variance assumptions.
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="diagnostic-driven-refinement">7. Diagnostic-Driven Refinement<a class="anchor" aria-label="anchor" href="#diagnostic-driven-refinement"></a>
</h2>
<p>The diagnostic tools enable an iterative workflow for refining your
prior until it matches your intentions across all dimensions.</p>
<div class="section level3">
<h3 id="the-refinement-workflow">7.1 The Refinement Workflow<a class="anchor" aria-label="anchor" href="#the-refinement-workflow"></a>
</h3>
<p>The recommended workflow is:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Start with K-only calibration</strong>: Use
<code><a href="../reference/DPprior_fit.html">DPprior_fit()</a></code> with your expectations about cluster
counts</li>
<li>
<strong>Run diagnostics</strong>: Check the implied behavior on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math>,
and dominance</li>
<li>
<strong>Identify mismatches</strong>: Does any aspect of the prior
surprise you?</li>
<li>
<strong>Refine</strong>: Adjust parameters or use dual-anchor if
needed</li>
<li>
<strong>Repeat</strong>: Until all aspects of the prior match your
intentions</li>
</ol>
</div>
<div class="section level3">
<h3 id="complete-example-from-problem-to-solution">7.2 Complete Example: From Problem to Solution<a class="anchor" aria-label="anchor" href="#complete-example-from-problem-to-solution"></a>
</h3>
<p>Let us walk through a complete example of diagnostic-driven
refinement.</p>
<p><strong>Step 1: Initial K-only prior</strong></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Researcher expects ~5 clusters with moderate uncertainty</span></span>
<span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_fit.html">DPprior_fit</a></span><span class="op">(</span>J <span class="op">=</span> <span class="fl">50</span>, mu_K <span class="op">=</span> <span class="fl">5</span>, var_K <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: HIGH DOMINANCE RISK: P(w1 &gt; 0.5) = 48.1% exceeds 40%.</span></span>
<span><span class="co">#&gt;   This may indicate unintended prior behavior (Lee, 2026).</span></span>
<span><span class="co">#&gt;   Consider using DPprior_dual() for weight-constrained elicitation.</span></span>
<span><span class="co">#&gt;   See ?DPprior_diagnostics for interpretation.</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Step 1: Initial K-only prior\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Step 1: Initial K-only prior</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Gamma(a ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">$</span><span class="va">a</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">", b ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">$</span><span class="va">b</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">")\n\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Gamma(a = 2.0361 , b = 1.6051 )</span></span></code></pre></div>
<p><strong>Step 2: Run diagnostics</strong></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">diag1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_diagnostics.html">DPprior_diagnostics</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Step 2: Diagnostics reveal...\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Step 2: Diagnostics reveal...</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  K behavior: E[K] ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag1</span><span class="op">$</span><span class="va">K</span><span class="op">$</span><span class="va">mean</span>, <span class="fl">2</span><span class="op">)</span>, </span>
<span>    <span class="st">", Var(K) ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag1</span><span class="op">$</span><span class="va">K</span><span class="op">$</span><span class="va">var</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"✓\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   K behavior: E[K] = 5 , Var(K) = 8 ✓</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Weight behavior: P(w₁ &gt; 0.5) ="</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag1</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">prob_exceeds</span><span class="op">[</span><span class="st">"prob_gt_0.5"</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Weight behavior: P(w₁ &gt; 0.5) = 0.481</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Dominance risk:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">toupper</a></span><span class="op">(</span><span class="va">diag1</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">dominance_risk</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Dominance risk: HIGH</span></span></code></pre></div>
<p><strong>Step 3: Identify the problem</strong></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_w1_prior.html">plot_w1_prior</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Step 3: Problem identification</span></span>
<span><span class="co">#&gt;   The researcher wanted: ~5 clusters with balanced weights</span></span>
<span><span class="co">#&gt;   The prior implies: ~5 clusters but high chance of one dominant cluster</span></span>
<span><span class="co">#&gt;   P(w₁ &gt; 0.5) = 48 % is higher than expected for 'balanced' clusters</span></span></code></pre>
<p><img src="diagnostics_files/figure-html/refinement-step3-1.png" class="r-plt" alt="" width="85%" style="display: block; margin: auto;"></p>
<p><strong>Step 4: Apply dual-anchor refinement</strong></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Step 4: Dual-anchor refinement\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Step 4: Dual-anchor refinement</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Adding constraint: P(w₁ &gt; 0.5) ≤ 0.25\n\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Adding constraint: P(w₁ &gt; 0.5) ≤ 0.25</span></span>
<span></span>
<span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_dual.html">DPprior_dual</a></span><span class="op">(</span></span>
<span>  fit <span class="op">=</span> <span class="va">fit1</span>,</span>
<span>  w1_target <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>threshold <span class="op">=</span> <span class="fl">0.5</span>, value <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  lambda <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  loss_type <span class="op">=</span> <span class="st">"adaptive"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Refined prior: Gamma(a ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">$</span><span class="va">a</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">", b ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">$</span><span class="va">b</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">")\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Refined prior: Gamma(a = 4.3948 , b = 2.5043 )</span></span></code></pre></div>
<p><strong>Step 5: Re-run diagnostics</strong></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">diag2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_diagnostics.html">DPprior_diagnostics</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Step 5: Post-refinement diagnostics\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Step 5: Post-refinement diagnostics</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  K behavior: E[K] ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag2</span><span class="op">$</span><span class="va">K</span><span class="op">$</span><span class="va">mean</span>, <span class="fl">2</span><span class="op">)</span>, </span>
<span>    <span class="st">" (shifted from target of 5)\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   K behavior: E[K] = 6.3  (shifted from target of 5)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Weight behavior: P(w₁ &gt; 0.5) ="</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag2</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">prob_exceeds</span><span class="op">[</span><span class="st">"prob_gt_0.5"</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"✓\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Weight behavior: P(w₁ &gt; 0.5) = 0.342 ✓</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Dominance risk:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">toupper</a></span><span class="op">(</span><span class="va">diag2</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">dominance_risk</span><span class="op">)</span>, <span class="st">"✓\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Dominance risk: MODERATE ✓</span></span></code></pre></div>
<p><strong>Step 6: Visualize the improvement</strong></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare w1 distributions</span></span>
<span><span class="va">x_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.001</span>, <span class="fl">0.999</span>, length.out <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span><span class="va">w1_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">x_grid</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  density <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/density_w1.html">density_w1</a></span><span class="op">(</span><span class="va">x_grid</span>, <span class="va">fit1</span><span class="op">$</span><span class="va">a</span>, <span class="va">fit1</span><span class="op">$</span><span class="va">b</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/density_w1.html">density_w1</a></span><span class="op">(</span><span class="va">x_grid</span>, <span class="va">fit2</span><span class="op">$</span><span class="va">a</span>, <span class="va">fit2</span><span class="op">$</span><span class="va">b</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  Prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"K-only (before)"</span>, <span class="st">"Dual-anchor (after)"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x_grid</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">w1_df</span><span class="op">$</span><span class="va">Prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">w1_df</span><span class="op">$</span><span class="va">Prior</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"K-only (before)"</span>, <span class="st">"Dual-anchor (after)"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Cap extreme densities for visualization</span></span>
<span><span class="va">w1_df</span><span class="op">$</span><span class="va">density</span><span class="op">[</span><span class="va">w1_df</span><span class="op">$</span><span class="va">density</span> <span class="op">&gt;</span> <span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">w1_df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">density</span>, color <span class="op">=</span> <span class="va">Prior</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0.5</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"gray50"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">0.52</span>, y <span class="op">=</span> <span class="fl">5</span>, label <span class="op">=</span> <span class="st">"P(w₁ &gt; 0.5)"</span>, hjust <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"gray40"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">w</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Density"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Weight Distribution: Before and After Dual-Anchor Refinement"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"P(w₁ &gt; 0.5): Before = %.0f%%, After = %.0f%%"</span>,</span>
<span>                       <span class="fl">100</span> <span class="op">*</span> <span class="va">diag1</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">prob_exceeds</span><span class="op">[</span><span class="st">"prob_gt_0.5"</span><span class="op">]</span>,</span>
<span>                       <span class="fl">100</span> <span class="op">*</span> <span class="va">diag2</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">prob_exceeds</span><span class="op">[</span><span class="st">"prob_gt_0.5"</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>, legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="diagnostics_files/figure-html/refinement-step6-1.png" class="r-plt" alt="Comparison of weight distributions before and after dual-anchor refinement." width="85%"><p class="caption">
Comparison of weight distributions before and after dual-anchor
refinement.
</p>
</div>
</div>
<div class="section level3">
<h3 id="summary-of-the-refinement">7.3 Summary of the Refinement<a class="anchor" aria-label="anchor" href="#summary-of-the-refinement"></a>
</h3>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">comparison_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Metric <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gamma(a, b)"</span>, <span class="st">"E[K]"</span>, <span class="st">"Var(K)"</span>, <span class="st">"E[w₁]"</span>, </span>
<span>             <span class="st">"P(w₁ &gt; 0.5)"</span>, <span class="st">"Dominance Risk"</span><span class="op">)</span>,</span>
<span>  Before <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"(%.3f, %.3f)"</span>, <span class="va">fit1</span><span class="op">$</span><span class="va">a</span>, <span class="va">fit1</span><span class="op">$</span><span class="va">b</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="va">diag1</span><span class="op">$</span><span class="va">K</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="va">diag1</span><span class="op">$</span><span class="va">K</span><span class="op">$</span><span class="va">var</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%.3f"</span>, <span class="va">diag1</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%.1f%%"</span>, <span class="fl">100</span> <span class="op">*</span> <span class="va">diag1</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">prob_exceeds</span><span class="op">[</span><span class="st">"prob_gt_0.5"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">toupper</a></span><span class="op">(</span><span class="va">diag1</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">dominance_risk</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  After <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"(%.3f, %.3f)"</span>, <span class="va">fit2</span><span class="op">$</span><span class="va">a</span>, <span class="va">fit2</span><span class="op">$</span><span class="va">b</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="va">diag2</span><span class="op">$</span><span class="va">K</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="va">diag2</span><span class="op">$</span><span class="va">K</span><span class="op">$</span><span class="va">var</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%.3f"</span>, <span class="va">diag2</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%.1f%%"</span>, <span class="fl">100</span> <span class="op">*</span> <span class="va">diag2</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">prob_exceeds</span><span class="op">[</span><span class="st">"prob_gt_0.5"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">toupper</a></span><span class="op">(</span><span class="va">diag2</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">dominance_risk</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span></span>
<span>  <span class="va">comparison_df</span>,</span>
<span>  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Metric"</span>, <span class="st">"K-only"</span>, <span class="st">"Dual-anchor"</span><span class="op">)</span>,</span>
<span>  caption <span class="op">=</span> <span class="st">"Comparison of prior specifications before and after dual-anchor refinement"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Comparison of prior specifications before and after dual-anchor
refinement</caption>
<thead><tr class="header">
<th align="left">Metric</th>
<th align="left">K-only</th>
<th align="left">Dual-anchor</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Gamma(a, b)</td>
<td align="left">(2.036, 1.605)</td>
<td align="left">(4.395, 2.504)</td>
</tr>
<tr class="even">
<td align="left">E[K]</td>
<td align="left">5.00</td>
<td align="left">6.30</td>
</tr>
<tr class="odd">
<td align="left">Var(K)</td>
<td align="left">8.00</td>
<td align="left">7.72</td>
</tr>
<tr class="even">
<td align="left">E[w₁]</td>
<td align="left">0.501</td>
<td align="left">0.396</td>
</tr>
<tr class="odd">
<td align="left">P(w₁ &gt; 0.5)</td>
<td align="left">48.1%</td>
<td align="left">34.2%</td>
</tr>
<tr class="even">
<td align="left">Dominance Risk</td>
<td align="left">HIGH</td>
<td align="left">MODERATE</td>
</tr>
</tbody>
</table>
<p>The trade-off is clear: the refined prior has slightly higher E[K]
than the original target of 5, but now has appropriately controlled
weight behavior. This is the Pareto trade-off that the dual-anchor
framework makes explicit.</p>
</div>
</div>
<div class="section level2">
<h2 id="comparative-diagnostics">8. Comparative Diagnostics<a class="anchor" aria-label="anchor" href="#comparative-diagnostics"></a>
</h2>
<p>When evaluating multiple candidate priors, comparative diagnostics
help you understand the trade-offs.</p>
<div class="section level3">
<h3 id="comparing-multiple-priors-1">8.1 Comparing Multiple Priors<a class="anchor" aria-label="anchor" href="#comparing-multiple-priors-1"></a>
</h3>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define three candidate priors</span></span>
<span><span class="va">candidates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"Conservative"</span> <span class="op">=</span> <span class="fu"><a href="../reference/DPprior_fit.html">DPprior_fit</a></span><span class="op">(</span>J <span class="op">=</span> <span class="fl">50</span>, mu_K <span class="op">=</span> <span class="fl">5</span>, var_K <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,</span>
<span>  <span class="st">"Moderate"</span> <span class="op">=</span> <span class="fu"><a href="../reference/DPprior_fit.html">DPprior_fit</a></span><span class="op">(</span>J <span class="op">=</span> <span class="fl">50</span>, mu_K <span class="op">=</span> <span class="fl">5</span>, var_K <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>  <span class="st">"Diffuse"</span> <span class="op">=</span> <span class="fu"><a href="../reference/DPprior_fit.html">DPprior_fit</a></span><span class="op">(</span>J <span class="op">=</span> <span class="fl">50</span>, mu_K <span class="op">=</span> <span class="fl">5</span>, var_K <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: HIGH DOMINANCE RISK: P(w1 &gt; 0.5) = 46.5% exceeds 40%.</span></span>
<span><span class="co">#&gt;   This may indicate unintended prior behavior (Lee, 2026).</span></span>
<span><span class="co">#&gt;   Consider using DPprior_dual() for weight-constrained elicitation.</span></span>
<span><span class="co">#&gt;   See ?DPprior_diagnostics for interpretation.</span></span>
<span><span class="co">#&gt; Warning: HIGH DOMINANCE RISK: P(w1 &gt; 0.5) = 49.7% exceeds 40%.</span></span>
<span><span class="co">#&gt;   This may indicate unintended prior behavior (Lee, 2026).</span></span>
<span><span class="co">#&gt;   Consider using DPprior_dual() for weight-constrained elicitation.</span></span>
<span><span class="co">#&gt;   See ?DPprior_diagnostics for interpretation.</span></span>
<span><span class="co">#&gt; Warning: HIGH DOMINANCE RISK: P(w1 &gt; 0.5) = 56.3% exceeds 40%.</span></span>
<span><span class="co">#&gt;   This may indicate unintended prior behavior (Lee, 2026).</span></span>
<span><span class="co">#&gt;   Consider using DPprior_dual() for weight-constrained elicitation.</span></span>
<span><span class="co">#&gt;   See ?DPprior_diagnostics for interpretation.</span></span>
<span></span>
<span><span class="co"># Compute diagnostics for each</span></span>
<span><span class="va">comp_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">candidates</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">nm</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="va">candidates</span><span class="op">[[</span><span class="va">nm</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">diag</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_diagnostics.html">DPprior_diagnostics</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    Prior <span class="op">=</span> <span class="va">nm</span>,</span>
<span>    a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">a</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">b</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    E_K <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag</span><span class="op">$</span><span class="va">K</span><span class="op">$</span><span class="va">mean</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    Var_K <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag</span><span class="op">$</span><span class="va">K</span><span class="op">$</span><span class="va">var</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    E_w1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diag</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">mean</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    P_w1_gt_50 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%.1f%%"</span>, <span class="fl">100</span> <span class="op">*</span> <span class="va">diag</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">prob_exceeds</span><span class="op">[</span><span class="st">"prob_gt_0.5"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    Risk <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">toupper</a></span><span class="op">(</span><span class="va">diag</span><span class="op">$</span><span class="va">weights</span><span class="op">$</span><span class="va">dominance_risk</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">comp_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">comp_results</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span></span>
<span>  <span class="va">comp_df</span>,</span>
<span>  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Prior"</span>, <span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"E[K]"</span>, <span class="st">"Var(K)"</span>, <span class="st">"E[w₁]"</span>, <span class="st">"P(w₁&gt;0.5)"</span>, <span class="st">"Risk"</span><span class="op">)</span>,</span>
<span>  caption <span class="op">=</span> <span class="st">"Comparative diagnostics for three candidate priors"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Comparative diagnostics for three candidate priors</caption>
<thead><tr class="header">
<th align="left">Prior</th>
<th align="right">a</th>
<th align="right">b</th>
<th align="right">E[K]</th>
<th align="right">Var(K)</th>
<th align="right">E[w₁]</th>
<th align="left">P(w₁&gt;0.5)</th>
<th align="left">Risk</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Conservative</td>
<td align="right">3.568</td>
<td align="right">2.900</td>
<td align="right">5</td>
<td align="right">6</td>
<td align="right">0.484</td>
<td align="left">46.5%</td>
<td align="left">HIGH</td>
</tr>
<tr class="even">
<td align="left">Moderate</td>
<td align="right">1.408</td>
<td align="right">1.077</td>
<td align="right">5</td>
<td align="right">10</td>
<td align="right">0.518</td>
<td align="left">49.7%</td>
<td align="left">HIGH</td>
</tr>
<tr class="odd">
<td align="left">Diffuse</td>
<td align="right">0.518</td>
<td align="right">0.341</td>
<td align="right">5</td>
<td align="right">20</td>
<td align="right">0.585</td>
<td align="left">56.3%</td>
<td align="left">HIGH</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="visualizing-the-comparison">8.2 Visualizing the Comparison<a class="anchor" aria-label="anchor" href="#visualizing-the-comparison"></a>
</h3>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create comparison data for w1</span></span>
<span><span class="va">w1_comp_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">candidates</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">nm</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="va">candidates</span><span class="op">[[</span><span class="va">nm</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.001</span>, <span class="fl">0.999</span>, length.out <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span>
<span>  <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/density_w1.html">density_w1</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">fit</span><span class="op">$</span><span class="va">a</span>, <span class="va">fit</span><span class="op">$</span><span class="va">b</span><span class="op">)</span></span>
<span>  <span class="va">d</span><span class="op">[</span><span class="va">d</span> <span class="op">&gt;</span> <span class="fl">8</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, density <span class="op">=</span> <span class="va">d</span>, Prior <span class="op">=</span> <span class="va">nm</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">w1_comp_df</span><span class="op">$</span><span class="va">Prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">w1_comp_df</span><span class="op">$</span><span class="va">Prior</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">candidates</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">w1_comp_df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">density</span>, color <span class="op">=</span> <span class="va">Prior</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0.5</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"gray60"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="va">palette_3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">w</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, y <span class="op">=</span> <span class="st">"Density"</span>, </span>
<span>       title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Prior on "</span> <span class="op">*</span> <span class="va">w</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>, legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create comparison data for K</span></span>
<span><span class="va">logS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_log_stirling.html">compute_log_stirling</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">k_comp_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">candidates</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">nm</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="va">candidates</span><span class="op">[[</span><span class="va">nm</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">pmf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pmf_K_marginal.html">pmf_K_marginal</a></span><span class="op">(</span><span class="fl">50</span>, <span class="va">fit</span><span class="op">$</span><span class="va">a</span>, <span class="va">fit</span><span class="op">$</span><span class="va">b</span>, logS <span class="op">=</span> <span class="va">logS</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">pmf</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>, pmf <span class="op">=</span> <span class="va">pmf</span>, Prior <span class="op">=</span> <span class="va">nm</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">k_comp_df</span> <span class="op">&lt;-</span> <span class="va">k_comp_df</span><span class="op">[</span><span class="va">k_comp_df</span><span class="op">$</span><span class="va">k</span> <span class="op">&gt;=</span> <span class="fl">1</span>, <span class="op">]</span></span>
<span><span class="va">k_comp_df</span><span class="op">$</span><span class="va">Prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">k_comp_df</span><span class="op">$</span><span class="va">Prior</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">candidates</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">k_comp_df</span><span class="op">[</span><span class="va">k_comp_df</span><span class="op">$</span><span class="va">k</span> <span class="op">&lt;=</span> <span class="fl">15</span>, <span class="op">]</span>, </span>
<span>             <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">k</span>, y <span class="op">=</span> <span class="va">pmf</span>, color <span class="op">=</span> <span class="va">Prior</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="va">palette_3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">K</span><span class="op">[</span><span class="va">J</span><span class="op">]</span><span class="op">)</span>, y <span class="op">=</span> <span class="st">"Probability"</span>, </span>
<span>       title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Prior PMF of "</span> <span class="op">*</span> <span class="va">K</span><span class="op">[</span><span class="va">J</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>, legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="diagnostics_files/figure-html/comparative-viz-1.png" class="r-plt" alt="Comparison of three candidate priors across multiple dimensions." width="85%"><p class="caption">
Comparison of three candidate priors across multiple dimensions.
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<table class="table">
<colgroup>
<col width="38%">
<col width="30%">
<col width="30%">
</colgroup>
<thead><tr class="header">
<th>Diagnostic Aspect</th>
<th>What to Check</th>
<th>Concern If…</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
CV</td>
<td><code>diag$alpha$cv</code></td>
<td>CV &gt; 1 (very diffuse) or CV &lt; 0.3 (very tight) without
intention</td>
</tr>
<tr class="even">
<td>E[K]</td>
<td><code>diag$K$mean</code></td>
<td>Differs substantially from your target
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mi>K</mi></msub><annotation encoding="application/x-tex">\mu_K</annotation></semantics></math>
</td>
</tr>
<tr class="odd">
<td>Var(K)</td>
<td><code>diag$K$var</code></td>
<td>Differs substantially from your target or implied variance</td>
</tr>
<tr class="even">
<td>P(w₁ &gt; 0.5)</td>
<td><code>diag$weights$prob_exceeds["prob_gt_0.5"]</code></td>
<td>&gt; 40% without intending high dominance</td>
</tr>
<tr class="odd">
<td>Dominance Risk</td>
<td><code>diag$weights$dominance_risk</code></td>
<td>“high” when you expect balanced clusters</td>
</tr>
</tbody>
</table>
<p><strong>Key Takeaways:</strong></p>
<ol style="list-style-type: decimal">
<li>
<strong>Always run diagnostics</strong> after eliciting a prior,
especially for weight-related quantities</li>
<li>
<strong>K-calibration is necessary but not sufficient</strong>:
matching E[K] does not guarantee intuitive weight behavior</li>
<li>
<strong>Use the dominance warning system</strong> to catch potential
problems early</li>
<li>
<strong>Apply dual-anchor refinement</strong> when you need to
constrain weight behavior explicitly</li>
<li>
<strong>Iterate until satisfied</strong>: prior elicitation is an
iterative process</li>
</ol>
</div>
<div class="section level2">
<h2 id="whats-next">What’s Next?<a class="anchor" aria-label="anchor" href="#whats-next"></a>
</h2>
<ul>
<li><p><strong><a href="dual-anchor.html">Dual-Anchor
Framework</a></strong>: Deep dive into controlling both cluster counts
and weight behavior</p></li>
<li><p><strong><a href="case-studies.html">Case Studies</a></strong>:
Real-world examples of diagnostic-driven prior refinement</p></li>
<li><p><strong><a href="theory-overview.html">Theory
Overview</a></strong>: Mathematical foundations of the diagnostic
quantities</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Lee, J., Che, J., Rabe-Hesketh, S., Feller, A., &amp; Miratrix, L.
(2025). Improving the estimation of site-specific effects and their
distribution in multisite trials. <em>Journal of Educational and
Behavioral Statistics</em>, 50(5), 731–764. <a href="https://doi.org/10.3102/10769986241254286" class="external-link uri">https://doi.org/10.3102/10769986241254286</a></p>
<p>Vicentini, S., &amp; Jermyn, I. H. (2025). Prior selection for the
precision parameter of Dirichlet process mixture models.
<em>arXiv:2502.00864</em>. <a href="https://doi.org/10.48550/arXiv.2502.00864" class="external-link uri">https://doi.org/10.48550/arXiv.2502.00864</a></p>
<p>Sethuraman, J. (1994). A constructive definition of Dirichlet priors.
<em>Statistica Sinica</em>, 4(2), 639–650.</p>
<hr>
<p><em>For questions or feedback, please visit the <a href="https://github.com/joonho112/DPprior" class="external-link">GitHub
repository</a>.</em></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/joonho112" class="external-link">JoonHo Lee</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
