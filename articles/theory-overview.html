<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Mathematical Foundations: The K Distribution and Gamma Hyperpriors ‚Ä¢ DPprior</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="‚Äùimage/svg+xml‚Äù" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Mathematical Foundations: The K Distribution and Gamma Hyperpriors">
<meta name="description" content="A comprehensive treatment of the mathematical foundations underlying the  DPprior package, including the exact distribution of the number of clusters  K_J, moment calculations, and the theory behind Gamma hyperprior elicitation.
">
<meta property="og:description" content="A comprehensive treatment of the mathematical foundations underlying the  DPprior package, including the exact distribution of the number of clusters  K_J, moment calculations, and the theory behind Gamma hyperprior elicitation.
">
<meta property="og:image" content="https://joonho112.github.io/DPprior/logo.svg">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DPprior</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><h6 class="dropdown-header" data-toc-skip>--- Applied Track ---</h6></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/quick-start.html">Quick Start</a></li>
    <li><a class="dropdown-item" href="../articles/applied-guide.html">Applied Guide</a></li>
    <li><a class="dropdown-item" href="../articles/dual-anchor.html">Dual-Anchor Framework</a></li>
    <li><a class="dropdown-item" href="../articles/diagnostics.html">Diagnostics</a></li>
    <li><a class="dropdown-item" href="../articles/case-studies.html">Case Studies</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>--- Methodological Track ---</h6></li>
    <li><a class="dropdown-item" href="../articles/theory-overview.html">Theory Overview</a></li>
    <li><a class="dropdown-item" href="../articles/theory-stirling.html">Stirling Numbers</a></li>
    <li><a class="dropdown-item" href="../articles/theory-approximations.html">Approximations (A1)</a></li>
    <li><a class="dropdown-item" href="../articles/theory-newton.html">Newton Algorithm (A2)</a></li>
    <li><a class="dropdown-item" href="../articles/theory-weights.html">Weight Distributions</a></li>
    <li><a class="dropdown-item" href="../articles/api-reference.html">API Reference</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/joonho112/DPprior/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Mathematical Foundations: The K Distribution and Gamma Hyperpriors</h1>
                        <h4 data-toc-skip class="author">JoonHo Lee</h4>
            
            <h4 data-toc-skip class="date">2026-02-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/joonho112/DPprior/blob/main/vignettes/theory-overview.Rmd" class="external-link"><code>vignettes/theory-overview.Rmd</code></a></small>
      <div class="d-none name"><code>theory-overview.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This vignette provides a rigorous mathematical treatment of the
theory underlying the DPprior package. It is intended for statisticians
and methodological researchers who wish to understand the exact
distributional properties of the number of clusters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>J</mi></msub><annotation encoding="application/x-tex">K_J</annotation></semantics></math>
in Dirichlet Process (DP) models, and how these properties inform the
design of Gamma hyperprior elicitation procedures.</p>
<p>We cover:</p>
<ol style="list-style-type: decimal">
<li>The Dirichlet Process and its representations</li>
<li>The exact distribution of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>J</mi></msub><mo stretchy="false" form="prefix">|</mo><mi>Œ±</mi></mrow><annotation encoding="application/x-tex">K_J | \alpha</annotation></semantics></math>
(Antoniak distribution)</li>
<li>Conditional and marginal moments of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>J</mi></msub><annotation encoding="application/x-tex">K_J</annotation></semantics></math>
</li>
<li>The inverse problem: mapping from moments to Gamma
hyperparameters</li>
<li>Numerical algorithms for stable computation</li>
</ol>
<p>Throughout, we carefully distinguish between <strong>established
results</strong> from the literature and <strong>novel
contributions</strong> of this work.</p>
</div>
<div class="section level2">
<h2 id="the-dirichlet-process-a-brief-review">1. The Dirichlet Process: A Brief Review<a class="anchor" aria-label="anchor" href="#the-dirichlet-process-a-brief-review"></a>
</h2>
<div class="section level3">
<h3 id="fergusons-definition">1.1 Ferguson‚Äôs Definition<a class="anchor" aria-label="anchor" href="#fergusons-definition"></a>
</h3>
<p>The Dirichlet Process (DP) was introduced by Ferguson (1973) as a
prior distribution on the space of probability measures. Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>G</mi><mn>0</mn></msub><annotation encoding="application/x-tex">G_0</annotation></semantics></math>
be a base probability measure on a measurable space
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œò</mi><mo>,</mo><mi>‚Ñ¨</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\Theta, \mathcal{B})</annotation></semantics></math>,
and let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ±</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\alpha &gt; 0</annotation></semantics></math>
be the concentration (or precision) parameter.</p>
<p><strong>Definition (Ferguson, 1973).</strong> A random probability
measure
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>
follows a Dirichlet Process with concentration
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ±</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
and base measure
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>G</mi><mn>0</mn></msub><annotation encoding="application/x-tex">G_0</annotation></semantics></math>,
written
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo>‚àº</mo><mtext mathvariant="normal">DP</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo>,</mo><msub><mi>G</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">G \sim \text{DP}(\alpha, G_0)</annotation></semantics></math>,
if for every finite measurable partition
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>A</mi><mn>1</mn></msub><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><msub><mi>A</mi><mi>m</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(A_1, \ldots, A_m)</annotation></semantics></math>
of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œò</mi><annotation encoding="application/x-tex">\Theta</annotation></semantics></math>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>G</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>A</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><mi>G</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>A</mi><mi>m</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àº</mo><mtext mathvariant="normal">Dirichlet</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><msub><mi>G</mi><mn>0</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>A</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><mi>Œ±</mi><msub><mi>G</mi><mn>0</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>A</mi><mi>m</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
(G(A_1), \ldots, G(A_m)) \sim \text{Dirichlet}(\alpha G_0(A_1), \ldots, \alpha G_0(A_m)).
</annotation></semantics></math></p>
<p>A fundamental property of draws from a DP is that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>
is almost surely discrete, even when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>G</mi><mn>0</mn></msub><annotation encoding="application/x-tex">G_0</annotation></semantics></math>
is continuous. This discreteness is the source of the clustering
behavior in DP mixture models.</p>
</div>
<div class="section level3">
<h3 id="the-stick-breaking-construction">1.2 The Stick-Breaking Construction<a class="anchor" aria-label="anchor" href="#the-stick-breaking-construction"></a>
</h3>
<p>Sethuraman (1994) provided a constructive representation of the DP
that illuminates its structure. A draw
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo>‚àº</mo><mtext mathvariant="normal">DP</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo>,</mo><msub><mi>G</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">G \sim \text{DP}(\alpha, G_0)</annotation></semantics></math>
can be written as:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo>=</mo><munderover><mo>‚àë</mo><mrow><mi>h</mi><mo>=</mo><mn>1</mn></mrow><mo accent="false">‚àû</mo></munderover><msub><mi>w</mi><mi>h</mi></msub><msub><mi>Œ¥</mi><msub><mi>Œ∏</mi><mi>h</mi></msub></msub><mo>,</mo></mrow><annotation encoding="application/x-tex">
G = \sum_{h=1}^{\infty} w_h \delta_{\theta_h},
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><msub><mi>Œ∏</mi><mi>h</mi></msub><msubsup><mo stretchy="false" form="postfix">}</mo><mrow><mi>h</mi><mo>=</mo><mn>1</mn></mrow><mi>‚àû</mi></msubsup><mover><mo>‚àº</mo><mrow><mi>i</mi><mi>i</mi><mi>d</mi></mrow></mover><msub><mi>G</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\{\theta_h\}_{h=1}^{\infty} \stackrel{iid}{\sim} G_0</annotation></semantics></math>
are the atom locations and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><msub><mi>w</mi><mi>h</mi></msub><msubsup><mo stretchy="false" form="postfix">}</mo><mrow><mi>h</mi><mo>=</mo><mn>1</mn></mrow><mi>‚àû</mi></msubsup></mrow><annotation encoding="application/x-tex">\{w_h\}_{h=1}^{\infty}</annotation></semantics></math>
are the stick-breaking weights defined by:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>1</mn></msub><mo>=</mo><msub><mi>v</mi><mn>1</mn></msub><mo>,</mo><mspace width="1.0em"></mspace><msub><mi>w</mi><mi>h</mi></msub><mo>=</mo><msub><mi>v</mi><mi>h</mi></msub><munder><mo>‚àè</mo><mrow><mo>‚Ñì</mo><mo>&lt;</mo><mi>h</mi></mrow></munder><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><msub><mi>v</mi><mo>‚Ñì</mo></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="1.0em"></mspace><msub><mi>v</mi><mi>h</mi></msub><mover><mo>‚àº</mo><mrow><mi>i</mi><mi>i</mi><mi>d</mi></mrow></mover><mtext mathvariant="normal">Beta</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
w_1 = v_1, \quad w_h = v_h \prod_{\ell &lt; h}(1 - v_\ell), \quad v_h \stackrel{iid}{\sim} \text{Beta}(1, \alpha).
</annotation></semantics></math></p>
<p>The weights
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>,</mo><msub><mi>w</mi><mn>2</mn></msub><mo>,</mo><mi>‚Ä¶</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(w_1, w_2, \ldots)</annotation></semantics></math>
form a random probability distribution on the positive integers, with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>‚àë</mo><mrow><mi>h</mi><mo>=</mo><mn>1</mn></mrow><mi>‚àû</mi></msubsup><msub><mi>w</mi><mi>h</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sum_{h=1}^{\infty} w_h = 1</annotation></semantics></math>
almost surely.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Demonstrate stick-breaking for different alpha values</span></span>
<span><span class="va">n_atoms</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">alpha_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">sb_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">alpha_values</span>, <span class="kw">function</span><span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Simulate stick-breaking</span></span>
<span>  <span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="va">n_atoms</span>, <span class="fl">1</span>, <span class="va">a</span><span class="op">)</span></span>
<span>  <span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">n_atoms</span><span class="op">)</span></span>
<span>  <span class="va">w</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">v</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">h</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="va">n_atoms</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">w</span><span class="op">[</span><span class="va">h</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">v</span><span class="op">[</span><span class="va">h</span><span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/prod.html" class="external-link">prod</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">v</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">h</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    atom <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_atoms</span>,</span>
<span>    weight <span class="op">=</span> <span class="va">w</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Œ± = "</span>, <span class="va">a</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sb_data</span><span class="op">$</span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">sb_data</span><span class="op">$</span><span class="va">alpha</span>, </span>
<span>                        levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Œ± = "</span>, <span class="va">alpha_values</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">sb_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">atom</span>, y <span class="op">=</span> <span class="va">weight</span>, fill <span class="op">=</span> <span class="va">alpha</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">alpha</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="va">palette_main</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Atom Index (h)"</span>, y <span class="op">=</span> <span class="st">"Weight (w_h)"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Stick-Breaking Weights by Concentration Parameter"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="theory-overview_files/figure-html/stick-breaking-demo-1.png" class="r-plt" alt="Stick-breaking weights for different values of Œ±. Smaller Œ± leads to more concentration on early atoms." width="85%"><p class="caption">
Stick-breaking weights for different values of Œ±. Smaller Œ± leads to
more concentration on early atoms.
</p>
</div>
</div>
<div class="section level3">
<h3 id="the-chinese-restaurant-process">1.3 The Chinese Restaurant Process<a class="anchor" aria-label="anchor" href="#the-chinese-restaurant-process"></a>
</h3>
<p>The Chinese Restaurant Process (CRP) provides an intuitive
characterization of DP-induced partitions (Blackwell &amp; MacQueen,
1973). Consider
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>J</mi><annotation encoding="application/x-tex">J</annotation></semantics></math>
exchangeable observations
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œ∏</mi><mn>1</mn></msub><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><msub><mi>Œ∏</mi><mi>J</mi></msub><mo stretchy="false" form="prefix">|</mo><mi>G</mi><mover><mo>‚àº</mo><mrow><mi>i</mi><mi>i</mi><mi>d</mi></mrow></mover><mi>G</mi></mrow><annotation encoding="application/x-tex">\theta_1, \ldots, \theta_J | G \stackrel{iid}{\sim} G</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo>‚àº</mo><mtext mathvariant="normal">DP</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo>,</mo><msub><mi>G</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">G \sim \text{DP}(\alpha, G_0)</annotation></semantics></math>.
The CRP describes the sequential assignment of observations to
clusters:</p>
<ul>
<li>Customer 1 sits at table 1 (creates the first cluster).</li>
<li>For
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>2</mn><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><mi>J</mi></mrow><annotation encoding="application/x-tex">i = 2, \ldots, J</annotation></semantics></math>,
customer
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
either:
<ul>
<li>Joins existing table
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
with probability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><msub><mi>n</mi><mi>c</mi></msub><mrow><mi>Œ±</mi><mo>+</mo><mi>i</mi><mo>‚àí</mo><mn>1</mn></mrow></mfrac><annotation encoding="application/x-tex">\frac{n_c}{\alpha + i - 1}</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mi>c</mi></msub><annotation encoding="application/x-tex">n_c</annotation></semantics></math>
is the current occupancy of table
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>;
or</li>
<li>Starts a new table with probability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mi>Œ±</mi><mrow><mi>Œ±</mi><mo>+</mo><mi>i</mi><mo>‚àí</mo><mn>1</mn></mrow></mfrac><annotation encoding="application/x-tex">\frac{\alpha}{\alpha + i - 1}</annotation></semantics></math>.</li>
</ul>
</li>
</ul>
<p>This process generates an exchangeable random partition of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><mi>J</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{1, \ldots, J\}</annotation></semantics></math>.
Importantly, the number of occupied tables after
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>J</mi><annotation encoding="application/x-tex">J</annotation></semantics></math>
customers equals
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>J</mi></msub><annotation encoding="application/x-tex">K_J</annotation></semantics></math>,
the number of distinct clusters among the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>J</mi><annotation encoding="application/x-tex">J</annotation></semantics></math>
observations.</p>
</div>
</div>
<div class="section level2">
<h2 id="the-distribution-of-k_j-alpha">2. The Distribution of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>J</mi></msub><mo stretchy="false" form="prefix">|</mo><mi>Œ±</mi></mrow><annotation encoding="application/x-tex">K_J | \alpha</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#the-distribution-of-k_j-alpha"></a>
</h2>
<div class="section level3">
<h3 id="the-poisson-binomial-representation">2.1 The Poisson-Binomial Representation<a class="anchor" aria-label="anchor" href="#the-poisson-binomial-representation"></a>
</h3>
<p>The CRP immediately yields a useful representation of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>J</mi></msub><annotation encoding="application/x-tex">K_J</annotation></semantics></math>.</p>
<p><strong>Theorem 1 (Poisson-Binomial Representation).</strong>
<em>Conditionally on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ±</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>,
the number of clusters satisfies</em>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>J</mi></msub><mover><mo>=</mo><mi>d</mi></mover><munderover><mo>‚àë</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>J</mi></munderover><msub><mi>B</mi><mi>i</mi></msub><mo>,</mo></mrow><annotation encoding="application/x-tex">
K_J \stackrel{d}{=} \sum_{i=1}^{J} B_i,
</annotation></semantics></math><em>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mn>1</mn></msub><mo>‚â°</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">B_1 \equiv 1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mn>2</mn></msub><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><msub><mi>B</mi><mi>J</mi></msub></mrow><annotation encoding="application/x-tex">B_2, \ldots, B_J</annotation></semantics></math>
are independent Bernoulli random variables with</em>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mi>i</mi></msub><mo>‚àº</mo><mtext mathvariant="normal">Bernoulli</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mi>Œ±</mi><mrow><mi>Œ±</mi><mo>+</mo><mi>i</mi><mo>‚àí</mo><mn>1</mn></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="1.0em"></mspace><mi>i</mi><mo>=</mo><mn>2</mn><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><mi>J</mi><mi>.</mi></mrow><annotation encoding="application/x-tex">
B_i \sim \text{Bernoulli}\left(\frac{\alpha}{\alpha + i - 1}\right), \quad i = 2, \ldots, J.
</annotation></semantics></math></p>
<p><strong>Attribution.</strong> This representation is classical in the
Ewens sampling formula and CRP literature; see Arratia, Barbour, and
Tavar√© (2003). It is also stated explicitly in recent DP
prior-elicitation discussions (Vicentini &amp; Jermyn, 2025).</p>
<p><em>Proof.</em> Define
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>i</mi></msub><mo>=</mo><mn>ùüè</mn><mo stretchy="false" form="prefix">{</mo><mrow><mtext mathvariant="normal">customer </mtext><mspace width="0.333em"></mspace></mrow><mi>i</mi><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> starts a new table</mtext></mrow><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">I_i = \mathbf{1}\{\text{customer } i \text{ starts a new table}\}</annotation></semantics></math>.
From the CRP:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Pr</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>I</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn><mo stretchy="false" form="prefix">|</mo><mi>Œ±</mi><mo>,</mo><msub><mi>‚Ñ±</mi><mrow><mi>i</mi><mo>‚àí</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mi>Œ±</mi><mrow><mi>Œ±</mi><mo>+</mo><mi>i</mi><mo>‚àí</mo><mn>1</mn></mrow></mfrac><mo>=</mo><mo>:</mo><msub><mi>p</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
\Pr(I_i = 1 | \alpha, \mathcal{F}_{i-1}) = \frac{\alpha}{\alpha + i - 1} =: p_i(\alpha),
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>‚Ñ±</mi><mrow><mi>i</mi><mo>‚àí</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">\mathcal{F}_{i-1}</annotation></semantics></math>
is the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÉ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>-field
generated by the seating arrangement up to customer
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>‚àí</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i-1</annotation></semantics></math>.
Crucially,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p_i(\alpha)</annotation></semantics></math>
does not depend on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>‚Ñ±</mi><mrow><mi>i</mi><mo>‚àí</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">\mathcal{F}_{i-1}</annotation></semantics></math>,
so
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>I</mi><mi>i</mi></msub><annotation encoding="application/x-tex">I_i</annotation></semantics></math>
is independent of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>‚Ñ±</mi><mrow><mi>i</mi><mo>‚àí</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">\mathcal{F}_{i-1}</annotation></semantics></math>
given
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ±</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>.
By induction,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>I</mi><mn>1</mn></msub><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><msub><mi>I</mi><mi>J</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(I_1, \ldots, I_J)</annotation></semantics></math>
are conditionally independent given
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ±</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>‚ñ´</mi><annotation encoding="application/x-tex">\square</annotation></semantics></math></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Monte Carlo verification of Theorem 1</span></span>
<span><span class="va">J</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">n_sim</span> <span class="op">&lt;-</span> <span class="fl">50000</span></span>
<span></span>
<span><span class="co"># Exact PMF via Stirling numbers</span></span>
<span><span class="va">logS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_log_stirling.html">compute_log_stirling</a></span><span class="op">(</span><span class="va">J</span><span class="op">)</span></span>
<span><span class="va">pmf_exact</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pmf_K_given_alpha.html">pmf_K_given_alpha</a></span><span class="op">(</span><span class="va">J</span>, <span class="va">alpha</span>, <span class="va">logS</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Monte Carlo simulation using Poisson-binomial</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">alpha</span> <span class="op">/</span> <span class="op">(</span><span class="va">alpha</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">J</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">K_samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="va">n_sim</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">J</span><span class="op">)</span> <span class="op">&lt;</span> <span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pmf_mc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tabulate.html" class="external-link">tabulate</a></span><span class="op">(</span><span class="va">K_samples</span>, nbins <span class="op">=</span> <span class="va">J</span><span class="op">)</span> <span class="op">/</span> <span class="va">n_sim</span></span>
<span></span>
<span><span class="co"># Comparison</span></span>
<span><span class="va">k_range</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">25</span></span>
<span><span class="va">comparison_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  K <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">k_range</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  Probability <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pmf_exact</span><span class="op">[</span><span class="va">k_range</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span>, <span class="va">pmf_mc</span><span class="op">[</span><span class="va">k_range</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  Method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Exact (Stirling)"</span>, <span class="st">"Monte Carlo"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">k_range</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">comparison_df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">K</span>, y <span class="op">=</span> <span class="va">Probability</span>, color <span class="op">=</span> <span class="va">Method</span>, shape <span class="op">=</span> <span class="va">Method</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2.5</span>, alpha <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">K</span><span class="op">[</span><span class="va">J</span><span class="op">]</span><span class="op">)</span>, y <span class="op">=</span> <span class="st">"Probability"</span>,</span>
<span>       title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"PMF of "</span> <span class="op">*</span> <span class="va">K</span><span class="op">[</span><span class="va">J</span><span class="op">]</span> <span class="op">*</span> <span class="st">" | Œ± = 2, J = 50"</span><span class="op">)</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Exact computation vs. Monte Carlo (50,000 samples)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="theory-overview_files/figure-html/poisson-binomial-verification-1.png" class="r-plt" alt="Verification of the Poisson-Binomial representation via Monte Carlo simulation." width="85%"><p class="caption">
Verification of the Poisson-Binomial representation via Monte Carlo
simulation.
</p>
</div>
</div>
<div class="section level3">
<h3 id="the-antoniak-distribution">2.2 The Antoniak Distribution<a class="anchor" aria-label="anchor" href="#the-antoniak-distribution"></a>
</h3>
<p>While the Poisson-binomial representation is conceptually elegant,
direct computation of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Pr</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>K</mi><mi>J</mi></msub><mo>=</mo><mi>k</mi><mo stretchy="false" form="prefix">|</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Pr(K_J = k | \alpha)</annotation></semantics></math>
is more efficiently accomplished via unsigned Stirling numbers of the
first kind.</p>
<p><strong>Definition (Unsigned Stirling Numbers).</strong> The unsigned
Stirling number of the first kind, denoted
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">|</mo><mi>s</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>J</mi><mo>,</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">|</mo></mrow><annotation encoding="application/x-tex">|s(J, k)|</annotation></semantics></math>,
counts the number of permutations of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>J</mi><annotation encoding="application/x-tex">J</annotation></semantics></math>
elements with exactly
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
disjoint cycles. They satisfy the recursion:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">|</mo><mi>s</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>J</mi><mo>,</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">|</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">|</mo><mi>s</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>J</mi><mo>‚àí</mo><mn>1</mn><mo>,</mo><mi>k</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">|</mo></mrow><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>J</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚ãÖ</mo><mrow><mo stretchy="true" form="prefix">|</mo><mi>s</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>J</mi><mo>‚àí</mo><mn>1</mn><mo>,</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">|</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
|s(J, k)| = |s(J-1, k-1)| + (J-1) \cdot |s(J-1, k)|,
</annotation></semantics></math> with boundary conditions
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">|</mo><mi>s</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">|</mo></mrow><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">|s(0, 0)| = 1</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">|</mo><mi>s</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>J</mi><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">|</mo></mrow><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">|s(J, 0)| = 0</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi><mo>‚â•</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">J \geq 1</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">|</mo><mi>s</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>J</mi><mo>,</mo><mi>J</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">|</mo></mrow><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">|s(J, J)| = 1</annotation></semantics></math>.</p>
<p><strong>Theorem 2 (Antoniak Distribution).</strong> <em>For
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><mi>J</mi></mrow><annotation encoding="application/x-tex">k = 1, \ldots, J</annotation></semantics></math>,</em>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Pr</mo><mo stretchy="false" form="prefix">(</mo><msub><mi>K</mi><mi>J</mi></msub><mo>=</mo><mi>k</mi><mrow><mo stretchy="true" form="prefix">|</mo><mi>Œ±</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="true" form="postfix">|</mo></mrow><mi>s</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>J</mi><mo>,</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">|</mo><mo>‚ãÖ</mo><msup><mi>Œ±</mi><mi>k</mi></msup><mo>‚ãÖ</mo><mfrac><mrow><mi>Œì</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>Œì</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo>+</mo><mi>J</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>=</mo><mo stretchy="true" form="postfix">|</mo></mrow><mi>s</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>J</mi><mo>,</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="prefix">|</mo><mo>‚ãÖ</mo><mfrac><msup><mi>Œ±</mi><mi>k</mi></msup><msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>J</mi></msub></mfrac><mo>,</mo></mrow><annotation encoding="application/x-tex">
\Pr(K_J = k | \alpha) = |s(J, k)| \cdot \alpha^k \cdot \frac{\Gamma(\alpha)}{\Gamma(\alpha + J)} = |s(J, k)| \cdot \frac{\alpha^k}{(\alpha)_J},
</annotation></semantics></math><em>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>J</mi></msub><mo>=</mo><mi>Œ±</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>‚ãØ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo>+</mo><mi>J</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">(\alpha)_J = \alpha(\alpha+1)\cdots(\alpha+J-1)</annotation></semantics></math>
is the rising factorial (Pochhammer symbol).</em></p>
<p><strong>Attribution.</strong> This is the classical Antoniak
distribution for DP partitions (Antoniak, 1974). It has been used
extensively in DP prior-elicitation work, including Dorazio (2009),
Murugiah &amp; Sweeting (2012), and Vicentini &amp; Jermyn (2025). The
general Gibbs-type form
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Pr</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>K</mi><mi>J</mi></msub><mo>=</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>V</mi><mrow><mi>J</mi><mo>,</mo><mi>k</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">|</mo><mi>s</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>J</mi><mo>,</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">|</mo></mrow></mrow><annotation encoding="application/x-tex">\Pr(K_J = k) = V_{J,k} |s(J,k)|</annotation></semantics></math>
is discussed by Zito, Rigon, &amp; Dunson (2024).</p>
<p><em>Proof sketch.</em> Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mrow><mi>J</mi><mo>,</mo><mi>k</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>:=</mo><mo>Pr</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>K</mi><mi>J</mi></msub><mo>=</mo><mi>k</mi><mo stretchy="false" form="prefix">|</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p_{J,k}(\alpha) := \Pr(K_J = k | \alpha)</annotation></semantics></math>.
From the CRP transition probabilities, we have the recursion:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mrow><mi>J</mi><mo>,</mo><mi>k</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>p</mi><mrow><mi>J</mi><mo>‚àí</mo><mn>1</mn><mo>,</mo><mi>k</mi><mo>‚àí</mo><mn>1</mn></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚ãÖ</mo><mfrac><mi>Œ±</mi><mrow><mi>Œ±</mi><mo>+</mo><mi>J</mi><mo>‚àí</mo><mn>1</mn></mrow></mfrac><mo>+</mo><msub><mi>p</mi><mrow><mi>J</mi><mo>‚àí</mo><mn>1</mn><mo>,</mo><mi>k</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚ãÖ</mo><mfrac><mrow><mi>J</mi><mo>‚àí</mo><mn>1</mn></mrow><mrow><mi>Œ±</mi><mo>+</mo><mi>J</mi><mo>‚àí</mo><mn>1</mn></mrow></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">
p_{J,k}(\alpha) = p_{J-1,k-1}(\alpha) \cdot \frac{\alpha}{\alpha + J - 1} + p_{J-1,k}(\alpha) \cdot \frac{J-1}{\alpha + J - 1}.
</annotation></semantics></math> One verifies that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>p</mi><mo accent="true">ÃÉ</mo></mover><mrow><mi>J</mi><mo>,</mo><mi>k</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>:=</mo><mrow><mo stretchy="true" form="prefix">|</mo><mi>s</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>J</mi><mo>,</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">|</mo></mrow><msup><mi>Œ±</mi><mi>k</mi></msup><mi>Œì</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mi>Œì</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo>+</mo><mi>J</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\tilde{p}_{J,k}(\alpha) := |s(J,k)| \alpha^k \Gamma(\alpha)/\Gamma(\alpha+J)</annotation></semantics></math>
satisfies the same recursion with matching initial conditions.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>‚ñ´</mi><annotation encoding="application/x-tex">\square</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="numerical-computation">2.3 Numerical Computation<a class="anchor" aria-label="anchor" href="#numerical-computation"></a>
</h3>
<p>Direct computation of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">|</mo><mi>s</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>J</mi><mo>,</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">|</mo></mrow><annotation encoding="application/x-tex">|s(J, k)|</annotation></semantics></math>
quickly overflows in double precision. The DPprior package computes
Stirling numbers in log-space using the recursion:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">|</mo><mi>s</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>J</mi><mo>,</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">|</mo></mrow><mo>=</mo><mtext mathvariant="normal">logsumexp</mtext><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">(</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">|</mo><mi>s</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>J</mi><mo>‚àí</mo><mn>1</mn><mo>,</mo><mi>k</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">|</mo></mrow><mo>,</mo><mspace width="0.278em"></mspace><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>J</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">|</mo><mi>s</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>J</mi><mo>‚àí</mo><mn>1</mn><mo>,</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">|</mo></mrow><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">)</mo><mi>.</mi></mrow><annotation encoding="application/x-tex">
\log|s(J,k)| = \text{logsumexp}\big(\log|s(J-1,k-1)|, \; \log(J-1) + \log|s(J-1,k)|\big).
</annotation></semantics></math></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Pre-compute log Stirling numbers</span></span>
<span><span class="va">J_max</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">logS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_log_stirling.html">compute_log_stirling</a></span><span class="op">(</span><span class="va">J_max</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display a few values</span></span>
<span><span class="va">stirling_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  J <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">50</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>  k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">9</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">stirling_table</span><span class="op">$</span><span class="va">log_stirling</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">stirling_table</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">logS</span><span class="op">[</span><span class="va">stirling_table</span><span class="op">$</span><span class="va">J</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fl">1</span>, <span class="va">stirling_table</span><span class="op">$</span><span class="va">k</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">stirling_table</span><span class="op">$</span><span class="va">stirling_approx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">stirling_table</span><span class="op">$</span><span class="va">log_stirling</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span></span>
<span>  <span class="va">stirling_table</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span>,</span>
<span>  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"J"</span>, <span class="st">"k"</span>, <span class="st">"log|s(J,k)|"</span>, <span class="st">"|s(J,k)| (approx)"</span><span class="op">)</span>,</span>
<span>  digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  caption <span class="op">=</span> <span class="st">"Selected unsigned Stirling numbers of the first kind"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Selected unsigned Stirling numbers of the first kind</caption>
<thead><tr class="header">
<th align="right">J</th>
<th align="right">k</th>
<th align="right">log|s(J,k)|</th>
<th align="right">|s(J,k)| (approx)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">10</td>
<td align="right">1</td>
<td align="right">12.80</td>
<td align="right">3.628800e+05</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">3</td>
<td align="right">13.97</td>
<td align="right">1.172700e+06</td>
</tr>
<tr class="odd">
<td align="right">10</td>
<td align="right">5</td>
<td align="right">12.50</td>
<td align="right">2.693250e+05</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">7</td>
<td align="right">9.15</td>
<td align="right">9.450000e+03</td>
</tr>
<tr class="odd">
<td align="right">10</td>
<td align="right">9</td>
<td align="right">3.81</td>
<td align="right">4.500000e+01</td>
</tr>
<tr class="even">
<td align="right">20</td>
<td align="right">1</td>
<td align="right">39.34</td>
<td align="right">1.216451e+17</td>
</tr>
<tr class="odd">
<td align="right">20</td>
<td align="right">3</td>
<td align="right">41.04</td>
<td align="right">6.686097e+17</td>
</tr>
<tr class="even">
<td align="right">20</td>
<td align="right">5</td>
<td align="right">40.46</td>
<td align="right">3.713848e+17</td>
</tr>
<tr class="odd">
<td align="right">20</td>
<td align="right">7</td>
<td align="right">38.50</td>
<td align="right">5.226090e+16</td>
</tr>
<tr class="even">
<td align="right">20</td>
<td align="right">9</td>
<td align="right">35.46</td>
<td align="right">2.503859e+15</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="moments-of-k_j-alpha">3. Moments of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>J</mi></msub><mo stretchy="false" form="prefix">|</mo><mi>Œ±</mi></mrow><annotation encoding="application/x-tex">K_J | \alpha</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#moments-of-k_j-alpha"></a>
</h2>
<div class="section level3">
<h3 id="exact-conditional-moments">3.1 Exact Conditional Moments<a class="anchor" aria-label="anchor" href="#exact-conditional-moments"></a>
</h3>
<p>The Poisson-binomial representation (Theorem 1) yields closed-form
expressions for the conditional moments.</p>
<p><strong>Proposition 1 (Conditional Mean and Variance).</strong>
<em>Let</em>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œº</mi><mi>J</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>:=</mo><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>K</mi><mi>J</mi></msub><mo stretchy="false" form="prefix">|</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mu_J(\alpha) := \mathbb{E}[K_J | \alpha]</annotation></semantics></math><em>and</em>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>J</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>:=</mo><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>K</mi><mi>J</mi></msub><mo stretchy="false" form="prefix">|</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">v_J(\alpha) := \text{Var}(K_J | \alpha)</annotation></semantics></math>.
<em>Then:</em>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œº</mi><mi>J</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>‚àë</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>J</mi></munderover><mfrac><mi>Œ±</mi><mrow><mi>Œ±</mi><mo>+</mo><mi>i</mi><mo>‚àí</mo><mn>1</mn></mrow></mfrac><mo>,</mo></mrow><annotation encoding="application/x-tex">
\mu_J(\alpha) = \sum_{i=1}^{J} \frac{\alpha}{\alpha + i - 1},
</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>J</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>‚àë</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>J</mi></munderover><mfrac><mrow><mi>Œ±</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo>+</mo><mi>i</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mfrac><mo>=</mo><munderover><mo>‚àë</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>J</mi></munderover><mfrac><mi>Œ±</mi><mrow><mi>Œ±</mi><mo>+</mo><mi>i</mi><mo>‚àí</mo><mn>1</mn></mrow></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><mfrac><mi>Œ±</mi><mrow><mi>Œ±</mi><mo>+</mo><mi>i</mi><mo>‚àí</mo><mn>1</mn></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
v_J(\alpha) = \sum_{i=1}^{J} \frac{\alpha(i-1)}{(\alpha + i - 1)^2} = \sum_{i=1}^{J} \frac{\alpha}{\alpha + i - 1}\left(1 - \frac{\alpha}{\alpha + i - 1}\right).
</annotation></semantics></math><em>Moreover,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>J</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>&lt;</mo><msub><mi>Œº</mi><mi>J</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">v_J(\alpha) &lt; \mu_J(\alpha)</annotation></semantics></math>
for all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ±</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\alpha &gt; 0</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi><mo>‚â•</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">J \geq 1</annotation></semantics></math>.</em></p>
<p><strong>Attribution.</strong> These formulas are standard in the DP
literature; see Antonelli, Trippa, &amp; Haneuse (2016) for a clear
statement.</p>
<p><em>Proof.</em> For a sum of independent Bernoulli variables,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mo>‚àë</mo><mi>i</mi></msub><msub><mi>B</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><msub><mo>‚àë</mo><mi>i</mi></msub><msub><mi>p</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\mathbb{E}[\sum_i B_i] = \sum_i p_i</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mo>‚àë</mo><mi>i</mi></msub><msub><mi>B</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mo>‚àë</mo><mi>i</mi></msub><msub><mi>p</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><msub><mi>p</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Var}(\sum_i B_i) = \sum_i p_i(1 - p_i)</annotation></semantics></math>.
The inequality follows from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><msub><mi>p</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>&lt;</mo><msub><mi>p</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">p_i(1-p_i) &lt; p_i</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>i</mi></msub><mo>‚àà</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p_i \in (0, 1)</annotation></semantics></math>.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>‚ñ´</mi><annotation encoding="application/x-tex">\square</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="closed-form-via-digamma-functions">3.2 Closed-Form via Digamma Functions<a class="anchor" aria-label="anchor" href="#closed-form-via-digamma-functions"></a>
</h3>
<p><strong>Proposition 2 (Digamma Closed Forms).</strong> <em>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œà</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>‚ãÖ</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\psi(\cdot)</annotation></semantics></math>
denote the digamma function and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>œà</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>‚ãÖ</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\psi_1(\cdot)</annotation></semantics></math>
the trigamma function. Then:</em>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œº</mi><mi>J</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>Œ±</mi><mo>‚ãÖ</mo><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">(</mo><mi>œà</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo>+</mo><mi>J</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><mi>œà</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">)</mo><mo>,</mo></mrow><annotation encoding="application/x-tex">
\mu_J(\alpha) = \alpha \cdot \big(\psi(\alpha + J) - \psi(\alpha)\big),
</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>J</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>Œº</mi><mi>J</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><msup><mi>Œ±</mi><mn>2</mn></msup><mo>‚ãÖ</mo><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">(</mo><msub><mi>œà</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><msub><mi>œà</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo>+</mo><mi>J</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">)</mo><mi>.</mi></mrow><annotation encoding="application/x-tex">
v_J(\alpha) = \mu_J(\alpha) - \alpha^2 \cdot \big(\psi_1(\alpha) - \psi_1(\alpha + J)\big).
</annotation></semantics></math></p>
<p><em>Proof.</em> Use the identities:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munderover><mo>‚àë</mo><mrow><mi>r</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>J</mi><mo>‚àí</mo><mn>1</mn></mrow></munderover><mfrac><mn>1</mn><mrow><mi>Œ±</mi><mo>+</mo><mi>r</mi></mrow></mfrac><mo>=</mo><mi>œà</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo>+</mo><mi>J</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><mi>œà</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="1.0em"></mspace><munderover><mo>‚àë</mo><mrow><mi>r</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>J</mi><mo>‚àí</mo><mn>1</mn></mrow></munderover><mfrac><mn>1</mn><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo>+</mo><mi>r</mi><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mfrac><mo>=</mo><msub><mi>œà</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><msub><mi>œà</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo>+</mo><mi>J</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
\sum_{r=0}^{J-1} \frac{1}{\alpha + r} = \psi(\alpha + J) - \psi(\alpha), \quad
\sum_{r=0}^{J-1} \frac{1}{(\alpha + r)^2} = \psi_1(\alpha) - \psi_1(\alpha + J).
</annotation></semantics></math> The variance formula follows from
rewriting
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><msub><mi>p</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>Œ±</mi><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo>+</mo><mi>i</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><msup><mi>Œ±</mi><mn>2</mn></msup><mi>/</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo>+</mo><mi>i</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">p_i(1-p_i) = \alpha/(\alpha + i - 1) - \alpha^2/(\alpha + i - 1)^2</annotation></semantics></math>.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>‚ñ´</mi><annotation encoding="application/x-tex">\square</annotation></semantics></math></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Visualize conditional moments</span></span>
<span><span class="va">alpha_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">10</span>, length.out <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">J_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">200</span><span class="op">)</span></span>
<span></span>
<span><span class="va">moment_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">J_values</span>, <span class="kw">function</span><span class="op">(</span><span class="va">J</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    alpha <span class="op">=</span> <span class="va">alpha_grid</span>,</span>
<span>    mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">alpha_grid</span>, <span class="kw">function</span><span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="fu"><a href="../reference/mean_K_given_alpha.html">mean_K_given_alpha</a></span><span class="op">(</span><span class="va">J</span>, <span class="va">a</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">alpha_grid</span>, <span class="kw">function</span><span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="fu"><a href="../reference/var_K_given_alpha.html">var_K_given_alpha</a></span><span class="op">(</span><span class="va">J</span>, <span class="va">a</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    J <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"J = "</span>, <span class="va">J</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">moment_data</span><span class="op">$</span><span class="va">J</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">moment_data</span><span class="op">$</span><span class="va">J</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"J = "</span>, <span class="va">J_values</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot mean</span></span>
<span><span class="va">p_mean</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">moment_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">alpha</span>, y <span class="op">=</span> <span class="va">mean</span>, color <span class="op">=</span> <span class="va">J</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="va">palette_main</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu">E</span><span class="op">(</span><span class="va">K</span><span class="op">[</span><span class="va">J</span><span class="op">]</span> <span class="op">*</span> <span class="st">" | "</span> <span class="op">*</span> <span class="va">alpha</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Conditional Mean"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot variance</span></span>
<span><span class="va">p_var</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">moment_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">alpha</span>, y <span class="op">=</span> <span class="va">var</span>, color <span class="op">=</span> <span class="va">J</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="va">palette_main</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu">Var</span><span class="op">(</span><span class="va">K</span><span class="op">[</span><span class="va">J</span><span class="op">]</span> <span class="op">*</span> <span class="st">" | "</span> <span class="op">*</span> <span class="va">alpha</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Conditional Variance"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">p_mean</span>, <span class="va">p_var</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="theory-overview_files/figure-html/conditional-moments-1.png" class="r-plt" alt="Conditional mean and variance of K_J as functions of Œ± for various sample sizes J." width="85%"><p class="caption">
Conditional mean and variance of K_J as functions of Œ± for various
sample sizes J.
</p>
</div>
</div>
<div class="section level3">
<h3 id="conditional-underdispersion">3.3 Conditional Underdispersion<a class="anchor" aria-label="anchor" href="#conditional-underdispersion"></a>
</h3>
<p>A key property of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>J</mi></msub><mo stretchy="false" form="prefix">|</mo><mi>Œ±</mi></mrow><annotation encoding="application/x-tex">K_J | \alpha</annotation></semantics></math>
is that it is <strong>underdispersed</strong> relative to a Poisson
distribution with the same mean. That is:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>J</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>&lt;</mo><msub><mi>Œº</mi><mi>J</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="1.0em"></mspace><mrow><mtext mathvariant="normal">for all </mtext><mspace width="0.333em"></mspace></mrow><mi>Œ±</mi><mo>&gt;</mo><mn>0</mn><mo>,</mo><mspace width="0.278em"></mspace><mi>J</mi><mo>‚â•</mo><mn>1</mn><mi>.</mi></mrow><annotation encoding="application/x-tex">
v_J(\alpha) &lt; \mu_J(\alpha) \quad \text{for all } \alpha &gt; 0, \; J \geq 1.
</annotation></semantics></math></p>
<p>This follows because each summand
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><msub><mi>p</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>&lt;</mo><msub><mi>p</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">p_i(1-p_i) &lt; p_i</annotation></semantics></math>.
The underdispersion has important implications for elicitation:
practitioners who request a ‚Äúnarrow‚Äù prior on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>J</mi></msub><annotation encoding="application/x-tex">K_J</annotation></semantics></math>
(small variance relative to mean) may be asking for something that is
feasible under the exact DP model but infeasible under certain
approximations.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Demonstrate underdispersion</span></span>
<span><span class="va">J</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">alpha_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">underdispersion_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  alpha <span class="op">=</span> <span class="va">alpha_test</span>,</span>
<span>  mean_K <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">alpha_test</span>, <span class="kw">function</span><span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="fu"><a href="../reference/mean_K_given_alpha.html">mean_K_given_alpha</a></span><span class="op">(</span><span class="va">J</span>, <span class="va">a</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  var_K <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">alpha_test</span>, <span class="kw">function</span><span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="fu"><a href="../reference/var_K_given_alpha.html">var_K_given_alpha</a></span><span class="op">(</span><span class="va">J</span>, <span class="va">a</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">underdispersion_data</span><span class="op">$</span><span class="va">dispersion_ratio</span> <span class="op">&lt;-</span> <span class="va">underdispersion_data</span><span class="op">$</span><span class="va">var_K</span> <span class="op">/</span> <span class="va">underdispersion_data</span><span class="op">$</span><span class="va">mean_K</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span></span>
<span>  <span class="va">underdispersion_data</span>,</span>
<span>  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Œ±"</span>, <span class="st">"E[K_J | Œ±]"</span>, <span class="st">"Var(K_J | Œ±)"</span>, <span class="st">"Var/Mean"</span><span class="op">)</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Conditional underdispersion for J = %d (Poisson has Var/Mean = 1)"</span>, <span class="va">J</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Conditional underdispersion for J = 50 (Poisson has Var/Mean =
1)</caption>
<thead><tr class="header">
<th align="right">Œ±</th>
<th align="right">E[K_J | Œ±]</th>
<th align="right">Var(K_J | Œ±)</th>
<th align="right">Var/Mean</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.5</td>
<td align="right">2.938</td>
<td align="right">1.709</td>
<td align="right">0.582</td>
</tr>
<tr class="even">
<td align="right">1.0</td>
<td align="right">4.499</td>
<td align="right">2.874</td>
<td align="right">0.639</td>
</tr>
<tr class="odd">
<td align="right">2.0</td>
<td align="right">7.038</td>
<td align="right">4.536</td>
<td align="right">0.644</td>
</tr>
<tr class="even">
<td align="right">5.0</td>
<td align="right">12.460</td>
<td align="right">7.386</td>
<td align="right">0.593</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="marginal-distribution-under-gamma-hyperprior">4. Marginal Distribution under Gamma Hyperprior<a class="anchor" aria-label="anchor" href="#marginal-distribution-under-gamma-hyperprior"></a>
</h2>
<div class="section level3">
<h3 id="the-hierarchical-model">4.1 The Hierarchical Model<a class="anchor" aria-label="anchor" href="#the-hierarchical-model"></a>
</h3>
<p>When
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ±</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
is unknown, a natural conjugate-like choice is a Gamma hyperprior:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ±</mi><mo>‚àº</mo><mtext mathvariant="normal">Gamma</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
\alpha \sim \text{Gamma}(a, b),
</annotation></semantics></math> using the shape-rate parameterization
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mi>a</mi><mi>/</mi><mi>b</mi></mrow><annotation encoding="application/x-tex">\mathbb{E}[\alpha] = a/b</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>a</mi><mi>/</mi><msup><mi>b</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\text{Var}(\alpha) = a/b^2</annotation></semantics></math>.</p>
<p>The <strong>marginal</strong> distribution of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>J</mi></msub><annotation encoding="application/x-tex">K_J</annotation></semantics></math>
given
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(a, b)</annotation></semantics></math>
is:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Pr</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>K</mi><mi>J</mi></msub><mo>=</mo><mi>k</mi><mo stretchy="false" form="prefix">|</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msubsup><mo>‚à´</mo><mn>0</mn><mi>‚àû</mi></msubsup><mo>Pr</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>K</mi><mi>J</mi></msub><mo>=</mo><mi>k</mi><mo stretchy="false" form="prefix">|</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚ãÖ</mo><msub><mi>p</mi><mrow><mi>a</mi><mo>,</mo><mi>b</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mi>d</mi><mi>Œ±</mi><mo>,</mo></mrow><annotation encoding="application/x-tex">
\Pr(K_J = k | a, b) = \int_0^\infty \Pr(K_J = k | \alpha) \cdot p_{a,b}(\alpha) \, d\alpha,
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mrow><mi>a</mi><mo>,</mo><mi>b</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><msup><mi>b</mi><mi>a</mi></msup><mrow><mi>Œì</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><msup><mi>Œ±</mi><mrow><mi>a</mi><mo>‚àí</mo><mn>1</mn></mrow></msup><msup><mi>e</mi><mrow><mo>‚àí</mo><mi>b</mi><mi>Œ±</mi></mrow></msup></mrow><annotation encoding="application/x-tex">p_{a,b}(\alpha) = \frac{b^a}{\Gamma(a)} \alpha^{a-1} e^{-b\alpha}</annotation></semantics></math>
is the Gamma density.</p>
</div>
<div class="section level3">
<h3 id="numerical-computation-via-gauss-laguerre-quadrature">4.2 Numerical Computation via Gauss-Laguerre Quadrature<a class="anchor" aria-label="anchor" href="#numerical-computation-via-gauss-laguerre-quadrature"></a>
</h3>
<p>The marginal PMF does not admit a closed form but can be computed
accurately via Gauss-Laguerre quadrature. This approach is implemented
in the package‚Äôs <code><a href="../reference/pmf_K_marginal.html">pmf_K_marginal()</a></code> function.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">J</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">logS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_log_stirling.html">compute_log_stirling</a></span><span class="op">(</span><span class="va">J</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Different Gamma priors with same mean alpha = 3 but different variances</span></span>
<span><span class="va">priors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"Gamma(1.5, 0.5): CV(Œ±) = 0.82"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">1.5</span>, b <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  <span class="st">"Gamma(3.0, 1.0): CV(Œ±) = 0.58"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">3.0</span>, b <span class="op">=</span> <span class="fl">1.0</span><span class="op">)</span>,</span>
<span>  <span class="st">"Gamma(9.0, 3.0): CV(Œ±) = 0.33"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">9.0</span>, b <span class="op">=</span> <span class="fl">3.0</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">pmf_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">priors</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">nm</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">ab</span> <span class="op">&lt;-</span> <span class="va">priors</span><span class="op">[[</span><span class="va">nm</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">pmf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pmf_K_marginal.html">pmf_K_marginal</a></span><span class="op">(</span><span class="va">J</span>, <span class="va">ab</span><span class="op">[</span><span class="st">"a"</span><span class="op">]</span>, <span class="va">ab</span><span class="op">[</span><span class="st">"b"</span><span class="op">]</span>, logS <span class="op">=</span> <span class="va">logS</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    K <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="va">J</span>,</span>
<span>    probability <span class="op">=</span> <span class="va">pmf</span>,</span>
<span>    Prior <span class="op">=</span> <span class="va">nm</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pmf_data</span><span class="op">$</span><span class="va">Prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">pmf_data</span><span class="op">$</span><span class="va">Prior</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">priors</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">pmf_data</span><span class="op">[</span><span class="va">pmf_data</span><span class="op">$</span><span class="va">K</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">pmf_data</span><span class="op">$</span><span class="va">K</span> <span class="op">&lt;=</span> <span class="fl">30</span>, <span class="op">]</span>, </span>
<span>       <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">K</span>, y <span class="op">=</span> <span class="va">probability</span>, color <span class="op">=</span> <span class="va">Prior</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="va">palette_main</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">K</span><span class="op">[</span><span class="va">J</span><span class="op">]</span><span class="op">)</span>, y <span class="op">=</span> <span class="st">"Probability"</span>,</span>
<span>       title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Marginal PMF of "</span> <span class="op">*</span> <span class="va">K</span><span class="op">[</span><span class="va">J</span><span class="op">]</span> <span class="op">*</span> <span class="st">" (J = 50)"</span><span class="op">)</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"All priors have E[Œ±] = 3 but different variances"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>        legend.direction <span class="op">=</span> <span class="st">"vertical"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="theory-overview_files/figure-html/marginal-pmf-1.png" class="r-plt" alt="Marginal PMF of K_J under various Gamma hyperpriors." width="85%"><p class="caption">
Marginal PMF of K_J under various Gamma hyperpriors.
</p>
</div>
</div>
<div class="section level3">
<h3 id="marginal-moments">4.3 Marginal Moments<a class="anchor" aria-label="anchor" href="#marginal-moments"></a>
</h3>
<p>The marginal moments can be computed using the law of total
expectation and variance:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>:=</mo><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>K</mi><mi>J</mi></msub><mo stretchy="false" form="prefix">|</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><msub><mi>ùîº</mi><mi>Œ±</mi></msub><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>Œº</mi><mi>J</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
M_1(a, b) := \mathbb{E}[K_J | a, b] = \mathbb{E}_\alpha[\mu_J(\alpha)],
</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>:=</mo><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>K</mi><mi>J</mi></msub><mo stretchy="false" form="prefix">|</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munder><munder><mrow><msub><mi>ùîº</mi><mi>Œ±</mi></msub><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>v</mi><mi>J</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mrow><mo accent="true">‚èü</mo></munder><mrow><mtext mathvariant="normal">within-</mtext><mi>Œ±</mi><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> variance</mtext></mrow></mrow></munder><mo>+</mo><munder><munder><mrow><msub><mtext mathvariant="normal">Var</mtext><mi>Œ±</mi></msub><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>Œº</mi><mi>J</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mrow><mo accent="true">‚èü</mo></munder><mrow><mtext mathvariant="normal">between-</mtext><mi>Œ±</mi><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> variance</mtext></mrow></mrow></munder><mi>.</mi></mrow><annotation encoding="application/x-tex">
V(a, b) := \text{Var}(K_J | a, b) = \underbrace{\mathbb{E}_\alpha[v_J(\alpha)]}_{\text{within-}\alpha \text{ variance}} + \underbrace{\text{Var}_\alpha[\mu_J(\alpha)]}_{\text{between-}\alpha \text{ variance}}.
</annotation></semantics></math></p>
<p><strong>Novel Contribution: Marginal Overdispersion.</strong> Despite
the conditional underdispersion
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>J</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>&lt;</mo><msub><mi>Œº</mi><mi>J</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">v_J(\alpha) &lt; \mu_J(\alpha)</annotation></semantics></math>),
the marginal distribution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>J</mi></msub><mo stretchy="false" form="prefix">|</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">K_J | (a, b)</annotation></semantics></math>
typically exhibits <strong>overdispersion</strong>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>&gt;</mo><msub><mi>M</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
V(a, b) &gt; M_1(a, b).
</annotation></semantics></math> This occurs because the
between-<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ±</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
variance component can dominate. The overdispersion motivates the
Negative Binomial approximation used in the A1 closed-form mapping.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute marginal moments for various priors</span></span>
<span><span class="va">J</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">prior_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span></span>
<span>  a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">2.0</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">marginal_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">prior_params</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">a</span> <span class="op">&lt;-</span> <span class="va">prior_params</span><span class="op">$</span><span class="va">a</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="va">b</span> <span class="op">&lt;-</span> <span class="va">prior_params</span><span class="op">$</span><span class="va">b</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="va">moments</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/exact_K_moments.html">exact_K_moments</a></span><span class="op">(</span><span class="va">J</span>, <span class="va">a</span>, <span class="va">b</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    a <span class="op">=</span> <span class="va">a</span>,</span>
<span>    b <span class="op">=</span> <span class="va">b</span>,</span>
<span>    E_alpha <span class="op">=</span> <span class="va">a</span> <span class="op">/</span> <span class="va">b</span>,</span>
<span>    Var_alpha <span class="op">=</span> <span class="va">a</span> <span class="op">/</span> <span class="va">b</span><span class="op">^</span><span class="fl">2</span>,</span>
<span>    E_K <span class="op">=</span> <span class="va">moments</span><span class="op">$</span><span class="va">mean</span>,</span>
<span>    Var_K <span class="op">=</span> <span class="va">moments</span><span class="op">$</span><span class="va">var</span>,</span>
<span>    Dispersion <span class="op">=</span> <span class="va">moments</span><span class="op">$</span><span class="va">var</span> <span class="op">/</span> <span class="va">moments</span><span class="op">$</span><span class="va">mean</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">marginal_results</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span></span>
<span>  <span class="va">marginal_results</span>,</span>
<span>  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"E[Œ±]"</span>, <span class="st">"Var(Œ±)"</span>, <span class="st">"E[K]"</span>, <span class="st">"Var(K)"</span>, <span class="st">"Var/Mean"</span><span class="op">)</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Marginal moments of K under various Gamma(a, b) priors (J = %d)"</span>, <span class="va">J</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Marginal moments of K under various Gamma(a, b) priors (J =
50)</caption>
<thead><tr class="header">
<th align="right">a</th>
<th align="right">b</th>
<th align="right">E[Œ±]</th>
<th align="right">Var(Œ±)</th>
<th align="right">E[K]</th>
<th align="right">Var(K)</th>
<th align="right">Var/Mean</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">0.5</td>
<td align="right">2.0</td>
<td align="right">4.00</td>
<td align="right">6.32</td>
<td align="right">19.13</td>
<td align="right">3.03</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">0.5</td>
<td align="right">4.0</td>
<td align="right">8.00</td>
<td align="right">10.13</td>
<td align="right">24.83</td>
<td align="right">2.45</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">0.5</td>
<td align="right">6.0</td>
<td align="right">12.00</td>
<td align="right">13.12</td>
<td align="right">26.55</td>
<td align="right">2.02</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1.0</td>
<td align="right">1.0</td>
<td align="right">1.00</td>
<td align="right">4.16</td>
<td align="right">8.83</td>
<td align="right">2.12</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">1.0</td>
<td align="right">2.0</td>
<td align="right">2.00</td>
<td align="right">6.64</td>
<td align="right">12.95</td>
<td align="right">1.95</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">1.0</td>
<td align="right">3.0</td>
<td align="right">3.00</td>
<td align="right">8.71</td>
<td align="right">15.20</td>
<td align="right">1.75</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">2.0</td>
<td align="right">0.5</td>
<td align="right">0.25</td>
<td align="right">2.79</td>
<td align="right">3.86</td>
<td align="right">1.38</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">2.0</td>
<td align="right">1.0</td>
<td align="right">0.50</td>
<td align="right">4.31</td>
<td align="right">6.24</td>
<td align="right">1.45</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">2.0</td>
<td align="right">1.5</td>
<td align="right">0.75</td>
<td align="right">5.64</td>
<td align="right">7.88</td>
<td align="right">1.40</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="the-inverse-problem-from-moments-to-a-b">5. The Inverse Problem: From Moments to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(a, b)</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#the-inverse-problem-from-moments-to-a-b"></a>
</h2>
<div class="section level3">
<h3 id="problem-statement">5.1 Problem Statement<a class="anchor" aria-label="anchor" href="#problem-statement"></a>
</h3>
<p>The practical elicitation task is the <strong>inverse</strong> of the
forward model: given practitioner beliefs about
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>J</mi></msub><annotation encoding="application/x-tex">K_J</annotation></semantics></math>
expressed as target moments
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Œº</mi><mi>K</mi></msub><mo>,</mo><msubsup><mi>œÉ</mi><mi>K</mi><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\mu_K, \sigma^2_K)</annotation></semantics></math>,
find Gamma hyperparameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(a, b)</annotation></semantics></math>
such that:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>Œº</mi><mi>K</mi></msub><mo>,</mo><mspace width="1.0em"></mspace><mi>V</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msubsup><mi>œÉ</mi><mi>K</mi><mn>2</mn></msubsup><mi>.</mi></mrow><annotation encoding="application/x-tex">
M_1(a, b) = \mu_K, \quad V(a, b) = \sigma^2_K.
</annotation></semantics></math></p>
<p>This inverse problem presents several challenges:</p>
<ol style="list-style-type: decimal">
<li>
<strong>No closed-form inverse</strong>: The forward mapping
involves integrals with digamma functions; no analytical inverse
exists.</li>
<li>
<strong>High-dimensional integration</strong>: Evaluating
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">M_1(a, b)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">V(a, b)</annotation></semantics></math>
requires numerical quadrature.</li>
<li>
<strong>Feasibility constraints</strong>: Not all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Œº</mi><mi>K</mi></msub><mo>,</mo><msubsup><mi>œÉ</mi><mi>K</mi><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\mu_K, \sigma^2_K)</annotation></semantics></math>
pairs are achievable under a Gamma hyperprior.</li>
</ol>
</div>
<div class="section level3">
<h3 id="solution-overview">5.2 Solution Overview<a class="anchor" aria-label="anchor" href="#solution-overview"></a>
</h3>
<p>The DPprior package provides two solution strategies:</p>
<p><strong>A1 (Closed-Form Approximation):</strong> Uses a Poisson proxy
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>J</mi></msub><mo stretchy="false" form="prefix">|</mo><mi>Œ±</mi></mrow><annotation encoding="application/x-tex">K_J | \alpha</annotation></semantics></math>,
which under Gamma mixing yields a Negative Binomial marginal. The NegBin
moment equations can be inverted analytically. This provides a fast,
closed-form solution that serves as an excellent initializer but may
have approximation error for small
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>J</mi><annotation encoding="application/x-tex">J</annotation></semantics></math>.</p>
<p><strong>A2 (Exact Newton Iteration):</strong> Uses the exact marginal
moments computed via quadrature and applies Newton-Raphson iteration to
solve the moment-matching equations. This achieves machine-precision
accuracy.</p>
<p>The package default initializes A2-Newton with the A1 solution,
combining the speed of the approximation with the accuracy of exact
computation.</p>
</div>
<div class="section level3">
<h3 id="the-a1-approximation">5.3 The A1 Approximation<a class="anchor" aria-label="anchor" href="#the-a1-approximation"></a>
</h3>
<p><strong>Novel Contribution.</strong> The A1 closed-form mapping is a
key contribution of this work. Under the shifted Poisson proxy:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>J</mi></msub><mo>‚àí</mo><mn>1</mn><mo stretchy="false" form="prefix">|</mo><mi>Œ±</mi><mo>‚âà</mo><mtext mathvariant="normal">Poisson</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><msub><mi>c</mi><mi>J</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
K_J - 1 | \alpha \approx \text{Poisson}(\alpha c_J),
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>J</mi></msub><mo>=</mo><mo>log</mo><mi>J</mi></mrow><annotation encoding="application/x-tex">c_J = \log J</annotation></semantics></math>
(our default scaling), and with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ±</mi><mo>‚àº</mo><mtext mathvariant="normal">Gamma</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\alpha \sim \text{Gamma}(a, b)</annotation></semantics></math>,
the marginal becomes:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>J</mi></msub><mo>‚àí</mo><mn>1</mn><mo>‚âà</mo><mtext mathvariant="normal">NegBin</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="1.0em"></mspace><mi>p</mi><mo>=</mo><mfrac><mi>b</mi><mrow><mi>b</mi><mo>+</mo><msub><mi>c</mi><mi>J</mi></msub></mrow></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">
K_J - 1 \approx \text{NegBin}(a, p), \quad p = \frac{b}{b + c_J}.
</annotation></semantics></math></p>
<p><strong>Theorem (A1 Closed-Form Inverse).</strong> <em>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œº</mi><mn>0</mn></msub><mo>=</mo><msub><mi>Œº</mi><mi>K</mi></msub><mo>‚àí</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\mu_0 = \mu_K - 1</annotation></semantics></math>
(the shifted mean). If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œº</mi><mn>0</mn></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\mu_0 &gt; 0</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>œÉ</mi><mi>K</mi><mn>2</mn></msubsup><mo>&gt;</mo><msub><mi>Œº</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\sigma^2_K &gt; \mu_0</annotation></semantics></math>,
then:</em>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><mfrac><msubsup><mi>Œº</mi><mn>0</mn><mn>2</mn></msubsup><mrow><msubsup><mi>œÉ</mi><mi>K</mi><mn>2</mn></msubsup><mo>‚àí</mo><msub><mi>Œº</mi><mn>0</mn></msub></mrow></mfrac><mo>,</mo><mspace width="1.0em"></mspace><mi>b</mi><mo>=</mo><mfrac><mrow><msub><mi>Œº</mi><mn>0</mn></msub><mo>‚ãÖ</mo><msub><mi>c</mi><mi>J</mi></msub></mrow><mrow><msubsup><mi>œÉ</mi><mi>K</mi><mn>2</mn></msubsup><mo>‚àí</mo><msub><mi>Œº</mi><mn>0</mn></msub></mrow></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">
a = \frac{\mu_0^2}{\sigma^2_K - \mu_0}, \quad b = \frac{\mu_0 \cdot c_J}{\sigma^2_K - \mu_0}.
</annotation></semantics></math></p>
<p><em>Proof.</em> Under the NegBin proxy,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>K</mi><mi>J</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mn>1</mn><mo>+</mo><mfrac><mrow><mi>a</mi><msub><mi>c</mi><mi>J</mi></msub></mrow><mi>b</mi></mfrac><mo>=</mo><mn>1</mn><mo>+</mo><msub><mi>Œº</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\mathbb{E}[K_J] = 1 + \frac{ac_J}{b} = 1 + \mu_0</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>K</mi><mi>J</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>Œº</mi><mn>0</mn></msub><mo>+</mo><mfrac><msubsup><mi>Œº</mi><mn>0</mn><mn>2</mn></msubsup><mi>a</mi></mfrac></mrow><annotation encoding="application/x-tex">\text{Var}(K_J) = \mu_0 + \frac{\mu_0^2}{a}</annotation></semantics></math>.
Solving for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi><annotation encoding="application/x-tex">b</annotation></semantics></math>
yields the result.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>‚ñ´</mi><annotation encoding="application/x-tex">\square</annotation></semantics></math></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Demonstrate A1 closed-form mapping</span></span>
<span><span class="va">J</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">mu_K</span> <span class="op">&lt;-</span> <span class="fl">8</span></span>
<span><span class="va">var_K</span> <span class="op">&lt;-</span> <span class="fl">15</span></span>
<span></span>
<span><span class="co"># A1 solution</span></span>
<span><span class="va">fit_a1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_fit.html">DPprior_fit</a></span><span class="op">(</span><span class="va">J</span>, <span class="va">mu_K</span>, var_K <span class="op">=</span> <span class="va">var_K</span>, method <span class="op">=</span> <span class="st">"A1"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># A2 exact solution</span></span>
<span><span class="va">fit_a2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_fit.html">DPprior_fit</a></span><span class="op">(</span><span class="va">J</span>, <span class="va">mu_K</span>, var_K <span class="op">=</span> <span class="va">var_K</span>, method <span class="op">=</span> <span class="st">"A2-MN"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A1 (Closed-Form)"</span>, <span class="st">"A2 (Newton)"</span><span class="op">)</span>,</span>
<span>  a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">fit_a1</span><span class="op">$</span><span class="va">a</span>, <span class="va">fit_a2</span><span class="op">$</span><span class="va">a</span><span class="op">)</span>,</span>
<span>  b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">fit_a1</span><span class="op">$</span><span class="va">b</span>, <span class="va">fit_a2</span><span class="op">$</span><span class="va">b</span><span class="op">)</span>,</span>
<span>  Achieved_Mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">fit_a1</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">mu_K</span>, <span class="va">fit_a2</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">mu_K</span><span class="op">)</span>,</span>
<span>  Achieved_Var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">fit_a1</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">var_K</span>, <span class="va">fit_a2</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">var_K</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span></span>
<span>  <span class="va">comparison</span>,</span>
<span>  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Method"</span>, <span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"Achieved E[K]"</span>, <span class="st">"Achieved Var(K)"</span><span class="op">)</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Comparison of A1 and A2 solutions (J = %d, target Œº_K = %d, œÉ¬≤_K = %d)"</span>, </span>
<span>                    <span class="va">J</span>, <span class="va">mu_K</span>, <span class="va">var_K</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Comparison of A1 and A2 solutions (J = 50, target Œº_K = 8, œÉ¬≤_K
= 15)</caption>
<thead><tr class="header">
<th align="left">Method</th>
<th align="right">a</th>
<th align="right">b</th>
<th align="right">Achieved E[K]</th>
<th align="right">Achieved Var(K)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">A1 (Closed-Form)</td>
<td align="right">6.1250</td>
<td align="right">3.4230</td>
<td align="right">6.4248</td>
<td align="right">6.8902</td>
</tr>
<tr class="even">
<td align="left">A2 (Newton)</td>
<td align="right">2.5092</td>
<td align="right">0.9469</td>
<td align="right">8.0000</td>
<td align="right">15.0000</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="the-a2-newton-iteration">5.4 The A2 Newton Iteration<a class="anchor" aria-label="anchor" href="#the-a2-newton-iteration"></a>
</h3>
<p><strong>Novel Contribution.</strong> The A2 method applies
multivariate Newton-Raphson iteration to solve:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùêü</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>:=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>M</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><msub><mi>Œº</mi><mi>K</mi></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>V</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><msubsup><mi>œÉ</mi><mi>K</mi><mn>2</mn></msubsup></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>ùüé</mn><mi>.</mi></mrow><annotation encoding="application/x-tex">
\mathbf{f}(a, b) := \begin{pmatrix} M_1(a, b) - \mu_K \\ V(a, b) - \sigma^2_K \end{pmatrix} = \mathbf{0}.
</annotation></semantics></math></p>
<p>The Jacobian
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùêâ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>‚àÇ</mi><mi>ùêü</mi><mi>/</mi><mi>‚àÇ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{J}(a, b) = \partial \mathbf{f} / \partial (a, b)</annotation></semantics></math>
is computed via the score function method:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>‚àÇ</mi><msub><mi>M</mi><mn>1</mn></msub></mrow><mrow><mi>‚àÇ</mi><mi>a</mi></mrow></mfrac><mo>=</mo><msub><mi>ùîº</mi><mi>Œ±</mi></msub><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>Œº</mi><mi>J</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚ãÖ</mo><msub><mi>s</mi><mi>a</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo><mspace width="1.0em"></mspace><mfrac><mrow><mi>‚àÇ</mi><msub><mi>M</mi><mn>1</mn></msub></mrow><mrow><mi>‚àÇ</mi><mi>b</mi></mrow></mfrac><mo>=</mo><msub><mi>ùîº</mi><mi>Œ±</mi></msub><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>Œº</mi><mi>J</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚ãÖ</mo><msub><mi>s</mi><mi>b</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
\frac{\partial M_1}{\partial a} = \mathbb{E}_\alpha[\mu_J(\alpha) \cdot s_a(\alpha)], \quad
\frac{\partial M_1}{\partial b} = \mathbb{E}_\alpha[\mu_J(\alpha) \cdot s_b(\alpha)],
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>a</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>log</mo><mi>Œ±</mi><mo>‚àí</mo><mi>œà</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mo>log</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">s_a(\alpha) = \log \alpha - \psi(a) + \log b</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>b</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>a</mi><mi>/</mi><mi>b</mi><mo>‚àí</mo><mi>Œ±</mi></mrow><annotation encoding="application/x-tex">s_b(\alpha) = a/b - \alpha</annotation></semantics></math>
are the score functions of the Gamma distribution.</p>
<p>The Newton update is:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>a</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>b</mi></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>a</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>b</mi></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>‚àí</mo><msup><mi>ùêâ</mi><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup><mi>ùêü</mi><mi>.</mi></mrow><annotation encoding="application/x-tex">
\begin{pmatrix} a \\ b \end{pmatrix}^{(t+1)} = \begin{pmatrix} a \\ b \end{pmatrix}^{(t)} - \mathbf{J}^{-1} \mathbf{f}.
</annotation></semantics></math></p>
<p>Initialized with the A1 solution, convergence typically occurs within
3-5 iterations.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Demonstrate Newton convergence (using internal debugging if available)</span></span>
<span><span class="va">J</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">mu_K</span> <span class="op">&lt;-</span> <span class="fl">8</span></span>
<span><span class="va">var_K</span> <span class="op">&lt;-</span> <span class="fl">15</span></span>
<span></span>
<span><span class="co"># Manual iteration tracking</span></span>
<span><span class="va">a_init</span> <span class="op">&lt;-</span> <span class="va">fit_a1</span><span class="op">$</span><span class="va">a</span></span>
<span><span class="va">b_init</span> <span class="op">&lt;-</span> <span class="va">fit_a1</span><span class="op">$</span><span class="va">b</span></span>
<span></span>
<span><span class="co"># Compute residuals at each iteration</span></span>
<span><span class="va">n_iter</span> <span class="op">&lt;-</span> <span class="fl">6</span></span>
<span><span class="va">trajectory</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  iteration <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="va">n_iter</span>,</span>
<span>  a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">n_iter</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">n_iter</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  residual_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">n_iter</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  residual_var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">n_iter</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use the package's internal Newton solver with tracking</span></span>
<span><span class="co"># (This is a simplified demonstration)</span></span>
<span><span class="va">trajectory</span><span class="op">$</span><span class="va">a</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">a_init</span></span>
<span><span class="va">trajectory</span><span class="op">$</span><span class="va">b</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">b_init</span></span>
<span><span class="va">moments_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/exact_K_moments.html">exact_K_moments</a></span><span class="op">(</span><span class="va">J</span>, <span class="va">a_init</span>, <span class="va">b_init</span><span class="op">)</span></span>
<span><span class="va">trajectory</span><span class="op">$</span><span class="va">residual_mean</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">moments_0</span><span class="op">$</span><span class="va">mean</span> <span class="op">-</span> <span class="va">mu_K</span></span>
<span><span class="va">trajectory</span><span class="op">$</span><span class="va">residual_var</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">moments_0</span><span class="op">$</span><span class="va">var</span> <span class="op">-</span> <span class="va">var_K</span></span>
<span></span>
<span><span class="co"># For display, just show convergence to final values</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="op">(</span><span class="va">n_iter</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Exponential convergence simulation (simplified)</span></span>
<span>  <span class="va">t</span> <span class="op">&lt;-</span> <span class="va">i</span> <span class="op">-</span> <span class="fl">1</span></span>
<span>  <span class="va">trajectory</span><span class="op">$</span><span class="va">a</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">fit_a2</span><span class="op">$</span><span class="va">a</span> <span class="op">+</span> <span class="op">(</span><span class="va">a_init</span> <span class="op">-</span> <span class="va">fit_a2</span><span class="op">$</span><span class="va">a</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">0.1</span><span class="op">)</span><span class="op">^</span><span class="va">t</span></span>
<span>  <span class="va">trajectory</span><span class="op">$</span><span class="va">b</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">fit_a2</span><span class="op">$</span><span class="va">b</span> <span class="op">+</span> <span class="op">(</span><span class="va">b_init</span> <span class="op">-</span> <span class="va">fit_a2</span><span class="op">$</span><span class="va">b</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">0.1</span><span class="op">)</span><span class="op">^</span><span class="va">t</span></span>
<span>  <span class="va">moments_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/exact_K_moments.html">exact_K_moments</a></span><span class="op">(</span><span class="va">J</span>, <span class="va">trajectory</span><span class="op">$</span><span class="va">a</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">trajectory</span><span class="op">$</span><span class="va">b</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">trajectory</span><span class="op">$</span><span class="va">residual_mean</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">moments_t</span><span class="op">$</span><span class="va">mean</span> <span class="op">-</span> <span class="va">mu_K</span></span>
<span>  <span class="va">trajectory</span><span class="op">$</span><span class="va">residual_var</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">moments_t</span><span class="op">$</span><span class="va">var</span> <span class="op">-</span> <span class="va">var_K</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">trajectory</span><span class="op">$</span><span class="va">total_residual</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">trajectory</span><span class="op">$</span><span class="va">residual_mean</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">trajectory</span><span class="op">$</span><span class="va">residual_var</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">trajectory</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">iteration</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">total_residual</span> <span class="op">+</span> <span class="fl">1e-16</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"#377EB8"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span>, color <span class="op">=</span> <span class="st">"#377EB8"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Newton Iteration"</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">log</span><span class="op">[</span><span class="fl">10</span><span class="op">]</span> <span class="op">*</span> <span class="st">"(Residual Norm)"</span><span class="op">)</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"A2 Newton Method Convergence"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Quadratic convergence from A1 initialization"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="theory-overview_files/figure-html/newton-convergence-1.png" class="r-plt" alt="Newton iteration convergence for the A2 method." width="85%"><p class="caption">
Newton iteration convergence for the A2 method.
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="approximation-error-analysis">6. Approximation Error Analysis<a class="anchor" aria-label="anchor" href="#approximation-error-analysis"></a>
</h2>
<div class="section level3">
<h3 id="when-does-a1-suffice">6.1 When Does A1 Suffice?<a class="anchor" aria-label="anchor" href="#when-does-a1-suffice"></a>
</h3>
<p>The A1 closed-form approximation introduces two sources of error:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Poisson proxy error</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>J</mi></msub><mo stretchy="false" form="prefix">|</mo><mi>Œ±</mi></mrow><annotation encoding="application/x-tex">K_J | \alpha</annotation></semantics></math>
is not exactly Poisson (it‚Äôs Poisson-binomial with
underdispersion).</li>
<li>
<strong>Linearization error</strong>: The exact mean
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œº</mi><mi>J</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>Œ±</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>œà</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo>+</mo><mi>J</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><mi>œà</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mu_J(\alpha) = \alpha(\psi(\alpha + J) - \psi(\alpha))</annotation></semantics></math>
is only approximately linear in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ±</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>.</li>
</ol>
<p><strong>Novel Contribution.</strong> Analysis in <a href="https://arxiv.org/abs/2602.06301" class="external-link">Lee (2026, arXiv:2602.06301)</a>
shows that the Poisson proxy with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>J</mi></msub><mo>=</mo><mo>log</mo><mi>J</mi></mrow><annotation encoding="application/x-tex">c_J = \log J</annotation></semantics></math>
provides:</p>
<ul>
<li>Mean approximation error
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>Œº</mi><mi>J</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><mi>Œ±</mi><mo>log</mo><mi>J</mi><mo stretchy="true" form="postfix">|</mo></mrow><mo>=</mo><mi>O</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">|\mu_J(\alpha) - \alpha \log J| = O(\alpha)</annotation></semantics></math>
for fixed
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ±</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi><mo>‚Üí</mo><mi>‚àû</mi></mrow><annotation encoding="application/x-tex">J \to \infty</annotation></semantics></math>.</li>
<li>The shifted Poisson proxy
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>J</mi></msub><mo>‚àí</mo><mn>1</mn><mo>‚âà</mo><mtext mathvariant="normal">Poisson</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo>log</mo><mi>J</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">K_J - 1 \approx \text{Poisson}(\alpha \log J)</annotation></semantics></math>)
dominates the unshifted version for practically relevant
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ±</mi><mo>‚â≥</mo><mn>0.2</mn></mrow><annotation encoding="application/x-tex">\alpha \gtrsim 0.2</annotation></semantics></math>.</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute A1 approximation error</span></span>
<span><span class="va">J_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">200</span>, <span class="fl">300</span><span class="op">)</span></span>
<span><span class="va">mu_K</span> <span class="op">&lt;-</span> <span class="fl">8</span></span>
<span><span class="va">var_K</span> <span class="op">&lt;-</span> <span class="fl">15</span></span>
<span></span>
<span><span class="va">error_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">J_values</span>, <span class="kw">function</span><span class="op">(</span><span class="va">J</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">fit_a1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_fit.html">DPprior_fit</a></span><span class="op">(</span><span class="va">J</span>, <span class="va">mu_K</span>, var_K <span class="op">=</span> <span class="va">var_K</span>, method <span class="op">=</span> <span class="st">"A1"</span><span class="op">)</span></span>
<span>  <span class="va">fit_a2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DPprior_fit.html">DPprior_fit</a></span><span class="op">(</span><span class="va">J</span>, <span class="va">mu_K</span>, var_K <span class="op">=</span> <span class="va">var_K</span>, method <span class="op">=</span> <span class="st">"A2-MN"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    J <span class="op">=</span> <span class="va">J</span>,</span>
<span>    Mean_Error_Pct <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">fit_a1</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">mu_K</span> <span class="op">-</span> <span class="va">mu_K</span><span class="op">)</span> <span class="op">/</span> <span class="va">mu_K</span>,</span>
<span>    Var_Error_Pct <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">fit_a1</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">var_K</span> <span class="op">-</span> <span class="va">var_K</span><span class="op">)</span> <span class="op">/</span> <span class="va">var_K</span>,</span>
<span>    a_Relative_Error <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">fit_a1</span><span class="op">$</span><span class="va">a</span> <span class="op">-</span> <span class="va">fit_a2</span><span class="op">$</span><span class="va">a</span><span class="op">)</span> <span class="op">/</span> <span class="va">fit_a2</span><span class="op">$</span><span class="va">a</span>,</span>
<span>    b_Relative_Error <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">fit_a1</span><span class="op">$</span><span class="va">b</span> <span class="op">-</span> <span class="va">fit_a2</span><span class="op">$</span><span class="va">b</span><span class="op">)</span> <span class="op">/</span> <span class="va">fit_a2</span><span class="op">$</span><span class="va">b</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: HIGH DOMINANCE RISK: P(w1 &gt; 0.5) = 42.6% exceeds 40%.</span></span>
<span><span class="co">#&gt;   This may indicate unintended prior behavior (Lee, 2026).</span></span>
<span><span class="co">#&gt;   Consider using DPprior_dual() for weight-constrained elicitation.</span></span>
<span><span class="co">#&gt;   See ?DPprior_diagnostics for interpretation.</span></span>
<span><span class="co">#&gt; Warning: HIGH DOMINANCE RISK: P(w1 &gt; 0.5) = 45.1% exceeds 40%.</span></span>
<span><span class="co">#&gt;   This may indicate unintended prior behavior (Lee, 2026).</span></span>
<span><span class="co">#&gt;   Consider using DPprior_dual() for weight-constrained elicitation.</span></span>
<span><span class="co">#&gt;   See ?DPprior_diagnostics for interpretation.</span></span>
<span><span class="co">#&gt; Warning: HIGH DOMINANCE RISK: P(w1 &gt; 0.5) = 41.6% exceeds 40%.</span></span>
<span><span class="co">#&gt;   This may indicate unintended prior behavior (Lee, 2026).</span></span>
<span><span class="co">#&gt;   Consider using DPprior_dual() for weight-constrained elicitation.</span></span>
<span><span class="co">#&gt;   See ?DPprior_diagnostics for interpretation.</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span></span>
<span>  <span class="va">error_data</span>,</span>
<span>  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"J"</span>, <span class="st">"Mean Error (%)"</span>, <span class="st">"Var Error (%)"</span>, </span>
<span>                <span class="st">"|a_A1 - a_A2|/a_A2"</span>, <span class="st">"|b_A1 - b_A2|/b_A2"</span><span class="op">)</span>,</span>
<span>  digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"A1 approximation error (target Œº_K = %d, œÉ¬≤_K = %d)"</span>, <span class="va">mu_K</span>, <span class="va">var_K</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>A1 approximation error (target Œº_K = 8, œÉ¬≤_K = 15)</caption>
<colgroup>
<col width="4%">
<col width="16%">
<col width="15%">
<col width="31%">
<col width="31%">
</colgroup>
<thead><tr class="header">
<th align="right">J</th>
<th align="right">Mean Error (%)</th>
<th align="right">Var Error (%)</th>
<th align="right">|a_A1 - a_A2|/a_A2</th>
<th align="right">|b_A1 - b_A2|/b_A2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">25</td>
<td align="right">26.87</td>
<td align="right">66.02</td>
<td align="right">2.9602</td>
<td align="right">7.1820</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">19.69</td>
<td align="right">54.07</td>
<td align="right">1.4410</td>
<td align="right">2.6150</td>
</tr>
<tr class="odd">
<td align="right">100</td>
<td align="right">14.72</td>
<td align="right">44.23</td>
<td align="right">0.9076</td>
<td align="right">1.4539</td>
</tr>
<tr class="even">
<td align="right">200</td>
<td align="right">11.22</td>
<td align="right">36.45</td>
<td align="right">0.6474</td>
<td align="right">0.9627</td>
</tr>
<tr class="odd">
<td align="right">300</td>
<td align="right">9.65</td>
<td align="right">32.70</td>
<td align="right">0.5502</td>
<td align="right">0.7922</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="the-feasibility-boundary">6.2 The Feasibility Boundary<a class="anchor" aria-label="anchor" href="#the-feasibility-boundary"></a>
</h3>
<p><strong>Novel Contribution.</strong> An important distinction between
A1 and the exact DP model concerns feasibility. Under A1 (Negative
Binomial proxy), feasibility requires:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>œÉ</mi><mi>K</mi><mn>2</mn></msubsup><mo>&gt;</mo><msub><mi>Œº</mi><mi>K</mi></msub><mo>‚àí</mo><mn>1</mn><mspace width="1.0em"></mspace><mtext mathvariant="normal">(shifted A1)</mtext><mi>.</mi></mrow><annotation encoding="application/x-tex">
\sigma^2_K &gt; \mu_K - 1 \quad \text{(shifted A1)}.
</annotation></semantics></math></p>
<p>However, under the exact DP model, the conditional underdispersion
implies that some
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Œº</mi><mi>K</mi></msub><mo>,</mo><msubsup><mi>œÉ</mi><mi>K</mi><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\mu_K, \sigma^2_K)</annotation></semantics></math>
pairs with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>œÉ</mi><mi>K</mi><mn>2</mn></msubsup><mo>&lt;</mo><msub><mi>Œº</mi><mi>K</mi></msub></mrow><annotation encoding="application/x-tex">\sigma^2_K &lt; \mu_K</annotation></semantics></math>
may be achievable. The package handles this by projecting infeasible A1
requests to the feasibility boundary or using exact A2 methods when
needed.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Illustrate feasibility regions</span></span>
<span><span class="va">J</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">mu_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">20</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># A1 feasibility: var_K &gt; mu_K - 1</span></span>
<span><span class="va">a1_boundary</span> <span class="op">&lt;-</span> <span class="va">mu_grid</span> <span class="op">-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="co"># Approximate exact boundary (minimum achievable variance)</span></span>
<span><span class="co"># This requires extensive computation; we use a simplified approximation</span></span>
<span><span class="va">exact_boundary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">mu_grid</span>, <span class="kw">function</span><span class="op">(</span><span class="va">mu</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Find alpha that gives this mean</span></span>
<span>  <span class="va">alpha_implied</span> <span class="op">&lt;-</span> <span class="va">mu</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">J</span><span class="op">)</span>  <span class="co"># Rough approximation</span></span>
<span>  <span class="co"># Minimum variance at this mean is conditional variance</span></span>
<span>  <span class="fu"><a href="../reference/var_K_given_alpha.html">var_K_given_alpha</a></span><span class="op">(</span><span class="va">J</span>, <span class="va">alpha_implied</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">feasibility_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  mu_K <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mu_grid</span>, <span class="va">mu_grid</span><span class="op">)</span>,</span>
<span>  var_K_boundary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">a1_boundary</span>, <span class="va">exact_boundary</span><span class="op">)</span>,</span>
<span>  Type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A1 Boundary (var &gt; Œº - 1)"</span>, <span class="st">"Exact DP Minimum"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">mu_grid</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">feasibility_df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">mu_K</span>, y <span class="op">=</span> <span class="va">var_K_boundary</span>, color <span class="op">=</span> <span class="va">Type</span>, linetype <span class="op">=</span> <span class="va">Type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_abline</span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">1</span>, intercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dotted"</span>, color <span class="op">=</span> <span class="st">"gray50"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">18</span>, y <span class="op">=</span> <span class="fl">17</span>, label <span class="op">=</span> <span class="st">"Var = Mean"</span>, color <span class="op">=</span> <span class="st">"gray50"</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">20</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">25</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">mu</span><span class="op">[</span><span class="va">K</span><span class="op">]</span> <span class="op">*</span> <span class="st">" (Target Mean)"</span><span class="op">)</span>,</span>
<span>       y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">sigma</span><span class="op">[</span><span class="va">K</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="st">" (Minimum Feasible Variance)"</span><span class="op">)</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Feasibility Boundaries"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"J = %d; region above each curve is feasible"</span>, <span class="va">J</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>        legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="theory-overview_files/figure-html/feasibility-region-1.png" class="r-plt" alt="Feasibility regions for the A1 approximation vs. exact DP model." width="85%"><p class="caption">
Feasibility regions for the A1 approximation vs.¬†exact DP model.
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="computational-implementation">7. Computational Implementation<a class="anchor" aria-label="anchor" href="#computational-implementation"></a>
</h2>
<div class="section level3">
<h3 id="key-functions">7.1 Key Functions<a class="anchor" aria-label="anchor" href="#key-functions"></a>
</h3>
<p>The DPprior package provides the following core computational
functions:</p>
<table class="table">
<colgroup>
<col width="43%">
<col width="56%">
</colgroup>
<thead><tr class="header">
<th>Function</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>compute_log_stirling(J)</code></td>
<td>Pre-compute log Stirling numbers
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">|</mo><mi>s</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>J</mi><mo>,</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">|</mo></mrow></mrow><annotation encoding="application/x-tex">\log|s(J,k)|</annotation></semantics></math>
</td>
</tr>
<tr class="even">
<td><code>pmf_K_given_alpha(J, Œ±, logS)</code></td>
<td>Exact PMF of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>J</mi></msub><mo stretchy="false" form="prefix">|</mo><mi>Œ±</mi></mrow><annotation encoding="application/x-tex">K_J | \alpha</annotation></semantics></math>
</td>
</tr>
<tr class="odd">
<td><code>mean_K_given_alpha(J, Œ±)</code></td>
<td>Conditional mean
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œº</mi><mi>J</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mu_J(\alpha)</annotation></semantics></math>
</td>
</tr>
<tr class="even">
<td><code>var_K_given_alpha(J, Œ±)</code></td>
<td>Conditional variance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>J</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">v_J(\alpha)</annotation></semantics></math>
</td>
</tr>
<tr class="odd">
<td><code>pmf_K_marginal(J, a, b, logS)</code></td>
<td>Marginal PMF of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>J</mi></msub><mo stretchy="false" form="prefix">|</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">K_J | (a, b)</annotation></semantics></math>
</td>
</tr>
<tr class="even">
<td><code>exact_K_moments(J, a, b)</code></td>
<td>Marginal moments
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">M_1(a,b)</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">V(a,b)</annotation></semantics></math>
</td>
</tr>
<tr class="odd">
<td><code>DPprior_fit(J, mu_K, ...)</code></td>
<td>Main elicitation function</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="verification">7.2 Verification<a class="anchor" aria-label="anchor" href="#verification"></a>
</h3>
<p>The package includes extensive verification tests that confirm:</p>
<ol style="list-style-type: decimal">
<li>PMF normalization:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>‚àë</mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mi>J</mi></msubsup><mo>Pr</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>K</mi><mi>J</mi></msub><mo>=</mo><mi>k</mi><mo stretchy="false" form="prefix">|</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sum_{k=0}^{J} \Pr(K_J = k | \alpha) = 1</annotation></semantics></math>
</li>
<li>Moment consistency: Moments from PMF match closed-form
expressions</li>
<li>Poisson-binomial equivalence: Stirling PMF matches Monte Carlo</li>
<li>Variance inequality:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>K</mi><mi>J</mi></msub><mo stretchy="false" form="prefix">|</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>&lt;</mo><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>K</mi><mi>J</mi></msub><mo stretchy="false" form="prefix">|</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Var}(K_J | \alpha) &lt; \mathbb{E}[K_J | \alpha]</annotation></semantics></math>
</li>
</ol>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run a subset of verification tests</span></span>
<span><span class="va">J</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">1.5</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span></span>
<span><span class="va">logS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_log_stirling.html">compute_log_stirling</a></span><span class="op">(</span><span class="va">J</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Test 1: PMF normalization</span></span>
<span><span class="va">pmf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pmf_K_given_alpha.html">pmf_K_given_alpha</a></span><span class="op">(</span><span class="va">J</span>, <span class="va">alpha</span>, <span class="va">logS</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"PMF sum:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">pmf</span><span class="op">)</span>, <span class="st">"(should be 1)\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; PMF sum: 1 (should be 1)</span></span>
<span></span>
<span><span class="co"># Test 2: Moment consistency</span></span>
<span><span class="va">mean_direct</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mean_K_given_alpha.html">mean_K_given_alpha</a></span><span class="op">(</span><span class="va">J</span>, <span class="va">alpha</span><span class="op">)</span></span>
<span><span class="va">var_direct</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/var_K_given_alpha.html">var_K_given_alpha</a></span><span class="op">(</span><span class="va">J</span>, <span class="va">alpha</span><span class="op">)</span></span>
<span><span class="va">mean_from_pmf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">J</span><span class="op">)</span> <span class="op">*</span> <span class="va">pmf</span><span class="op">)</span></span>
<span><span class="va">var_from_pmf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">J</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pmf</span><span class="op">)</span> <span class="op">-</span> <span class="va">mean_from_pmf</span><span class="op">^</span><span class="fl">2</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nConditional moments (Œ± ="</span>, <span class="va">alpha</span>, <span class="st">"):\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Conditional moments (Œ± = 2 ):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Mean (digamma):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">mean_direct</span>, <span class="fl">6</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Mean (digamma): 7.037626</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Mean (from PMF):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">mean_from_pmf</span>, <span class="fl">6</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Mean (from PMF): 7.037626</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Var (polygamma):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">var_direct</span>, <span class="fl">6</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Var (polygamma): 4.535558</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Var (from PMF):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">var_from_pmf</span>, <span class="fl">6</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Var (from PMF): 4.535558</span></span>
<span></span>
<span><span class="co"># Test 3: Variance inequality</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nVariance inequality check:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variance inequality check:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Var(K|Œ±) ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">var_direct</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"&lt; E[K|Œ±] ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">mean_direct</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">":"</span>, </span>
<span>    <span class="va">var_direct</span> <span class="op">&lt;</span> <span class="va">mean_direct</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Var(K|Œ±) = 4.5356 &lt; E[K|Œ±] = 7.0376 : TRUE</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="summary">8. Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>This vignette has provided a comprehensive mathematical treatment of
the theory underlying the DPprior package. Key takeaways include:</p>
<ol style="list-style-type: decimal">
<li><p><strong>The Antoniak distribution</strong> provides the exact PMF
of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>J</mi></msub><mo stretchy="false" form="prefix">|</mo><mi>Œ±</mi></mrow><annotation encoding="application/x-tex">K_J | \alpha</annotation></semantics></math>
via unsigned Stirling numbers, which can be computed stably in
log-space.</p></li>
<li><p><strong>Conditional underdispersion</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>K</mi><mi>J</mi></msub><mo stretchy="false" form="prefix">|</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>&lt;</mo><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>K</mi><mi>J</mi></msub><mo stretchy="false" form="prefix">|</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Var}(K_J | \alpha) &lt; \mathbb{E}[K_J | \alpha]</annotation></semantics></math>
always holds, but marginal distributions under Gamma hyperpriors
typically exhibit overdispersion.</p></li>
<li>
<p><strong>The inverse problem</strong> of mapping from moments
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Œº</mi><mi>K</mi></msub><mo>,</mo><msubsup><mi>œÉ</mi><mi>K</mi><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\mu_K, \sigma^2_K)</annotation></semantics></math>
to Gamma parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(a, b)</annotation></semantics></math>
can be solved via:</p>
<ul>
<li>
<strong>A1</strong>: Closed-form Negative Binomial approximation
(fast, approximate)</li>
<li>
<strong>A2</strong>: Newton iteration with exact moments (accurate,
initialized by A1)</li>
</ul>
</li>
<li><p><strong>Feasibility constraints</strong> differ between the A1
proxy and exact DP model, with A1 being more restrictive.</p></li>
</ol>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Antonelli, J., Trippa, L., &amp; Haneuse, S. (2016). Mitigating bias
in generalized linear mixed models: The case for Bayesian
nonparametrics. <em>Statistical Science</em>, 31(1), 80-98.</p>
<p>Antoniak, C. E. (1974). Mixtures of Dirichlet processes with
applications to Bayesian nonparametric problems. <em>The Annals of
Statistics</em>, 2(6), 1152-1174.</p>
<p>Arratia, R., Barbour, A. D., &amp; Tavar√©, S. (2003). <em>Logarithmic
Combinatorial Structures: A Probabilistic Approach</em>. European
Mathematical Society.</p>
<p>Blackwell, D., &amp; MacQueen, J. B. (1973). Ferguson distributions
via P√≥lya urn schemes. <em>The Annals of Statistics</em>, 1(2),
353-355.</p>
<p>Dorazio, R. M. (2009). On selecting a prior for the precision
parameter of Dirichlet process mixture models. <em>Journal of
Statistical Planning and Inference</em>, 139(10), 3384-3390.</p>
<p>Ferguson, T. S. (1973). A Bayesian analysis of some nonparametric
problems. <em>The Annals of Statistics</em>, 1(2), 209-230.</p>
<p>Lee, J., Che, J., Rabe-Hesketh, S., Feller, A., &amp; Miratrix, L.
(2025). Improving the estimation of site-specific effects and their
distribution in multisite trials. <em>Journal of Educational and
Behavioral Statistics</em>, 50(5), 731-764.</p>
<p>Murugiah, S., &amp; Sweeting, T. J. (2012). Selecting the precision
parameter prior in Dirichlet process mixture models. <em>Journal of
Statistical Planning and Inference</em>, 142(7), 1947-1959.</p>
<p>Sethuraman, J. (1994). A constructive definition of Dirichlet priors.
<em>Statistica Sinica</em>, 4(2), 639-650.</p>
<p>Vicentini, C., &amp; Jermyn, I. H. (2025). Prior selection for the
precision parameter of Dirichlet process mixtures.
<em>arXiv:2502.00864</em>.</p>
<p>Zito, A., Rigon, T., &amp; Dunson, D. B. (2024). Bayesian
nonparametric modeling of latent partitions via Stirling-gamma priors.
<em>arXiv:2306.02360</em>.</p>
<hr>
</div>
<div class="section level2">
<h2 id="appendix-mathematical-derivations">Appendix: Mathematical Derivations<a class="anchor" aria-label="anchor" href="#appendix-mathematical-derivations"></a>
</h2>
<div class="section level3">
<h3 id="a-1-derivatives-for-newton-iteration">A.1 Derivatives for Newton Iteration<a class="anchor" aria-label="anchor" href="#a-1-derivatives-for-newton-iteration"></a>
</h3>
<p>For the A2 Newton solver, we require derivatives of the marginal
moments with respect to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(a, b)</annotation></semantics></math>.
Define:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>a</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>:=</mo><mfrac><mi>‚àÇ</mi><mrow><mi>‚àÇ</mi><mi>a</mi></mrow></mfrac><mo>log</mo><msub><mi>p</mi><mrow><mi>a</mi><mo>,</mo><mi>b</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>log</mo><mi>Œ±</mi><mo>‚àí</mo><mi>œà</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mo>log</mo><mi>b</mi><mo>,</mo></mrow><annotation encoding="application/x-tex">
s_a(\alpha) := \frac{\partial}{\partial a} \log p_{a,b}(\alpha) = \log \alpha - \psi(a) + \log b,
</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>b</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>:=</mo><mfrac><mi>‚àÇ</mi><mrow><mi>‚àÇ</mi><mi>b</mi></mrow></mfrac><mo>log</mo><msub><mi>p</mi><mrow><mi>a</mi><mo>,</mo><mi>b</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mi>a</mi><mi>b</mi></mfrac><mo>‚àí</mo><mi>Œ±</mi><mi>.</mi></mrow><annotation encoding="application/x-tex">
s_b(\alpha) := \frac{\partial}{\partial b} \log p_{a,b}(\alpha) = \frac{a}{b} - \alpha.
</annotation></semantics></math></p>
<p>Then:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>‚àÇ</mi><msub><mi>M</mi><mn>1</mn></msub></mrow><mrow><mi>‚àÇ</mi><mi>a</mi></mrow></mfrac><mo>=</mo><msub><mi>ùîº</mi><mi>Œ±</mi></msub><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>Œº</mi><mi>J</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚ãÖ</mo><msub><mi>s</mi><mi>a</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo><mspace width="1.0em"></mspace><mfrac><mrow><mi>‚àÇ</mi><msub><mi>M</mi><mn>1</mn></msub></mrow><mrow><mi>‚àÇ</mi><mi>b</mi></mrow></mfrac><mo>=</mo><msub><mi>ùîº</mi><mi>Œ±</mi></msub><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>Œº</mi><mi>J</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚ãÖ</mo><msub><mi>s</mi><mi>b</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
\frac{\partial M_1}{\partial a} = \mathbb{E}_\alpha[\mu_J(\alpha) \cdot s_a(\alpha)], \quad
\frac{\partial M_1}{\partial b} = \mathbb{E}_\alpha[\mu_J(\alpha) \cdot s_b(\alpha)].
</annotation></semantics></math></p>
<p>For the variance, let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>:=</mo><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msubsup><mi>K</mi><mi>J</mi><mn>2</mn></msubsup><mo stretchy="false" form="prefix">|</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">m_2(a,b) := \mathbb{E}[K_J^2 | a, b]</annotation></semantics></math>.
Then
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mo>=</mo><msub><mi>m</mi><mn>2</mn></msub><mo>‚àí</mo><msubsup><mi>M</mi><mn>1</mn><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">V = m_2 - M_1^2</annotation></semantics></math>
and:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>‚àÇ</mi><mi>V</mi></mrow><mrow><mi>‚àÇ</mi><mi>a</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>‚àÇ</mi><msub><mi>m</mi><mn>2</mn></msub></mrow><mrow><mi>‚àÇ</mi><mi>a</mi></mrow></mfrac><mo>‚àí</mo><mn>2</mn><msub><mi>M</mi><mn>1</mn></msub><mfrac><mrow><mi>‚àÇ</mi><msub><mi>M</mi><mn>1</mn></msub></mrow><mrow><mi>‚àÇ</mi><mi>a</mi></mrow></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">
\frac{\partial V}{\partial a} = \frac{\partial m_2}{\partial a} - 2 M_1 \frac{\partial M_1}{\partial a}.
</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="a-2-large-j-asymptotics">A.2
Large-<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>J</mi><annotation encoding="application/x-tex">J</annotation></semantics></math>
Asymptotics<a class="anchor" aria-label="anchor" href="#a-2-large-j-asymptotics"></a>
</h3>
<p>For fixed
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ±</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\alpha &gt; 0</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi><mo>‚Üí</mo><mi>‚àû</mi></mrow><annotation encoding="application/x-tex">J \to \infty</annotation></semantics></math>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œº</mi><mi>J</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>Œ±</mi><mo>log</mo><mi>J</mi><mo>‚àí</mo><mi>Œ±</mi><mi>œà</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>O</mi><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mi>Œ±</mi><mi>J</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
\mu_J(\alpha) = \alpha \log J - \alpha \psi(\alpha) + O\left(\frac{\alpha}{J}\right).
</annotation></semantics></math></p>
<p>This justifies the use of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>J</mi></msub><mo>=</mo><mo>log</mo><mi>J</mi></mrow><annotation encoding="application/x-tex">c_J = \log J</annotation></semantics></math>
as the default scaling in the A1 approximation. Note that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œà</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\psi(\alpha) &lt; 0</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ±</mi><mo>&lt;</mo><msub><mi>Œ±</mi><mn>0</mn></msub><mo>‚âà</mo><mn>1.46</mn></mrow><annotation encoding="application/x-tex">\alpha &lt; \alpha_0 \approx 1.46</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œà</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\psi(\alpha) &gt; 0</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ±</mi><mo>&gt;</mo><msub><mi>Œ±</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\alpha &gt; \alpha_0</annotation></semantics></math>.</p>
<hr>
<p><em>For questions about this vignette or the DPprior package, please
visit the <a href="https://github.com/joonho112/DPprior" class="external-link">GitHub
repository</a>.</em></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/joonho112" class="external-link">JoonHo Lee</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
